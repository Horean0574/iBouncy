{"version":3,"file":"index-Dpxjo924.js","sources":["../../src/utils/GameProcessor.js","../../src/utils/GameInteraction.js","../../src/utils/Queue.js","../../src/utils/EmbeddedTimer.js","../../src/utils/GameElement.js","../../src/elements/E_Mask.js","../../src/utils/GameElementCentered.js","../../src/elements/E_Settlement.js","../../src/elements/E_FPS.js","../../src/elements/E_ForbiddenZone.js","../../src/elements/E_Timing.js","../../src/elements/E_Scoring.js","../../src/elements/E_Tablet.js","../../src/elements_extensions/EX_BallTrailing.js","../../src/elements/E_Ball.js","../../src/core/instances.js","../../src/app.js"],"sourcesContent":["import {\r\n    setPrevTimeStamp,\r\n    prevTimeStamp,\r\n    Ball,\r\n    ForbiddenZone,\r\n    FPS,\r\n    GP,\r\n    leafer, loading,\r\n    Mask,\r\n    Scoring,\r\n    Settlement,\r\n    Tablet,\r\n    timer,\r\n    Timing,\r\n} from \"../core/instances\";\r\n\r\nexport class GameProcessor {\r\n    #SM = \"init\"; // state machine\r\n    measured = 0;\r\n    refreshRateBucket = new Map();\r\n\r\n    constructor(ENV = {}) {\r\n        this.ENV = ENV;\r\n        this.gameOver = this.gameOver.bind(this);\r\n    }\r\n\r\n    get bw() {\r\n        return document.body.clientWidth;\r\n    }\r\n\r\n    get bh() {\r\n        return document.body.clientHeight;\r\n    }\r\n\r\n    state(newState) {\r\n        this.#SM = newState;\r\n    }\r\n\r\n    at(...states) {\r\n        for (let s of states) if (this.#SM === s) return true;\r\n        return false;\r\n    }\r\n\r\n    async initializeAll() {\r\n        await Promise.all([\r\n            Scoring.init(),\r\n            Settlement.init(),\r\n        ]);\r\n    }\r\n\r\n    renderAll() {\r\n        ForbiddenZone.render();\r\n        Tablet.render();\r\n        Ball.render();\r\n        Timing.render();\r\n        Scoring.render();\r\n        FPS.render();\r\n    }\r\n\r\n    measureRefreshRate(prog) {\r\n        if (this.measured >= 20) return;\r\n        const rrKey = Math.round(60 / prog);\r\n        const curValue = this.refreshRateBucket.get(rrKey);\r\n        if (curValue === undefined) {\r\n            this.refreshRateBucket.set(rrKey, 1);\r\n        } else {\r\n            this.refreshRateBucket.set(rrKey, curValue + 1);\r\n        }\r\n        if (++this.measured >= 20) {\r\n            let maxV = 0;\r\n            let k4maxV = 0;\r\n            for (let [k, v] of this.refreshRateBucket.entries()) {\r\n                if (v >= maxV) {\r\n                    maxV = v;\r\n                    k4maxV = k;\r\n                }\r\n            }\r\n            this.refreshRateBucket.clear();\r\n            GP.ENV.refreshRate = k4maxV;\r\n            GP.ENV.fixedStep = 1000 / k4maxV;\r\n            GP.ENV.actUnitInterval = (1000 / k4maxV).toFixed(1);\r\n            GP.state(\"init2\");\r\n        }\r\n    }\r\n\r\n    async fontInitializer(name, src) {\r\n        const font = new FontFace(name, `url(${src}.woff2)`);\r\n        try {\r\n            await font.load();\r\n            document.fonts.add(font);\r\n            leafer.forceRender();\r\n        } catch {\r\n            const font2 = new FontFace(name, `url(${src}.woff)`);\r\n            try {\r\n                await font2.load();\r\n                document.fonts.add(font2);\r\n                leafer.forceRender();\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n    }\r\n\r\n    reset() {\r\n        Mask.cull();\r\n        Settlement.cull();\r\n        Timing.reset();\r\n        Scoring.reset();\r\n        Tablet.reset();\r\n        Ball.reset();\r\n    }\r\n\r\n    pause() {\r\n        if (this.at(\"paused\", \"prepared\", \"over\") || this.#SM.startsWith(\"init\")) return;\r\n        this.state(\"paused\");\r\n        timer.pauseAll();\r\n    }\r\n\r\n    resume() {\r\n        if (this.at(\"playing\", \"prepared\", \"over\") || this.#SM.startsWith(\"init\")) return;\r\n        this.state(\"playing\");\r\n        setPrevTimeStamp(performance.now());\r\n        timer.resumeAll();\r\n    }\r\n\r\n    gameOver(win = false) {\r\n        if (this.at(\"over\")) return true;\r\n        this.state(\"over\");\r\n        Timing.stop();\r\n        Mask.render();\r\n        if (win) Settlement.win();\r\n        else Settlement.fail();\r\n        return true;\r\n    }\r\n\r\n    loadingFadeOut() {\r\n        loading.animate([\r\n            { opacity: 0 },\r\n        ], {\r\n            duration: 300,\r\n            fill: \"both\",\r\n        });\r\n    }\r\n}\r\n","import { Ball, D, GP, Tablet, timer } from \"../core/instances\";\r\n\r\nexport default class GameInteraction {\r\n    collisionStat = 0;\r\n    accelerateCD = 50;\r\n    prevAccelerateTime;\r\n\r\n    borderDetect(ge, {\r\n        bounce = false,\r\n        paddings = [0, 0, 0, 0], // Top, Right, Bottom, Left\r\n        callbacks = [null, null, null, null],\r\n    } = {}) {\r\n        const bounceRatio = bounce ? -1 : 0;\r\n        if (ge.x < paddings[3]) {\r\n            if (callbacks[3]?.() === void 0) {\r\n                ge.x = paddings[3];\r\n                ge.vx *= bounceRatio;\r\n            }\r\n        } else if (ge.ox > GP.bw - paddings[1]) {\r\n            if (callbacks[1]?.() === void 0) {\r\n                ge.ox = GP.bw - paddings[1];\r\n                ge.vx *= bounceRatio;\r\n            }\r\n        }\r\n        if (ge.y < paddings[0]) {\r\n            if (callbacks[0]?.() === void 0) {\r\n                ge.y = paddings[0];\r\n                ge.vy *= bounceRatio;\r\n            }\r\n        } else if (ge.oy > GP.bh - paddings[2]) {\r\n            if (callbacks[2]?.() === void 0) {\r\n                ge.oy = GP.bh - paddings[2];\r\n                ge.vy *= bounceRatio;\r\n            }\r\n        }\r\n    }\r\n\r\n    collisionDetect() {\r\n        if (!this.#AABBDetect()) {\r\n            this.collisionStat = 0;\r\n            return false;\r\n        }\r\n        if (this.collisionStat) return false;\r\n        let initialJudged = false;\r\n        if (Ball.cx >= Tablet.x && Ball.cx <= Tablet.ox) {\r\n            this.collisionStat = 1;\r\n            initialJudged = true;\r\n            Ball.vy *= -this.tempAccelerate(\"y\");\r\n            if (D(Ball.cy - Tablet.y) <= D(Ball.cy - Tablet.oy)) {\r\n                Ball.oy = Tablet.y;\r\n            } else {\r\n                Ball.y = Tablet.oy;\r\n            }\r\n        }\r\n        if (Ball.cy >= Tablet.y && Ball.cy <= Tablet.oy) {\r\n            this.collisionStat = 1;\r\n            initialJudged = true;\r\n            Ball.vx *= -this.tempAccelerate(\"x\");\r\n            if (D(Ball.cx - Tablet.x) <= D(Ball.cx - Tablet.ox)) {\r\n                Ball.ox = Tablet.x;\r\n            } else {\r\n                Ball.x = Tablet.ox;\r\n            }\r\n        }\r\n        if (initialJudged) return true;\r\n        return this.handleCornerCollisions();\r\n    }\r\n\r\n    handleCornerCollisions() {\r\n        if (Ball.cx < Tablet.x && Ball.cy < Tablet.y) {\r\n            return this.cornerCollision(false, false);\r\n        } else if (Ball.cx > Tablet.ox && Ball.cy < Tablet.y) {\r\n            return this.cornerCollision(true, false);\r\n        } else if (Ball.cx > Tablet.ox && Ball.cy > Tablet.oy) {\r\n            return this.cornerCollision(true, true);\r\n        } else if (Ball.cx < Tablet.x && Ball.cy > Tablet.oy) {\r\n            return this.cornerCollision(false, true);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Collision handler for one corner.\r\n     * @param {boolean} cnxFlag - flag of corner name of abscissa\r\n     * @param {boolean} cnyFlag - flag of corner name of ordinate\r\n     * @returns {boolean}\r\n     */\r\n    cornerCollision(cnxFlag, cnyFlag) {\r\n        const [cnx, cnxR] = cnxFlag ? [\"ox\", \"x\"] : [\"x\", \"ox\"]; // R means reverse\r\n        const [cny, cnyR] = cnyFlag ? [\"oy\", \"y\"] : [\"y\", \"oy\"];\r\n        const radius = Ball.w / 2;\r\n        const deltaX = Ball.cx - Tablet[cnx];\r\n        const deltaY = Ball.cy - Tablet[cny];\r\n        if (deltaX ** 2 + deltaY ** 2 <= radius ** 2) {\r\n            this.collisionStat = 1;\r\n            if (D(deltaY) >= D(deltaX)) {\r\n                Ball[cnyR] = Tablet[cny];\r\n                Ball.vy *= -this.tempAccelerate(\"y\");\r\n            } else {\r\n                Ball[cnxR] = Tablet[cnx];\r\n                Ball.vx *= -this.tempAccelerate(\"x\");\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    tempAccelerate(direction) {\r\n        if (direction !== \"x\" && direction !== \"y\") return 0;\r\n        const now = performance.now();\r\n        if (this.prevAccelerateTime === void 0) {\r\n            this.prevAccelerateTime = now;\r\n        } else {\r\n            if (now - this.prevAccelerateTime < this.accelerateCD) return 1;\r\n            this.prevAccelerateTime = now;\r\n        }\r\n        const vName = \"v\" + direction;\r\n        const ratio1 = direction === \"x\" ? 1.5 : 1.2;\r\n        const ratio2 = direction === \"x\" ? 0.6 : 0.25;\r\n        const vBuff = ratio1 - Math.sign(Ball[vName]) * Tablet[vName] * ratio2 / Tablet[vName + \"Max\"];\r\n        const vUnitNerf = Math.pow(vBuff, 1 / 6);\r\n        timer.newInterval(function () {\r\n            Ball[vName] /= vUnitNerf;\r\n        }, 16.7, {\r\n            delay: 200,\r\n            executeTimes: 6,\r\n        });\r\n        return vBuff;\r\n    }\r\n\r\n    #AABBDetect() {\r\n        return !(Ball.ox < Tablet.x || Ball.x > Tablet.ox || Ball.oy < Tablet.y || Ball.y > Tablet.oy);\r\n    }\r\n}\r\n","export default class Queue {\r\n    constructor() {\r\n        this.elements = new Map();\r\n        this.head = 0;\r\n        this.tail = 0;\r\n    }\r\n\r\n    push(item) {\r\n        this.elements.set(this.tail, item);\r\n        ++this.tail;\r\n    }\r\n\r\n    pop() {\r\n        if (this.isEmpty) return null;\r\n        const item = this.elements.get(this.head);\r\n        this.elements.delete(this.head);\r\n        ++this.head;\r\n        return item;\r\n    }\r\n\r\n    front() {\r\n        return this.elements.get(this.head);\r\n    }\r\n\r\n    clear() {\r\n        this.elements.clear();\r\n        this.head = this.tail = 0;\r\n    }\r\n\r\n    get length() {\r\n        return this.tail - this.head;\r\n    }\r\n\r\n    get isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}\r\n","import Queue from \"./Queue\";\r\n\r\nexport default class EmbeddedTimer {\r\n    #timeoutMap = new Map();\r\n    #timeout2delete = new Set();\r\n    #intervalMap = new Map();\r\n    #interval2delete = new Set();\r\n    #FPSHandlerID;\r\n    #FPSTimeQueue = new Queue();\r\n    #FPSFramesCnt = 0;\r\n    #FPSElapsed = 0;\r\n    #cachedFPS = NaN;\r\n    #lastFPSCalcTime = 0;\r\n\r\n    #config = {\r\n        minInterval: 16.7,\r\n        autoHandleFPS: false,\r\n        FPSHandleInterval: 33.3,\r\n        FPSUpdateInterval: 300,\r\n    };\r\n\r\n    constructor(options = {}) {\r\n        this.#config = { ...this.#config, ...options };\r\n        if (this.#config.autoHandleFPS) this.initFPSHandler();\r\n    }\r\n\r\n    get MIN_INTERVAL() {\r\n        return this.#config.minInterval;\r\n    }\r\n\r\n    set MIN_INTERVAL(v) {\r\n        this.#config.minInterval = v;\r\n    }\r\n\r\n    timeDetect(timeStamp) {\r\n        this.#timeoutFrame(timeStamp);\r\n        this.#intervalFrame(timeStamp);\r\n    }\r\n\r\n    #timeoutFrame(timeStamp) {\r\n        for (let symbol of this.#timeoutMap.keys()) {\r\n            const duty = this.#timeoutMap.get(symbol);\r\n            if (duty.terminate) {\r\n                this.#timeout2delete.add(symbol);\r\n                continue;\r\n            }\r\n            if (duty.paused) continue;\r\n            if (timeStamp - duty.start >= duty.duration) {\r\n                this.#timeout2delete.add(symbol);\r\n                duty.callback();\r\n            }\r\n        }\r\n        for (let symbol of this.#timeout2delete) {\r\n            this.#timeoutMap.delete(symbol);\r\n        }\r\n        this.#timeout2delete.clear();\r\n    }\r\n\r\n    #intervalFrame(timeStamp) {\r\n        for (let symbol of this.#intervalMap.keys()) {\r\n            const duty = this.#intervalMap.get(symbol);\r\n            if (duty.terminate) {\r\n                this.#interval2delete.add(symbol);\r\n                continue;\r\n            }\r\n            if (duty.paused) continue;\r\n            if (timeStamp < duty.start) continue;\r\n            duty.options.recFramesCnt && ++duty.data.framesCnt;\r\n            duty.options.recElapsedTime && (duty.data.elapsed = timeStamp - duty.start);\r\n            if (timeStamp - duty.step >= duty.duration) {\r\n                ++duty.data.cnt;\r\n                duty.callback(duty.data);\r\n                if (duty.data.cnt >= duty.options.executeTimes) {\r\n                    this.#interval2delete.add(symbol);\r\n                    continue;\r\n                }\r\n                duty.step += duty.duration;\r\n            }\r\n        }\r\n        for (let symbol of this.#interval2delete) {\r\n            this.#intervalMap.delete(symbol);\r\n        }\r\n        this.#interval2delete.clear();\r\n    }\r\n\r\n    newTimeout(callback, timeout = this.#config.minInterval) {\r\n        timeout = Math.max(timeout, this.#config.minInterval);\r\n        const symbol = Symbol(\"Timeout\");\r\n        const now = performance.now();\r\n        let toAdd = {\r\n            callback: callback,\r\n            start: now,\r\n            pause: now,\r\n            duration: timeout,\r\n            paused: false,\r\n            terminate: false,\r\n        };\r\n        this.#timeoutMap.set(symbol, toAdd);\r\n        return symbol;\r\n    }\r\n\r\n    cancelTimeout(symbol) {\r\n        this.#timeoutMap.get(symbol).terminate = true;\r\n    }\r\n\r\n    newInterval(callback, interval = this.#config.minInterval, options = {}) {\r\n        options = Object.assign({\r\n            delay: 0,\r\n            executeTimes: Infinity,\r\n            recFramesCnt: false,\r\n            recElapsedTime: false,\r\n        }, options);\r\n        interval = Math.max(interval, this.#config.minInterval);\r\n        const symbol = Symbol(\"Interval\");\r\n        const now = performance.now();\r\n        let toAdd = {\r\n            callback: callback,\r\n            start: now + options.delay,\r\n            step: now + options.delay,\r\n            pause: now + options.delay,\r\n            duration: interval,\r\n            paused: false,\r\n            terminate: false,\r\n            options: options,\r\n            data: {\r\n                cnt: 0,\r\n                framesCnt: 0,\r\n                elapsed: 0,\r\n            },\r\n        };\r\n        this.#intervalMap.set(symbol, toAdd);\r\n        return symbol;\r\n    }\r\n\r\n    cancelInterval(symbol) {\r\n        this.#intervalMap.get(symbol).terminate = true;\r\n    }\r\n\r\n    pause(symbol) {\r\n        const sType = this.#whichType(symbol);\r\n        if (sType === \"Timeout\") {\r\n            const duty = this.#timeoutMap.get(symbol);\r\n            if (duty.paused) return;\r\n            duty.paused = true;\r\n            duty.pause = performance.now();\r\n        } else if (sType === \"Interval\") {\r\n            const duty = this.#intervalMap.get(symbol);\r\n            if (duty.paused) return;\r\n            duty.paused = true;\r\n            duty.pause = performance.now();\r\n        }\r\n    }\r\n\r\n    resume(symbol) {\r\n        const sType = this.#whichType(symbol);\r\n        if (sType === \"Timeout\") {\r\n            const duty = this.#timeoutMap.get(symbol);\r\n            if (!duty.paused) return;\r\n            duty.paused = false;\r\n            duty.start += performance.now() - duty.pause;\r\n        } else if (sType === \"Interval\") {\r\n            const duty = this.#intervalMap.get(symbol);\r\n            if (!duty.paused) return;\r\n            duty.paused = false;\r\n            duty.step += performance.now() - duty.pause;\r\n        }\r\n    }\r\n\r\n    pauseAll() {\r\n        for (let symbol of this.#timeoutMap.keys()) this.pause(symbol);\r\n        for (let symbol of this.#intervalMap.keys()) this.pause(symbol);\r\n    }\r\n\r\n    resumeAll() {\r\n        for (let symbol of this.#timeoutMap.keys()) this.resume(symbol);\r\n        for (let symbol of this.#intervalMap.keys()) this.resume(symbol);\r\n    }\r\n\r\n    #whichType(symbol) {\r\n        const str = symbol.toString();\r\n        return str.substring(7, str.length - 1);\r\n    }\r\n\r\n    initFPSHandler() {\r\n        if (this.#isFPSHandlerRunning()) return;\r\n        this.#FPSHandlerID = this.newInterval((data) => {\r\n            this.#FPSTimeQueue.push([data.elapsed, data.framesCnt]);\r\n            while (data.elapsed - this.#FPSTimeQueue.front()[0] > 1000) {\r\n                this.#FPSTimeQueue.pop();\r\n            }\r\n            this.#FPSFramesCnt = data.framesCnt;\r\n            this.#FPSElapsed = data.elapsed;\r\n        }, this.#config.FPSHandleInterval, {\r\n            recFramesCnt: true,\r\n            recElapsedTime: true,\r\n        });\r\n    }\r\n\r\n    destroyFPSHandler() {\r\n        if (!this.#isFPSHandlerRunning()) return;\r\n        this.cancelInterval(this.#FPSHandlerID);\r\n        this.#FPSHandlerID = null;\r\n        this.#FPSTimeQueue.clear();\r\n    }\r\n\r\n    #isFPSHandlerRunning() {\r\n        return this.#FPSHandlerID !== undefined && this.#FPSHandlerID !== null;\r\n    }\r\n\r\n    #calcFPS() {\r\n        const approxFPS = this.#FPSFramesCnt - this.#FPSTimeQueue.front()[1];\r\n        const adjustRatio = 1000 / (this.#FPSElapsed - this.#FPSTimeQueue.front()[0]);\r\n        return (approxFPS * adjustRatio).toFixed(1);\r\n    }\r\n\r\n    get FPS() {\r\n        if (!this.#isFPSHandlerRunning() || this.#FPSTimeQueue.isEmpty) return this.#cachedFPS = NaN;\r\n        const timeStamp = performance.now();\r\n        if (timeStamp - this.#lastFPSCalcTime < this.#config.FPSUpdateInterval) return this.#cachedFPS;\r\n        this.#lastFPSCalcTime = timeStamp;\r\n        return this.#cachedFPS = this.#calcFPS();\r\n    }\r\n}\r\n","import { leafer } from \"../core/instances\";\r\n\r\nexport default class GameElement {\r\n    #zIndex;\r\n\r\n    constructor(el, zIndex = 0) {\r\n        this.el = el;\r\n        this.el.zIndex = this.#zIndex = zIndex;\r\n    }\r\n\r\n    get w() { // width\r\n        return this.el.width;\r\n    }\r\n\r\n    set w(v) {\r\n        this.el.width = v;\r\n    }\r\n\r\n    get h() { // height\r\n        return this.el.height;\r\n    }\r\n\r\n    set h(v) {\r\n        this.el.height = v;\r\n    }\r\n\r\n    get cx() { // abscissa of the center point\r\n        return this.el.x + this.el.width / 2;\r\n    }\r\n\r\n    set cx(v) {\r\n        this.el.x = v - this.el.width / 2;\r\n    }\r\n\r\n    get cy() { // ordinate of the center point\r\n        return this.el.y + this.el.height / 2;\r\n    }\r\n\r\n    set cy(v) {\r\n        this.el.y = v - this.el.height / 2;\r\n    }\r\n\r\n    get x() {\r\n        return this.el.x;\r\n    }\r\n\r\n    set x(v) {\r\n        this.el.x = v;\r\n    }\r\n\r\n    get ox() { // abscissa of the opposite side of AABB bound\r\n        return this.el.x + this.el.width;\r\n    }\r\n\r\n    set ox(v) {\r\n        this.el.x = v - this.el.width;\r\n    }\r\n\r\n    get y() {\r\n        return this.el.y;\r\n    }\r\n\r\n    set y(v) {\r\n        this.el.y = v;\r\n    }\r\n\r\n    get oy() { // ordinate of the opposite side of AABB bound\r\n        return this.el.y + this.el.height;\r\n    }\r\n\r\n    set oy(v) {\r\n        this.el.y = v - this.el.height;\r\n    }\r\n\r\n    destroy() {\r\n        this.el.destroy();\r\n    }\r\n\r\n    render(zIndex = void 0) {\r\n        if (!Number.isInteger(zIndex)) this.el.zIndex = this.#zIndex;\r\n        else this.el.zIndex = zIndex;\r\n        leafer.add(this.el);\r\n    }\r\n\r\n    cull() {\r\n        this.el.remove();\r\n    }\r\n\r\n    show() {\r\n        this.el.visible = true;\r\n    }\r\n\r\n    hide() {\r\n        this.el.visible = false;\r\n    }\r\n\r\n    toggle() {\r\n        this.el.visible = !this.el.visible;\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport { Rect } from \"leafer-game\";\r\nimport { GP, leafer } from \"../core/instances\";\r\n\r\nexport default class E_Mask extends GameElement {\r\n    #config = {\r\n        fill: \"#666\",\r\n        opacity: 0.6,\r\n        fadeInDuration: 0.8,\r\n    };\r\n\r\n    constructor() {\r\n        super(new Rect({\r\n            x: 0,\r\n            y: 0,\r\n            width: GP.bw,\r\n            height: GP.bh,\r\n            fill: \"#666\",\r\n            opacity: 0,\r\n            animationOut: {\r\n                style: { opacity: 0 },\r\n                duration: 0.5,\r\n                join: true,\r\n            },\r\n        }), 990);\r\n        this.el.fill = this.#config.fill;\r\n        this.el.animation = {\r\n            style: { opacity: this.#config.opacity },\r\n            duration: this.#config.fadeInDuration,\r\n            join: true,\r\n        };\r\n    }\r\n\r\n    relocate(e) {\r\n        this.w = e.width;\r\n        this.h = e.height;\r\n    }\r\n\r\n    render(fill = void 0, fromOpacity = void 0, toOpacity = void 0, duration = void 0) {\r\n        if (fill === void 0) this.el.fill = this.#config.fill;\r\n        else this.el.fill = fill;\r\n        if (fromOpacity === void 0) this.el.opacity = 0;\r\n        else this.el.opacity = fromOpacity;\r\n        if (toOpacity === void 0) this.el.animation.style.opacity = this.#config.opacity;\r\n        else this.el.animation.style.opacity = toOpacity;\r\n        if (duration === void 0) this.el.animation.duration = this.#config.fadeInDuration;\r\n        else this.el.animation.duration = duration;\r\n        leafer.add(this.el);\r\n    }\r\n}\r\n","import GameElement from \"./GameElement\";\r\n\r\nexport default class GameElementCentered extends GameElement {\r\n    constructor(el, zIndex = 0) {\r\n        el.around = \"center\";\r\n        super(el, zIndex);\r\n    }\r\n\r\n    get cx() {\r\n        return this.el.x;\r\n    }\r\n\r\n    set cx(v) {\r\n        this.el.x = v;\r\n    }\r\n\r\n    get cy() {\r\n        return this.el.y;\r\n    }\r\n\r\n    set cy(v) {\r\n        this.el.y = v;\r\n    }\r\n\r\n    get x() {\r\n        return this.el.x - this.el.width / 2;\r\n    }\r\n\r\n    set x(v) {\r\n        this.el.x = v + this.el.width / 2;\r\n    }\r\n\r\n    get y() {\r\n        return this.el.y - this.el.height / 2;\r\n    }\r\n\r\n    set y(v) {\r\n        this.el.y = v + this.el.height / 2;\r\n    }\r\n\r\n    get ox() {\r\n        return this.el.x + this.el.width / 2;\r\n    }\r\n\r\n    set ox(v) {\r\n        this.el.x = v - this.el.width / 2;\r\n    }\r\n\r\n    get oy() {\r\n        return this.el.y + this.el.height / 2;\r\n    }\r\n\r\n    set oy(v) {\r\n        this.el.y = v - this.el.height / 2;\r\n    }\r\n}\r\n","import GameElementCentered from \"../utils/GameElementCentered\";\r\nimport { Text, Resource, Platform } from \"leafer-game\";\r\nimport { GP } from \"../core/instances\";\r\n\r\nexport default class E_Settlement extends GameElementCentered {\r\n    constructor() {\r\n        super(new Text({\r\n            x: GP.bw / 2,\r\n            y: GP.bh / 3,\r\n            text: \"\",\r\n            fontSize: 128,\r\n            fontFamily: \"HYBeiBingYang-W\",\r\n            scale: 0.5,\r\n            opacity: 0.6,\r\n            animation: {\r\n                style: { scale: 1, opacity: 1 },\r\n                duration: 0.4,\r\n                join: true,\r\n            },\r\n            animationOut: {\r\n                style: { scale: 0.4, opacity: 0.2 },\r\n                duration: 0.3,\r\n                join: true,\r\n            },\r\n        }), 991);\r\n\r\n        this.init = this.init.bind(this);\r\n    }\r\n\r\n    relocate(e) {\r\n        this.cx = e.width / 2;\r\n        this.cy = e.height / 2 - 64;\r\n    }\r\n\r\n    init() {\r\n        return Promise.all([\r\n            this.#loadFont(),\r\n            this.#preloadImage(),\r\n        ]);\r\n    }\r\n\r\n    async #loadFont() {\r\n        await GP.fontInitializer(\"HYBeiBingYang-W\", \"./assets/fonts/HYBeiBingYang-W\");\r\n    }\r\n\r\n    async #preloadImage() {\r\n        await Promise.all([\r\n            this.#loadAndTransferImg(\"./assets/img/GL.jpg\", \"leafer://GL.jpg\"),\r\n            this.#loadAndTransferImg(\"./assets/img/DL.jpg\", \"leafer://DL.jpg\"),\r\n        ]);\r\n    }\r\n\r\n    async #loadAndTransferImg(src, name) {\r\n        let img = await Platform.origin.loadImage(src);\r\n        Resource.setImage(name, img);\r\n    }\r\n\r\n    win() {\r\n        this.el.text = \" You Win! \";\r\n        this.#setTextFill(\"leafer://GL.jpg\");\r\n        this.#setShadowColor(\"#FFEF00\");\r\n        this.render();\r\n    }\r\n\r\n    fail() {\r\n        this.el.text = \" FAIL \";\r\n        this.#setTextFill(\"leafer://DL.jpg\");\r\n        this.#setShadowColor(\"#474746\");\r\n        this.render();\r\n    }\r\n\r\n    #setTextFill(src) {\r\n        this.el.fill = {\r\n            type: \"image\",\r\n            url: src,\r\n            offset: { y: -50 },\r\n        };\r\n    }\r\n\r\n    #setShadowColor(color) {\r\n        this.el.shadow = {\r\n            x: 0,\r\n            y: 0,\r\n            blur: 25,\r\n            color: color,\r\n        };\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport { Text } from \"leafer-game\";\r\nimport { GP } from \"../core/instances\";\r\n\r\nexport default class E_FPS extends GameElement {\r\n    constructor() {\r\n        super(new Text({\r\n            x: 12,\r\n            y: GP.bh - 24,\r\n            fontSize: 12,\r\n            fill: \"#777\",\r\n            text: \"FPS: --\",\r\n        }));\r\n    }\r\n\r\n    relocate(e) {\r\n        if (e.height === e.old.height) return;\r\n        this.y = e.height - 24;\r\n    }\r\n\r\n    assign(fps) {\r\n        if (isNaN(fps)) fps = \"--\";\r\n        this.el.text = \"FPS: \" + fps;\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport { Polygon } from \"leafer-game\";\r\nimport { GP } from \"../core/instances\";\r\n\r\nexport default class E_ForbiddenZone extends GameElement {\r\n    constructor() {\r\n        super(new Polygon({\r\n            points: [\r\n                0, GP.bh,\r\n                0, 0,\r\n                GP.bw, 0,\r\n                GP.bw, GP.bh,\r\n                GP.bw - GP.ENV.paddingSide, GP.bh,\r\n                GP.bw - GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n                GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n                GP.ENV.paddingSide, GP.bh,\r\n            ],\r\n            fill: \"#E85B5B87\",\r\n        }));\r\n    }\r\n\r\n    relocate(e) {\r\n        this.el.points = [\r\n            0, e.height,\r\n            0, 0,\r\n            e.width, 0,\r\n            e.width, e.height,\r\n            e.width - GP.ENV.paddingSide, e.height,\r\n            e.width - GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n            GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n            GP.ENV.paddingSide, e.height,\r\n        ];\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport { Group, Path, Text } from \"leafer-game\";\r\nimport { F, GP, timer } from \"../core/instances\";\r\n\r\nexport default class E_Timing extends GameElement {\r\n    alarm;\r\n    remaining = GP.ENV.timeLimit;\r\n    animatingFlag = false;\r\n\r\n    constructor() {\r\n        super(new Group({\r\n            x: 15,\r\n            y: 15,\r\n        }));\r\n        this.Icon = new GameElement(new Path({\r\n            path: \"M511.488 0C228.864 0 0 229.376 0 512s228.864 512 511.488 512C794.624 1024 1024 794.624 1024 512s-229.376-512-512.512-512z m21.76 556.416V219.52H438.912v392.32h1.472l243.84 140.8 47.296-81.728-198.144-114.432zM512 921.6A409.472 409.472 0 0 1 102.4 512c0-226.304 183.296-409.6 409.6-409.6 226.304 0 409.6 183.296 409.6 409.6 0 226.304-183.296 409.6-409.6 409.6z\",\r\n            x: 0,\r\n            y: 0,\r\n            scale: 0.015625, // 16 / 1024\r\n            fill: \"#262626\",\r\n        }));\r\n        this.IconG = new GameElement(new Group({\r\n            x: 0,\r\n            y: 0,\r\n            width: 16,\r\n            height: 16,\r\n            origin: \"center\",\r\n            children: [this.Icon.el],\r\n        }));\r\n        this.Text = new GameElement(new Text({\r\n            x: 20,\r\n            y: 0,\r\n            fontSize: 16,\r\n            lineHeight: 16,\r\n            text: \"3:00\",\r\n            fill: \"#262626\",\r\n        }));\r\n        this.el.add([this.IconG.el, this.Text.el]);\r\n    }\r\n\r\n    reset() {\r\n        this.remaining = GP.ENV.timeLimit;\r\n        this.animatingFlag = false;\r\n        this.Text.el.text = E_Timing.toMSString(GP.ENV.timeLimit);\r\n        this.Text.el.fontWeight = \"normal\";\r\n        this.Text.el.fill = this.Icon.el.fill = \"#262626\";\r\n    }\r\n\r\n    start() {\r\n        this.alarm = timer.newInterval(this.#secondLoop.bind(this), 1000);\r\n    }\r\n\r\n    stop() {\r\n        timer.cancelInterval(this.alarm);\r\n        if (this.animatingFlag) {\r\n            this.animatingFlag = false;\r\n            this.IconG.el.killAnimate();\r\n        }\r\n    }\r\n\r\n    static toMS(v) {\r\n        return [F(v / 60), v % 60];\r\n    }\r\n\r\n    static toMSString(v) {\r\n        const seconds = v % 60;\r\n        return `${F(v / 60)}:${seconds < 10 ? \"0\" + seconds : seconds}`;\r\n    }\r\n\r\n    #secondLoop() {\r\n        if (--this.remaining < 0) return;\r\n        this.Text.el.text = E_Timing.toMSString(this.remaining);\r\n        if (!this.animatingFlag && this.remaining <= 15) {\r\n            this.animatingFlag = true;\r\n            this.IconG.el.animate(\r\n                [\r\n                    { style: { rotation: 35, y: 0 }, duration: 0.1 },\r\n                    { style: { rotation: -35, y: -3 }, duration: 0.1 },\r\n                    { style: { rotation: 25, y: -3 }, duration: 0.1 },\r\n                    { style: { rotation: -25, y: 0 }, duration: 0.1 },\r\n                ],\r\n                {\r\n                    loop: true,\r\n                    loopDelay: 0.6,\r\n                    join: true,\r\n                },\r\n            );\r\n            this.Icon.el.fill = this.Text.el.fill = \"#44C2F1\";\r\n            this.Text.el.fontWeight = \"bold\";\r\n        }\r\n        if (this.remaining <= 0) GP.gameOver(true);\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport GameElementCentered from \"../utils/GameElementCentered\";\r\nimport { Group, Path, Text } from \"leafer-game\";\r\nimport { Ball, F, GP, timer } from \"../core/instances\";\r\n\r\nexport default class E_Scoring extends GameElement {\r\n    v = 0;\r\n\r\n    constructor() {\r\n        super(new Group({\r\n            x: GP.bw / 2 - 120,\r\n            y: 0,\r\n        }));\r\n        this.Panel = new GameElement(new Path({\r\n            path: \"m -120 0\\n\" +\r\n                \"  h 10\\n\" +\r\n                \"  a 20 15 0 0 1 20 15\\n\" +\r\n                \"  v 35\\n\" +\r\n                \"  a 15 18 0 0 0 15 18\\n\" +\r\n                \"  h 150\\n\" +\r\n                \"  a 15 18 0 0 0 15 -18\\n\" +\r\n                \"  v -35\\n\" +\r\n                \"  a 20 15 0 0 1 20 -15\\n\" +\r\n                \"  h 10\\n\" +\r\n                \"  Z\",\r\n            x: 120,\r\n            y: 0,\r\n            fill: \"#777A\",\r\n        }));\r\n        this.Integer = new GameElement(new Text({\r\n            x: -GP.bw,\r\n            y: 7,\r\n            fontSize: 40,\r\n            fill: \"#FFF\",\r\n            text: \"-\",\r\n            fontFamily: \"HYDiSiKe-U\",\r\n        }));\r\n        this.Decimal = new GameElement(new Text({\r\n            x: -GP.bw,\r\n            y: 15,\r\n            fontSize: 32,\r\n            fill: \"#DDD\",\r\n            text: \"--\",\r\n            fontFamily: \"HYDiSiKe-U\",\r\n        }));\r\n        this.el.add([this.Panel.el, this.Integer.el, this.Decimal.el]);\r\n\r\n        this.init = this.init.bind(this);\r\n    }\r\n\r\n    reset() {\r\n        this.assign(0);\r\n    }\r\n\r\n    relocate(e) {\r\n        if (e.width === e.old.width) return;\r\n        this.cx = e.width / 2;\r\n        this.#newScore();\r\n    }\r\n\r\n    async init() {\r\n        await this.#loadFont();\r\n    }\r\n\r\n    async #loadFont() {\r\n        await GP.fontInitializer(\"HYDiSiKe-U\", \"./assets/fonts/HYDiSiKe-U\");\r\n        this.#newScore();\r\n    }\r\n\r\n    assign(score) {\r\n        this.v = Math.round(score * 10);\r\n        this.#newScore();\r\n        return E_Scoring.stringify(this.v);\r\n    }\r\n\r\n    delta(x) {\r\n        const prevV = this.v;\r\n        this.v += Math.round(x * 10);\r\n        this.#newScore();\r\n        return E_Scoring.stringify(this.v - prevV);\r\n    }\r\n\r\n    tip(delta) {\r\n        const [initialOffsetX, transitionX, transitionY] = this.#getTipData();\r\n        const tip = new GameElementCentered(new Text({\r\n            x: Ball.cx + initialOffsetX,\r\n            y: Ball.oy,\r\n            text: \"+\" + delta,\r\n            fill: \"#FFEF00\",\r\n            stroke: \"#33333333\",\r\n            fontSize: 20,\r\n            fontFamily: \"HYDiSiKe-U\",\r\n            opacity: 0.9,\r\n            shadow: {\r\n                x: 1,\r\n                y: 1,\r\n                blur: 10,\r\n                color: \"gray\",\r\n            },\r\n            animation: {\r\n                keyframes: [\r\n                    { style: { opacity: 0.9, fontSize: 24 }, duration: 0.3 },\r\n                    { style: { opacity: 0, fontSize: 25 }, duration: 0.4 },\r\n                ],\r\n                join: true,\r\n            },\r\n        }));\r\n        tip.render();\r\n        tip.el.animate([\r\n            { offsetX: transitionX },\r\n        ], {\r\n            duration: 0.45,\r\n            easing: \"sine-out\",\r\n            join: true,\r\n        });\r\n        tip.el.animate([\r\n            { style: { offsetY: -12 }, duration: 0.12, easing: \"quad-out\" },\r\n            { style: { offsetY: transitionY }, duration: 0.28, easing: \"quad-in-out\" },\r\n        ], {\r\n            join: true,\r\n        });\r\n        timer.newTimeout(function () {\r\n            tip.destroy();\r\n        }, 600);\r\n    }\r\n\r\n    #getTipData() {\r\n        const ballSpeedAffect = 0.7 * Ball.vx * 600 / GP.ENV.actUnitInterval;\r\n        let direction = Math.random() >= 0.5 ? 1 : -1;\r\n        let initialOffsetX = (10 + Math.random() * 20) * direction;\r\n        let transitionX0 = (40 + Math.random() * 20) * direction;\r\n        let transitionY = (Math.random() - 0.4) * 24;\r\n        const totalTranslationX = initialOffsetX + transitionX0 + ballSpeedAffect;\r\n        if (Ball.cx + totalTranslationX <= GP.ENV.paddingSide) {\r\n            initialOffsetX *= -1;\r\n            transitionX0 *= -1;\r\n        } else if (Ball.cx + totalTranslationX >= GP.bw - GP.ENV.paddingSide) {\r\n            initialOffsetX *= -1;\r\n            transitionX0 *= -1;\r\n        }\r\n        return [initialOffsetX + ballSpeedAffect / 2, transitionX0 + ballSpeedAffect / 2, transitionY];\r\n    }\r\n\r\n    #newScore() {\r\n        this.Integer.el.text = F(this.v / 10);\r\n        this.Decimal.el.text = \".\" + this.v % 10;\r\n        this.Integer.x = (240 - this.Integer.w - this.Decimal.w) / 2;\r\n        this.Decimal.x = this.Integer.ox;\r\n    }\r\n\r\n    static stringify(v) {\r\n        return `${F(v / 10)}.${v % 10}`;\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport { Rect, Keyboard } from \"leafer-game\";\r\nimport { GI, GP, Tablet } from \"../core/instances\";\r\n\r\nexport default class E_Tablet extends GameElement {\r\n    vxMax;\r\n    vyMax;\r\n    vx;\r\n    vy;\r\n    availZone = [80, 40, 0, 40]; // Top, Right, Bottom, Left\r\n\r\n    constructor() {\r\n        super(new Rect({\r\n            width: 120, // 120\r\n            height: 25,\r\n            fill: \"#32CD79\",\r\n        }));\r\n    }\r\n\r\n    reset() {\r\n        this.vxMax = 6;\r\n        this.vyMax = 2.8;\r\n        this.vx = 0;\r\n        this.vy = 0;\r\n        this.cx = GP.bw / 2;\r\n        this.y = GP.bh - 140;\r\n    }\r\n\r\n    frameLoop(prog) {\r\n        this.vx = this.vy = 0;\r\n        if (Keyboard.isHold(\"KeyW\") || Keyboard.isHold(\"ArrowUp\")) {\r\n            this.vy -= this.vyMax * prog;\r\n        }\r\n        if (Keyboard.isHold(\"KeyS\") || Keyboard.isHold(\"ArrowDown\")) {\r\n            this.vy += this.vyMax * prog;\r\n        }\r\n        if (Keyboard.isHold(\"KeyA\") || Keyboard.isHold(\"ArrowLeft\")) {\r\n            this.vx -= this.vxMax * prog;\r\n        }\r\n        if (Keyboard.isHold(\"KeyD\") || Keyboard.isHold(\"ArrowRight\")) {\r\n            this.vx += this.vxMax * prog;\r\n        }\r\n        this.x += this.vx;\r\n        this.y += this.vy;\r\n        GI.borderDetect(Tablet, {\r\n            paddings: this.availZone,\r\n        });\r\n    }\r\n}\r\n","import GameElementCentered from \"../utils/GameElementCentered\";\r\nimport { Ellipse, AnimateEvent } from \"leafer-game\";\r\nimport { Ball, C, F, GP, leafer } from \"../core/instances\";\r\n\r\nexport default class EX_BallTrailing {\r\n    length = 8;\r\n    dotRadius = 5.5;\r\n    loopIdx = 0;\r\n    dotIdx = -1;\r\n    dots = new Map();\r\n    activeAnimations = new Map();\r\n    framesInterval = 5; // based on 60Hz\r\n\r\n    constructor() {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this.dots.set(i, new GameElementCentered(new Ellipse({\r\n                x: -100,\r\n                y: -100,\r\n                width: this.dotRadius * 2,\r\n                height: this.dotRadius * 2,\r\n                fill: \"#FF4500BA\",\r\n                visible: false,\r\n            })));\r\n        }\r\n    }\r\n\r\n    render() {\r\n        for (let d of this.dots.values()) {\r\n            leafer.add(d.el);\r\n        }\r\n    }\r\n\r\n    prepare() {\r\n        if (GP.ENV.actUnitInterval >= 25) {\r\n            this.framesInterval = C(94 / GP.ENV.actUnitInterval);\r\n        } else {\r\n            this.framesInterval = F(94 / GP.ENV.actUnitInterval);\r\n        }\r\n    }\r\n\r\n    frameLoop(steps) {\r\n        this.loopIdx = (this.loopIdx + 1) % this.framesInterval;\r\n        if (this.loopIdx === 0) {\r\n            const idx = this.dotIdx = (this.dotIdx + 1) % this.length;\r\n            const dot = this.dots.get(idx);\r\n            dot.w = dot.h = this.dotRadius * 2;\r\n            dot.el.opacity = 1;\r\n            dot.cx = Ball.cx;\r\n            dot.cy = Ball.cy;\r\n            dot.el.visible = true;\r\n            if (this.activeAnimations.has(idx)) {\r\n                const oldAni = this.activeAnimations.get(idx);\r\n                oldAni.off(AnimateEvent.COMPLETED);\r\n                leafer.killAnimate(oldAni);\r\n                this.activeAnimations.delete(idx);\r\n            }\r\n            const ani = dot.el.animate(\r\n                [\r\n                    { opacity: 1, width: this.dotRadius * 2, height: this.dotRadius * 2 },\r\n                    { opacity: 0.3, width: 5, height: 5 },\r\n                ],\r\n                {\r\n                    duration: (GP.ENV.stdUnitInterval * this.framesInterval * this.length) / steps / 1000,\r\n                    easing: \"linear\",\r\n                },\r\n            );\r\n            ani.on(AnimateEvent.COMPLETED, () => {\r\n                this.activeAnimations.delete(idx);\r\n                dot.el.visible = false;\r\n                dot.w = dot.h = this.dotRadius * 2;\r\n                dot.el.opacity = 1;\r\n            });\r\n            this.activeAnimations.set(idx, ani);\r\n        }\r\n    }\r\n}\r\n","import GameElement from \"../utils/GameElement\";\r\nimport { Ellipse } from \"leafer-game\";\r\nimport EX_BallTrailing from \"../elements_extensions/EX_BallTrailing\";\r\nimport { GI, GP, leafer, Timing } from \"../core/instances\";\r\n\r\nexport default class E_Ball extends GameElement {\r\n    vx;\r\n    ax;\r\n    ay;\r\n    timeDivisor = 1;\r\n\r\n    constructor() {\r\n        super(new Ellipse({\r\n            width: 20,\r\n            height: 20,\r\n            fill: \"#20A8D7\",\r\n        }));\r\n        this.trailing = new EX_BallTrailing();\r\n    }\r\n\r\n    reset() {\r\n        this.vx = (Math.random() * 2.7 + 0.8) * (Math.random() > 0.5 ? 1 : -1);\r\n        this.vy = 3.5;\r\n        this.ax = 1.27e-4;\r\n        this.ay = 1.43e-4;\r\n        this.cx = GP.bw / 2;\r\n        this.cy = GP.bh / 4;\r\n    }\r\n\r\n    render() {\r\n        this.trailing.render();\r\n        leafer.add(this.el);\r\n    }\r\n\r\n    prepare() {\r\n        this.trailing.prepare();\r\n    }\r\n\r\n    frameLoop(prog) {\r\n        if (Timing.remaining >= 70 && Timing.remaining < 160) {\r\n            this.vx *= (1 + this.ax) ** prog;\r\n            this.vy *= (1 + this.ay) ** prog;\r\n            this.ax *= 0.99987;\r\n            this.ay *= 0.99987;\r\n        }\r\n        this.x += this.vx * prog;\r\n        this.y += this.vy * prog;\r\n        GI.borderDetect(this, {\r\n            bounce: true,\r\n            paddings: [0, 0, -this.h * 3, 0],\r\n            callbacks: [null, null, GP.gameOver/*null*/, null],\r\n        });\r\n        this.trailing.frameLoop(this.timeDivisor);\r\n    }\r\n}\r\n","import { Leafer } from \"leafer-game\";\r\nimport { GameProcessor } from \"../utils/GameProcessor\";\r\nimport GameInteraction from \"../utils/GameInteraction\";\r\nimport EmbeddedTimer from \"../utils/EmbeddedTimer\";\r\nimport E_Mask from \"../elements/E_Mask\";\r\nimport E_Settlement from \"../elements/E_Settlement\";\r\nimport E_FPS from \"../elements/E_FPS\";\r\nimport E_ForbiddenZone from \"../elements/E_ForbiddenZone\";\r\nimport E_Timing from \"../elements/E_Timing\";\r\nimport E_Scoring from \"../elements/E_Scoring\";\r\nimport E_Tablet from \"../elements/E_Tablet\";\r\nimport E_Ball from \"../elements/E_Ball\";\r\n\r\nexport const D = Math.abs;\r\nexport const C = Math.ceil;\r\nexport const F = Math.floor;\r\n\r\nexport let prevTimeStamp;\r\n\r\nexport function setPrevTimeStamp(v) {\r\n    prevTimeStamp = v;\r\n}\r\n\r\nexport const loading = document.querySelector(\"#loading\");\r\n\r\nexport const leafer = new Leafer({\r\n    view: document.querySelector(\"canvas\"),\r\n    fill: \"#EFF\",\r\n});\r\n\r\nexport const GP = new GameProcessor({\r\n    refreshRate: 60,\r\n    actUnitInterval: 16.7,\r\n    stdUnitInterval: 16.7,\r\n    fixedStep: 16.7,\r\n    maxStepPerFrame: 10,\r\n    paddingTop: 80,\r\n    paddingSide: 40,\r\n    timeLimit: 180,\r\n});\r\n\r\nexport const GI = new GameInteraction();\r\nexport const timer = new EmbeddedTimer({\r\n    minInterval: 0,\r\n    autoHandleFPS: true,\r\n});\r\n\r\nexport const Mask = new E_Mask();\r\nexport const Settlement = new E_Settlement();\r\nexport const FPS = new E_FPS();\r\nexport const ForbiddenZone = new E_ForbiddenZone();\r\nexport const Timing = new E_Timing();\r\nexport const Scoring = new E_Scoring();\r\nexport const Tablet = new E_Tablet();\r\nexport const Ball = new E_Ball();\r\n","import {\r\n    setPrevTimeStamp,\r\n    F,\r\n    D,\r\n    prevTimeStamp,\r\n    loading,\r\n    leafer,\r\n    GI,\r\n    GP,\r\n    timer,\r\n    Mask,\r\n    Settlement,\r\n    FPS,\r\n    ForbiddenZone,\r\n    Timing,\r\n    Scoring,\r\n    Tablet,\r\n    Ball,\r\n} from \"./core/instances\";\r\n\r\nimport {\r\n    ResizeEvent,\r\n    KeyEvent,\r\n} from \"leafer-game\";\r\n\r\nloading.addEventListener(\"dragstart\", e => e.preventDefault());\r\n\r\nlet accumulated = 0;\r\n\r\nMask.render(\"#FFF\", 1, 0.7, 0.4);\r\nbeforeStart();\r\nGP.renderAll();\r\nrequestAnimationFrame(firstFrame);\r\ntimer.newInterval(() => FPS.assign(timer.FPS), 400);\r\nGP.initializeAll()\r\n    .then(() => GP.state(\"init1\"))\r\n    .catch(err => console.error(\"Initialization failed...\\n\", err));\r\n\r\nfunction beforeStart() {\r\n    Timing.reset();\r\n    Tablet.reset();\r\n    Ball.reset();\r\n}\r\n\r\nfunction firstFrame(timeStamp) {\r\n    setPrevTimeStamp(timeStamp);\r\n    gameLoop(timeStamp);\r\n}\r\n\r\nfunction gameLoop(timeStamp) {\r\n    const deltaTime = timeStamp - prevTimeStamp;\r\n    setPrevTimeStamp(timeStamp);\r\n    timer.timeDetect(timeStamp);\r\n\r\n    if (GP.at(\"init1\")) {\r\n        GP.measureRefreshRate(deltaTime / GP.ENV.stdUnitInterval);\r\n    } else if (GP.at(\"init2\")) {\r\n        Ball.prepare();\r\n        GP.state(\"almost-prepared\");\r\n    } else if (GP.at(\"almost-prepared\")) {\r\n        GP.state(\"prepared\");\r\n        Mask.cull();\r\n        GP.loadingFadeOut();\r\n    }\r\n\r\n    let steps = 1;\r\n    if (GP.at(\"playing\")) {\r\n        accumulated += Math.min(deltaTime, 3000); // can redisplay frames of up to 3s\r\n        Ball.timeDivisor = Math.min(F(accumulated / GP.ENV.fixedStep), GP.ENV.maxStepPerFrame);\r\n        while (accumulated >= GP.ENV.fixedStep && steps <= GP.ENV.maxStepPerFrame) { // sub-stepping loop\r\n            accumulated -= GP.ENV.fixedStep;\r\n            ++steps;\r\n            const unitProg = GP.ENV.fixedStep / GP.ENV.stdUnitInterval;\r\n            Ball.frameLoop(unitProg);\r\n            Tablet.frameLoop(unitProg);\r\n            if (GI.collisionDetect() && Ball.vy < 0) {\r\n                const bv = Math.sqrt(Ball.vx ** 2 + Ball.vy ** 2);\r\n                const bvP = Math.log2(bv) + 1 / Math.cos(Math.PI / 20 * bv);\r\n                const d = D(Tablet.cx - Ball.cx);\r\n                const dP = Math.cos(Math.PI / Tablet.w * 2 * d) + 0.5;\r\n                Scoring.tip(Scoring.delta(0.7 * bvP + 0.3 * dP));\r\n            }\r\n        }\r\n    }\r\n\r\n    requestAnimationFrame(gameLoop);\r\n}\r\n\r\ndocument.addEventListener(\"visibilitychange\", function () {\r\n    if (document.hidden) {\r\n        GP.pause();\r\n    } else {\r\n        GP.resume();\r\n    }\r\n});\r\nleafer.on(ResizeEvent.RESIZE, function (e) {\r\n    Mask.relocate(e);\r\n    Settlement.relocate(e);\r\n    FPS.relocate(e);\r\n    ForbiddenZone.relocate(e);\r\n    Scoring.relocate(e);\r\n});\r\nleafer.on(KeyEvent.HOLD, function (e) {\r\n    e.code === \"Semicolon\" && FPS.toggle();\r\n});\r\nleafer.on(KeyEvent.UP, function (e) {\r\n    if (e.code === \"Space\") {\r\n        if (GP.at(\"prepared\")) {\r\n            GP.state(\"playing\");\r\n            Timing.start();\r\n        } else if (GP.at(\"over\")) {\r\n            GP.reset();\r\n            GP.state(\"playing\");\r\n            Timing.start();\r\n        }\r\n    }\r\n});\r\n"],"names":["GameProcessor","#SM","ENV","newState","states","Scoring","Settlement","ForbiddenZone","Tablet","Ball","Timing","FPS","prog","rrKey","curValue","maxV","k4maxV","k","v","GP","name","src","font","leafer","font2","e","Mask","timer","setPrevTimeStamp","win","loading","GameInteraction","ge","bounce","paddings","callbacks","bounceRatio","#AABBDetect","initialJudged","D","cnxFlag","cnyFlag","cnx","cnxR","cny","cnyR","radius","deltaX","deltaY","direction","now","vName","ratio1","ratio2","vBuff","vUnitNerf","Queue","item","EmbeddedTimer","#timeoutMap","#timeout2delete","#intervalMap","#interval2delete","#FPSHandlerID","#FPSTimeQueue","#FPSFramesCnt","#FPSElapsed","#cachedFPS","#lastFPSCalcTime","#config","options","timeStamp","#timeoutFrame","#intervalFrame","symbol","duty","callback","timeout","toAdd","interval","sType","#whichType","str","#isFPSHandlerRunning","data","#calcFPS","approxFPS","adjustRatio","GameElement","#zIndex","el","zIndex","E_Mask","Rect","fill","fromOpacity","toOpacity","duration","GameElementCentered","E_Settlement","Text","#loadFont","#preloadImage","#loadAndTransferImg","img","Platform","Resource","#setTextFill","#setShadowColor","color","E_FPS","fps","E_ForbiddenZone","Polygon","E_Timing","Group","Path","#secondLoop","F","seconds","E_Scoring","#newScore","score","x","prevV","delta","initialOffsetX","transitionX","transitionY","#getTipData","tip","ballSpeedAffect","transitionX0","totalTranslationX","E_Tablet","Keyboard","GI","EX_BallTrailing","i","Ellipse","d","C","steps","idx","dot","oldAni","AnimateEvent","ani","E_Ball","prevTimeStamp","Leafer","accumulated","beforeStart","firstFrame","err","gameLoop","deltaTime","unitProg","bv","bvP","dP","ResizeEvent","KeyEvent"],"mappings":"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"}