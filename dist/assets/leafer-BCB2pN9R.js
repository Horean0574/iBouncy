var uo;(function(e){e[e.No=0]="No",e[e.Yes=1]="Yes",e[e.NoAndSkip=2]="NoAndSkip",e[e.YesAndSkip=3]="YesAndSkip"})(uo||(uo={}));const Od={};function P(e){return e===void 0}function Pt(e){return e==null}function J(e){return typeof e=="string"}const{isFinite:co}=Number;function I(e){return typeof e=="number"}const{isArray:Q}=Array;function W(e){return e&&typeof e=="object"}function Ad(e){return JSON.stringify(e)==="{}"}const Z={default:(e,t)=>(Ls(t,e),Ls(e,t),e),assign(e,t,i){let s;Object.keys(t).forEach(r=>{var n,o;if(s=t[r],s?.constructor===Object&&((n=e[r])===null||n===void 0?void 0:n.constructor)===Object)return Ls(e[r],t[r],i&&i[r]);i&&r in i?((o=i[r])===null||o===void 0?void 0:o.constructor)===Object&&Ls(e[r]={},t[r],i[r]):e[r]=t[r]})},copyAttrs:(e,t,i)=>(i.forEach(s=>{P(t[s])||(e[s]=t[s])}),e),clone:e=>JSON.parse(JSON.stringify(e)),toMap(e){const t={};for(let i=0,s=e.length;i<s;i++)t[e[i]]=!0;return t},stintSet(e,t,i){i||(i=void 0),e[t]!==i&&(e[t]=i)}},{assign:Ls}=Z;let Gl=class{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&t.length===6&&t[0]===1}get __usePathBox(){return this.__pathInputed}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";const{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const i=this.__input[t];if(!P(i))return i}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:i}=this;let s;for(let r in this)r[0]!=="_"&&(s=i?i[r]:void 0,t[r]=P(s)?this[r]:s);return t}__setInput(t,i){this.__input||(this.__input={}),this.__input[t]=i}__getInput(t){if(this.__input){const i=this.__input[t];if(!P(i))return i}if(t!=="path"||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&!P(this.__input[t])&&(this.__input[t]=void 0)}__getInputData(t,i){const s={};if(t)if(Q(t))for(let r of t)s[r]=this.__getInput(r);else for(let r in t)s[r]=this.__getInput(r);else{let r,n,{__input:o}=this;s.tag=this.__leaf.tag;for(let a in this)if(a[0]!=="_"&&(r=this["_"+a],!P(r))){if(a==="path"&&!this.__pathInputed)continue;n=o?o[a]:void 0,s[a]=P(n)?r:n}}if(i&&i.matrix){const{a:r,b:n,c:o,d:a,e:h,f:d}=this.__leaf.__localMatrix;s.matrix={a:r,b:n,c:o,d:a,e:h,f:d}}return s}__setMiddle(t,i){this.__middle||(this.__middle={}),this.__middle[t]=i}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if(t.blendMode==="pass-through"){const i=this.__leaf;t.opacity<1&&(i.isBranch||t.__hasMultiPaint)||i.__hasEraser||t.eraser||t.filter?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}};const{floor:Ko,max:Qo}=Math,S={toURL(e,t){let i=encodeURIComponent(e);return t==="text"?i="data:text/plain;charset=utf-8,"+i:t==="svg"&&(i="data:image/svg+xml,"+i),i},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",isLarge:(e,t,i,s)=>e.width*e.height*(t?t*i:1)>(s||qr.maxCacheSize),isSuperLarge:(e,t,i)=>qr.isLarge(e,t,i,qr.maxPatternSize),getRealURL(e){const{prefix:t,suffix:i}=S.image;return!i||e.startsWith("data:")||e.startsWith("blob:")||(e+=(e.includes("?")?"&":"?")+i),t&&e[0]==="/"&&(e=t+e),e},resize(e,t,i,s,r,n,o,a,h){const d=S.origin.createCanvas(Qo(Ko(t+(s||0)),1),Qo(Ko(i+(r||0)),1)),u=d.getContext("2d");if(a&&(u.globalAlpha=a),u.imageSmoothingEnabled=o!==!1,e)if(n){const l=t/n.width,c=i/n.height;u.setTransform(l,0,0,c,-n.x*l,-n.y*c),u.drawImage(e,0,0,e.width,e.height)}else u.drawImage(e,0,0,t,i);return d},setPatternTransform(e,t,i){try{t&&e.setTransform&&(e.setTransform(t),t=void 0)}catch{}i&&Z.stintSet(i,"transform",t)}}},{image:qr}=S,Re={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(e){const{types:t}=Dd;return t[e]?t[e]++:(t[e]=1,0)}},Dd=Re;let Mt,$t,Gr;const{max:Ui}=Math,Kr=[0,0,0,0],Nr={zero:[...Kr],tempFour:Kr,set:(e,t,i,s,r)=>(i===void 0&&(i=s=r=t),e[0]=t,e[1]=i,e[2]=s,e[3]=r,e),setTemp:(e,t,i,s)=>Os(Kr,e,t,i,s),toTempAB(e,t,i){Gr=i?I(e)?t:e:[],I(e)?(Mt=Zo(e),$t=t):I(t)?(Mt=e,$t=Zo(t)):(Mt=e,$t=t),Mt.length!==4&&(Mt=Qr(Mt)),$t.length!==4&&($t=Qr($t))},get(e,t){let i;if(!I(e))switch(e.length){case 4:i=P(t)?e:[...e];break;case 2:i=[e[0],e[1],e[0],e[1]];break;case 3:i=[e[0],e[1],e[2],e[1]];break;case 1:e=e[0];break;default:e=0}if(i||(i=[e,e,e,e]),!P(t))for(let s=0;s<4;s++)i[s]>t&&(i[s]=t);return i},max:(e,t,i)=>I(e)&&I(t)?Ui(e,t):(Jo(e,t,i),Os(Gr,Ui(Mt[0],$t[0]),Ui(Mt[1],$t[1]),Ui(Mt[2],$t[2]),Ui(Mt[3],$t[3]))),add:(e,t,i)=>I(e)&&I(t)?e+t:(Jo(e,t,i),Os(Gr,Mt[0]+$t[0],Mt[1]+$t[1],Mt[2]+$t[2],Mt[3]+$t[3])),swapAndScale(e,t,i,s){if(I(e))return t===i?e*t:[e*i,e*t];const r=s?e:[],[n,o,a,h]=e.length===4?e:Qr(e);return Os(r,a*i,h*t,n*i,o*t)}},{set:Os,get:Qr,setTemp:Zo,toTempAB:Jo}=Nr,{round:Md,pow:$d,max:Fd,floor:Id,PI:Fo}=Math,wt={within:(e,t,i)=>(W(t)&&(i=t.max,t=t.min),!P(t)&&e<t&&(e=t),!P(i)&&e>i&&(e=i),e),fourNumber:Nr.get,formatRotation:(e,t)=>(e%=360,t?e<0&&(e+=360):(e>180&&(e-=360),e<-180&&(e+=360)),wt.float(e)),getGapRotation(e,t,i=0){let s=e+i;if(t>1){const r=Math.abs(s%t);(r<1||r>t-1)&&(s=Math.round(s/t)*t)}return s-i},float(e,t){const i=P(t)?1e12:$d(10,t);return(e=Md(e*i)/i)===-0?0:e},sign:e=>e<0?-1:1,getScaleData(e,t,i,s){if(s||(s={}),t){const r=(I(t)?t:t.width||0)/i.width,n=(I(t)?t:t.height||0)/i.height;s.scaleX=r||n||1,s.scaleY=n||r||1}else e&&wt.assignScale(s,e);return s},assignScale(e,t){I(t)?e.scaleX=e.scaleY=t:(e.scaleX=t.x,e.scaleY=t.y)},getFloorScale:(e,t=1)=>Fd(Id(e),t)/e,randInt:As,randColor:e=>`rgba(${As(255)},${As(255)},${As(255)},${e||1})`};function As(e){return Math.round(Math.random()*e)}const G=Fo/180,Jt=2*Fo,Mi=Fo/2;function Wd(){return{x:0,y:0}}function Kl(){return{x:0,y:0,width:0,height:0}}function Ql(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:Zr,cos:Jr,acos:Ds,sqrt:tn}=Math,{float:yi}=wt,mi={};function ta(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const C={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:ta(),tempMatrix:{},set(e,t=1,i=0,s=0,r=1,n=0,o=0){e.a=t,e.b=i,e.c=s,e.d=r,e.e=n,e.f=o},get:Ql,getWorld:ta,copy(e,t){e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f},translate(e,t,i){e.e+=t,e.f+=i},translateInner(e,t,i,s){e.e+=e.a*t+e.c*i,e.f+=e.b*t+e.d*i,s&&(e.e-=t,e.f-=i)},scale(e,t,i=t){e.a*=t,e.b*=t,e.c*=i,e.d*=i},pixelScale(e,t,i){i||(i=e),i.a=e.a*t,i.b=e.b*t,i.c=e.c*t,i.d=e.d*t,i.e=e.e*t,i.f=e.f*t},scaleOfOuter(e,t,i,s){nt.toInnerPoint(e,t,mi),nt.scaleOfInner(e,mi,i,s)},scaleOfInner(e,t,i,s=i){nt.translateInner(e,t.x,t.y),nt.scale(e,i,s),nt.translateInner(e,-t.x,-t.y)},rotate(e,t){const{a:i,b:s,c:r,d:n}=e,o=Jr(t*=G),a=Zr(t);e.a=i*o-s*a,e.b=i*a+s*o,e.c=r*o-n*a,e.d=r*a+n*o},rotateOfOuter(e,t,i){nt.toInnerPoint(e,t,mi),nt.rotateOfInner(e,mi,i)},rotateOfInner(e,t,i){nt.translateInner(e,t.x,t.y),nt.rotate(e,i),nt.translateInner(e,-t.x,-t.y)},skew(e,t,i){const{a:s,b:r,c:n,d:o}=e;i&&(i*=G,e.a=s+n*i,e.b=r+o*i),t&&(t*=G,e.c=n+s*t,e.d=o+r*t)},skewOfOuter(e,t,i,s){nt.toInnerPoint(e,t,mi),nt.skewOfInner(e,mi,i,s)},skewOfInner(e,t,i,s=0){nt.translateInner(e,t.x,t.y),nt.skew(e,i,s),nt.translateInner(e,-t.x,-t.y)},multiply(e,t){const{a:i,b:s,c:r,d:n,e:o,f:a}=e;e.a=t.a*i+t.b*r,e.b=t.a*s+t.b*n,e.c=t.c*i+t.d*r,e.d=t.c*s+t.d*n,e.e=t.e*i+t.f*r+o,e.f=t.e*s+t.f*n+a},multiplyParent(e,t,i,s,r){const{e:n,f:o}=e;if(i||(i=e),P(s)&&(s=e.a!==1||e.b||e.c||e.d!==1),s){const{a,b:h,c:d,d:u}=e;i.a=a*t.a+h*t.c,i.b=a*t.b+h*t.d,i.c=d*t.a+u*t.c,i.d=d*t.b+u*t.d,r&&(i.scaleX=t.scaleX*r.scaleX,i.scaleY=t.scaleY*r.scaleY)}else i.a=t.a,i.b=t.b,i.c=t.c,i.d=t.d,r&&(i.scaleX=t.scaleX,i.scaleY=t.scaleY);i.e=n*t.a+o*t.c+t.e,i.f=n*t.b+o*t.d+t.f},divide(e,t){nt.multiply(e,nt.tempInvert(t))},divideParent(e,t){nt.multiplyParent(e,nt.tempInvert(t))},tempInvert(e){const{tempMatrix:t}=nt;return nt.copy(t,e),nt.invert(t),t},invert(e){const{a:t,b:i,c:s,d:r,e:n,f:o}=e;if(i||s){const a=1/(t*r-i*s);e.a=r*a,e.b=-i*a,e.c=-s*a,e.d=t*a,e.e=-(n*r-o*s)*a,e.f=-(o*t-n*i)*a}else if(t===1&&r===1)e.e=-n,e.f=-o;else{const a=1/(t*r);e.a=r*a,e.d=t*a,e.e=-n*r*a,e.f=-o*t*a}},toOuterPoint(e,t,i,s){const{x:r,y:n}=t;i||(i=t),i.x=r*e.a+n*e.c,i.y=r*e.b+n*e.d,s||(i.x+=e.e,i.y+=e.f)},toInnerPoint(e,t,i,s){const{a:r,b:n,c:o,d:a}=e,h=1/(r*a-n*o),{x:d,y:u}=t;if(i||(i=t),i.x=(d*a-u*o)*h,i.y=(u*r-d*n)*h,!s){const{e:l,f:c}=e;i.x-=(l*a-c*o)*h,i.y-=(c*r-l*n)*h}},setLayout(e,t,i,s,r){const{x:n,y:o,scaleX:a,scaleY:h}=t;if(P(r)&&(r=t.rotation||t.skewX||t.skewY),r){const{rotation:d,skewX:u,skewY:l}=t,c=d*G,_=Jr(c),g=Zr(c);if(u||l){const y=u*G,f=l*G;e.a=(_+f*-g)*a,e.b=(g+f*_)*a,e.c=(y*_-g)*h,e.d=(_+y*g)*h}else e.a=_*a,e.b=g*a,e.c=-g*h,e.d=_*h}else e.a=a,e.b=0,e.c=0,e.d=h;e.e=n,e.f=o,(i=i||s)&&nt.translateInner(e,-i.x,-i.y,!s)},getLayout(e,t,i,s){const{a:r,b:n,c:o,d:a,e:h,f:d}=e;let u,l,c,_,g,y=h,f=d;if(n||o){const w=r*a-n*o;if(o&&!s){u=tn(r*r+n*n),l=w/u;const b=r/u;c=n>0?Ds(b):-Ds(b)}else{l=tn(o*o+a*a),u=w/l;const b=o/l;c=Mi-(a>0?Ds(-b):-Ds(b))}const v=yi(Jr(c)),x=Zr(c);u=yi(u),l=yi(l),_=v?yi((o/l+x)/v/G,9):0,g=v?yi((n/u-x)/v/G,9):0,c=yi(c/G)}else u=r,l=a,c=_=g=0;return(t=i||t)&&(y+=t.x*r+t.y*o,f+=t.x*n+t.y*a,i||(y-=t.x,f-=t.y)),{x:y,y:f,scaleX:u,scaleY:l,rotation:c,skewX:_,skewY:g}},withScale(e,t,i=t){const s=e;if(!t||!i){const{a:r,b:n,c:o,d:a}=e;n||o?i=(r*a-n*o)/(t=tn(r*r+n*n)):(t=r,i=a)}return s.scaleX=t,s.scaleY=i,s},reset(e){nt.set(e)}},nt=C,{float:Ms}=wt,{toInnerPoint:en,toOuterPoint:ea}=C,{sin:ia,cos:sa,abs:ra,sqrt:Nd,atan2:zd,min:Yd,round:$s}=Math,L={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(e,t=0,i=0){e.x=t,e.y=i},setRadius(e,t,i){e.radiusX=t,e.radiusY=P(i)?t:i},copy(e,t){e.x=t.x,e.y=t.y},copyFrom(e,t,i){e.x=t,e.y=i},round(e,t){e.x=t?$s(e.x-.5)+.5:$s(e.x),e.y=t?$s(e.y-.5)+.5:$s(e.y)},move(e,t,i){W(t)?(e.x+=t.x,e.y+=t.y):(e.x+=t,e.y+=i)},scale(e,t,i=t){e.x&&(e.x*=t),e.y&&(e.y*=i)},scaleOf(e,t,i,s=i){e.x+=(e.x-t.x)*(i-1),e.y+=(e.y-t.y)*(s-1)},rotate(e,t,i){i||(i=si.defaultPoint);const s=sa(t*=G),r=ia(t),n=e.x-i.x,o=e.y-i.y;e.x=i.x+n*s-o*r,e.y=i.y+n*r+o*s},tempToInnerOf(e,t){const{tempPoint:i}=si;return Fs(i,e),en(t,i,i),i},tempToOuterOf(e,t){const{tempPoint:i}=si;return Fs(i,e),ea(t,i,i),i},tempToInnerRadiusPointOf(e,t){const{tempRadiusPoint:i}=si;return Fs(i,e),si.toInnerRadiusPointOf(e,t,i),i},copyRadiusPoint:(e,t,i,s)=>(Fs(e,t),Xd(e,i,s),e),toInnerRadiusPointOf(e,t,i){i||(i=e),en(t,e,i),i.radiusX=Math.abs(e.radiusX/t.scaleX),i.radiusY=Math.abs(e.radiusY/t.scaleY)},toInnerOf(e,t,i){en(t,e,i)},toOuterOf(e,t,i){ea(t,e,i)},getCenter:(e,t)=>({x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}),getCenterX:(e,t)=>e+(t-e)/2,getCenterY:(e,t)=>e+(t-e)/2,getDistance:(e,t)=>sn(e.x,e.y,t.x,t.y),getDistanceFrom(e,t,i,s){const r=ra(i-e),n=ra(s-t);return Nd(r*r+n*n)},getMinDistanceFrom:(e,t,i,s,r,n)=>Yd(sn(e,t,i,s),sn(i,s,r,n)),getAngle:(e,t)=>na(e,t)/G,getRotation:(e,t,i,s)=>(s||(s=t),si.getRadianFrom(e.x,e.y,t.x,t.y,i.x,i.y,s.x,s.y)/G),getRadianFrom(e,t,i,s,r,n,o,a){P(o)&&(o=i,a=s);const h=e-i,d=t-s,u=r-o,l=n-a;return Math.atan2(h*l-d*u,h*u+d*l)},getAtan2:(e,t)=>zd(t.y-e.y,t.x-e.x),getDistancePoint(e,t,i,s,r){const n=na(e,t);return r&&(e=t),s||(t={}),t.x=e.x+sa(n)*i,t.y=e.y+ia(n)*i,t},toNumberPoints(e){let t=e;return W(e[0])&&(t=[],e.forEach(i=>t.push(i.x,i.y))),t},isSame:(e,t)=>Ms(e.x)===Ms(t.x)&&Ms(e.y)===Ms(t.y),reset(e){}},si=L,{getDistanceFrom:sn,copy:Fs,setRadius:Xd,getAtan2:na}=si;let jd=class Er{constructor(t,i){this.set(t,i)}set(t,i){return W(t)?L.copy(this,t):L.set(this,t,i),this}get(){const{x:t,y:i}=this;return{x:t,y:i}}clone(){return new Er(this)}move(t,i){return L.move(this,t,i),this}scale(t,i){return L.scale(this,t,i),this}scaleOf(t,i,s){return L.scaleOf(this,t,i,s),this}rotate(t,i){return L.rotate(this,t,i),this}rotateOf(t,i){return L.rotate(this,i,t),this}getRotation(t,i,s){return L.getRotation(this,t,i,s)}toInnerOf(t,i){return L.toInnerOf(this,t,i),this}toOuterOf(t,i){return L.toOuterOf(this,t,i),this}getCenter(t){return new Er(L.getCenter(this,t))}getDistance(t){return L.getDistance(this,t)}getDistancePoint(t,i,s,r){return new Er(L.getDistancePoint(this,t,i,s,r))}getAngle(t){return L.getAngle(this,t)}getAtan2(t){return L.getAtan2(this,t)}isSame(t){return L.isSame(this,t)}reset(){return this}};new jd;let li=class Zl{constructor(t,i,s,r,n,o){this.set(t,i,s,r,n,o)}set(t,i,s,r,n,o){return W(t)?C.copy(this,t):C.set(this,t,i,s,r,n,o),this}setWith(t){return C.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:i,c:s,d:r,e:n,f:o}=this;return{a:t,b:i,c:s,d:r,e:n,f:o}}clone(){return new Zl(this)}translate(t,i){return C.translate(this,t,i),this}translateInner(t,i){return C.translateInner(this,t,i),this}scale(t,i){return C.scale(this,t,i),this}scaleWith(t,i){return C.scale(this,t,i),this.scaleX*=t,this.scaleY*=i||t,this}pixelScale(t){return C.pixelScale(this,t),this}scaleOfOuter(t,i,s){return C.scaleOfOuter(this,t,i,s),this}scaleOfInner(t,i,s){return C.scaleOfInner(this,t,i,s),this}rotate(t){return C.rotate(this,t),this}rotateOfOuter(t,i){return C.rotateOfOuter(this,t,i),this}rotateOfInner(t,i){return C.rotateOfInner(this,t,i),this}skew(t,i){return C.skew(this,t,i),this}skewOfOuter(t,i,s){return C.skewOfOuter(this,t,i,s),this}skewOfInner(t,i,s){return C.skewOfInner(this,t,i,s),this}multiply(t){return C.multiply(this,t),this}multiplyParent(t){return C.multiplyParent(this,t),this}divide(t){return C.divide(this,t),this}divideParent(t){return C.divideParent(this,t),this}invert(){return C.invert(this),this}invertWith(){return C.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,i,s){C.toOuterPoint(this,t,i,s)}toInnerPoint(t,i,s){C.toInnerPoint(this,t,i,s)}setLayout(t,i,s){return C.setLayout(this,t,i,s),this}getLayout(t,i,s){return C.getLayout(this,t,i,s)}withScale(t,i){return C.withScale(this,t,i)}reset(){C.reset(this)}};new li;const zr={tempPointBounds:{},setPoint(e,t,i){e.minX=e.maxX=t,e.minY=e.maxY=i},addPoint(e,t,i){e.minX=t<e.minX?t:e.minX,e.minY=i<e.minY?i:e.minY,e.maxX=t>e.maxX?t:e.maxX,e.maxY=i>e.maxY?i:e.maxY},addBounds(e,t,i,s,r){oa(e,t,i),oa(e,t+s,i+r)},copy(e,t){e.minX=t.minX,e.minY=t.minY,e.maxX=t.maxX,e.maxY=t.maxY},addPointBounds(e,t){e.minX=t.minX<e.minX?t.minX:e.minX,e.minY=t.minY<e.minY?t.minY:e.minY,e.maxX=t.maxX>e.maxX?t.maxX:e.maxX,e.maxY=t.maxY>e.maxY?t.maxY:e.maxY},toBounds(e,t){t.x=e.minX,t.y=e.minY,t.width=e.maxX-e.minX,t.height=e.maxY-e.minY}},{addPoint:oa}=zr;var _o,po;(function(e){e[e.top=0]="top",e[e.right=1]="right",e[e.bottom=2]="bottom",e[e.left=3]="left"})(_o||(_o={})),(function(e){e[e.topLeft=0]="topLeft",e[e.top=1]="top",e[e.topRight=2]="topRight",e[e.right=3]="right",e[e.bottomRight=4]="bottomRight",e[e.bottom=5]="bottom",e[e.bottomLeft=6]="bottomLeft",e[e.left=7]="left",e[e.center=8]="center",e[e["top-left"]=0]="top-left",e[e["top-right"]=2]="top-right",e[e["bottom-right"]=4]="bottom-right",e[e["bottom-left"]=6]="bottom-left"})(po||(po={}));const Io=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];Io.forEach(e=>e.type="percent");const ci={directionData:Io,tempPoint:{},get:aa,toPoint(e,t,i,s,r,n){const o=aa(e);i.x=o.x,i.y=o.y,o.type==="percent"&&(i.x*=t.width,i.y*=t.height,r&&(n||(i.x-=r.x,i.y-=r.y),o.x&&(i.x-=o.x===1?r.width:o.x===.5?o.x*r.width:0),o.y&&(i.y-=o.y===1?r.height:o.y===.5?o.y*r.height:0))),s||(i.x+=t.x,i.y+=t.y)},getPoint:(e,t,i)=>(i||(i={}),ci.toPoint(e,t,i,!0),i)};function aa(e){return J(e)?Io[po[e]]:e}const{toPoint:Ud}=ci,Jl={toPoint(e,t,i,s,r,n){Ud(e,i,s,r,t,n)}},{tempPointBounds:Ae,setPoint:ha,addPoint:Is,toBounds:la}=zr,{toOuterPoint:Ws}=C,{float:Ns,fourNumber:Hd}=wt,{floor:da,ceil:zs}=Math;let he,le,He,Ve;const ge={},Ht={},qe={},B={tempBounds:qe,set(e,t=0,i=0,s=0,r=0){e.x=t,e.y=i,e.width=s,e.height=r},copy(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},copyAndSpread(e,t,i,s,r){const{x:n,y:o,width:a,height:h}=t;if(Q(i)){const d=Hd(i);s?V.set(e,n+d[3],o+d[0],a-d[1]-d[3],h-d[2]-d[0]):V.set(e,n-d[3],o-d[0],a+d[1]+d[3],h+d[2]+d[0])}else s&&(i=-i),V.set(e,n-i,o-i,a+2*i,h+2*i);r&&(r==="width"?(e.y=o,e.height=h):(e.x=n,e.width=a))},minX:e=>e.width>0?e.x:e.x+e.width,minY:e=>e.height>0?e.y:e.y+e.height,maxX:e=>e.width>0?e.x+e.width:e.x,maxY:e=>e.height>0?e.y+e.height:e.y,move(e,t,i){e.x+=t,e.y+=i},scroll(e,t){e.x+=t.scrollX,e.y+=t.scrollY},getByMove:(e,t,i)=>(e=Object.assign({},e),V.move(e,t,i),e),toOffsetOutBounds(e,t,i){t?ca(t,e):t=e,i||(i=e),t.offsetX=V.maxX(i),t.offsetY=V.maxY(i),V.move(t,-t.offsetX,-t.offsetY)},scale(e,t,i=t,s){s||L.scale(e,t,i),e.width*=t,e.height*=i},scaleOf(e,t,i,s=i){L.scaleOf(e,t,i,s),e.width*=i,e.height*=s},tempToOuterOf:(e,t)=>(V.copy(qe,e),V.toOuterOf(qe,t),qe),getOuterOf:(e,t)=>(e=Object.assign({},e),V.toOuterOf(e,t),e),toOuterOf(e,t,i){if(i||(i=e),t.b===0&&t.c===0){const{a:s,d:r,e:n,f:o}=t;s>0?(i.width=e.width*s,i.x=n+e.x*s):(i.width=e.width*-s,i.x=n+e.x*s-i.width),r>0?(i.height=e.height*r,i.y=o+e.y*r):(i.height=e.height*-r,i.y=o+e.y*r-i.height)}else ge.x=e.x,ge.y=e.y,Ws(t,ge,Ht),ha(Ae,Ht.x,Ht.y),ge.x=e.x+e.width,Ws(t,ge,Ht),Is(Ae,Ht.x,Ht.y),ge.y=e.y+e.height,Ws(t,ge,Ht),Is(Ae,Ht.x,Ht.y),ge.x=e.x,Ws(t,ge,Ht),Is(Ae,Ht.x,Ht.y),la(Ae,i)},toInnerOf(e,t,i){i||(i=e),V.move(i,-t.e,-t.f),V.scale(i,1/t.a,1/t.d)},getFitMatrix(e,t,i=1){const s=Math.min(i,V.getFitScale(e,t));return new li(s,0,0,s,-t.x*s,-t.y*s)},getFitScale(e,t,i){const s=e.width/t.width,r=e.height/t.height;return i?Math.max(s,r):Math.min(s,r)},put(e,t,i="center",s=1,r=!0,n){n||(n=t),J(s)&&(s=V.getFitScale(e,t,s==="cover")),qe.width=r?t.width*=s:t.width*s,qe.height=r?t.height*=s:t.height*s,Jl.toPoint(i,qe,e,n,!0,!0)},getSpread(e,t,i){const s={};return V.copyAndSpread(s,e,t,!1,i),s},spread(e,t,i){V.copyAndSpread(e,e,t,!1,i)},shrink(e,t,i){V.copyAndSpread(e,e,t,!0,i)},ceil(e){const{x:t,y:i}=e;e.x=da(e.x),e.y=da(e.y),e.width=t>e.x?zs(e.width+t-e.x):zs(e.width),e.height=i>e.y?zs(e.height+i-e.y):zs(e.height)},unsign(e){e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height)},float(e,t){e.x=Ns(e.x,t),e.y=Ns(e.y,t),e.width=Ns(e.width,t),e.height=Ns(e.height,t)},add(e,t,i){he=e.x+e.width,le=e.y+e.height,He=t.x,Ve=t.y,i||(He+=t.width,Ve+=t.height),he=he>He?he:He,le=le>Ve?le:Ve,e.x=e.x<t.x?e.x:t.x,e.y=e.y<t.y?e.y:t.y,e.width=he-e.x,e.height=le-e.y},addList(e,t){V.setListWithFn(e,t,void 0,!0)},setList(e,t,i=!1){V.setListWithFn(e,t,void 0,i)},addListWithFn(e,t,i){V.setListWithFn(e,t,i,!0)},setListWithFn(e,t,i,s=!1){let r,n=!0;for(let o=0,a=t.length;o<a;o++)r=i?i(t[o],o):t[o],r&&(r.width||r.height)&&(n?(n=!1,s||ca(e,r)):ua(e,r));n&&V.reset(e)},setPoints(e,t){t.forEach((i,s)=>s===0?ha(Ae,i.x,i.y):Is(Ae,i.x,i.y)),la(Ae,e)},setPoint(e,t){V.set(e,t.x,t.y)},addPoint(e,t){ua(e,t,!0)},getPoints(e){const{x:t,y:i,width:s,height:r}=e;return[{x:t,y:i},{x:t+s,y:i},{x:t+s,y:i+r},{x:t,y:i+r}]},hitRadiusPoint:(e,t,i)=>(i&&(t=L.tempToInnerRadiusPointOf(t,i)),t.x>=e.x-t.radiusX&&t.x<=e.x+e.width+t.radiusX&&t.y>=e.y-t.radiusY&&t.y<=e.y+e.height+t.radiusY),hitPoint:(e,t,i)=>(i&&(t=L.tempToInnerOf(t,i)),t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height),hit:(e,t,i)=>(i&&(t=V.tempToOuterOf(t,i)),!(e.y+e.height<t.y||t.y+t.height<e.y||e.x+e.width<t.x||t.x+t.width<e.x)),includes:(e,t,i)=>(i&&(t=V.tempToOuterOf(t,i)),e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height),getIntersectData(e,t,i){if(i&&(t=V.tempToOuterOf(t,i)),!V.hit(e,t))return{x:0,y:0,width:0,height:0};let{x:s,y:r,width:n,height:o}=t;return he=s+n,le=r+o,He=e.x+e.width,Ve=e.y+e.height,s=s>e.x?s:e.x,r=r>e.y?r:e.y,he=he<He?he:He,le=le<Ve?le:Ve,n=he-s,o=le-r,{x:s,y:r,width:n,height:o}},intersect(e,t,i){V.copy(e,V.getIntersectData(e,t,i))},isSame:(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,isEmpty:e=>e.x===0&&e.y===0&&e.width===0&&e.height===0,reset(e){V.set(e)}},V=B,{add:ua,copy:ca}=V;let ft=class go{get minX(){return B.minX(this)}get minY(){return B.minY(this)}get maxX(){return B.maxX(this)}get maxY(){return B.maxY(this)}constructor(t,i,s,r){this.set(t,i,s,r)}set(t,i,s,r){return W(t)?B.copy(this,t):B.set(this,t,i,s,r),this}get(){const{x:t,y:i,width:s,height:r}=this;return{x:t,y:i,width:s,height:r}}clone(){return new go(this)}move(t,i){return B.move(this,t,i),this}scale(t,i,s){return B.scale(this,t,i,s),this}scaleOf(t,i,s){return B.scaleOf(this,t,i,s),this}toOuterOf(t,i){return B.toOuterOf(this,t,i),this}toInnerOf(t,i){return B.toInnerOf(this,t,i),this}getFitMatrix(t,i){return B.getFitMatrix(this,t,i)}put(t,i,s){B.put(this,t,i,s)}spread(t,i){return B.spread(this,t,i),this}shrink(t,i){return B.shrink(this,t,i),this}ceil(){return B.ceil(this),this}unsign(){return B.unsign(this),this}float(t){return B.float(this,t),this}add(t){return B.add(this,t),this}addList(t){return B.setList(this,t,!0),this}setList(t){return B.setList(this,t),this}addListWithFn(t,i){return B.setListWithFn(this,t,i,!0),this}setListWithFn(t,i){return B.setListWithFn(this,t,i),this}setPoint(t){return B.setPoint(this,t),this}setPoints(t){return B.setPoints(this,t),this}addPoint(t){return B.addPoint(this,t),this}getPoints(){return B.getPoints(this)}hitPoint(t,i){return B.hitPoint(this,t,i)}hitRadiusPoint(t,i){return B.hitRadiusPoint(this,t,i)}hit(t,i){return B.hit(this,t,i)}includes(t,i){return B.includes(this,t,i)}intersect(t,i){return B.intersect(this,t,i),this}getIntersect(t,i){return new go(B.getIntersectData(this,t,i))}isSame(t){return B.isSame(this,t)}isEmpty(){return B.isEmpty(this)}reset(){B.reset(this)}};const oi=new ft;let Vd=class{constructor(t,i,s,r,n,o){W(t)?this.copy(t):this.set(t,i,s,r,n,o)}set(t=0,i=0,s=0,r=0,n=0,o=0){this.top=t,this.right=i,this.bottom=s,this.left=r,this.width=n,this.height=o}copy(t){const{top:i,right:s,bottom:r,left:n,width:o,height:a}=t;this.set(i,s,r,n,o,a)}getBoundsFrom(t){const{top:i,right:s,bottom:r,left:n,width:o,height:a}=this;return new ft(n,i,o||t.width-n-s,a||t.height-i-r)}};const qd={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1},{randColor:_a}=wt;let et=class fo{constructor(t){this.repeatMap={},this.name=t}static get(t){return new fo(t)}static set filter(t){this.filterList=pa(t)}static set exclude(t){this.excludeList=pa(t)}static drawRepaint(t,i){const s=_a();t.fillWorld(i,s.replace("1)",".1)")),t.strokeWorld(i,s)}static drawBounds(t,i,s){const r=fo.showBounds==="hit",n=t.__nowWorld,o=_a();r&&(i.setWorld(n),t.__drawHitPath(i),i.fillStyle=o.replace("1)",".2)"),i.fill()),i.resetTransform(),i.setStroke(o,2),r?i.stroke():i.strokeWorld(n,o)}log(...t){if(Ge.enable){if(Ge.filterList.length&&Ge.filterList.every(i=>i!==this.name)||Ge.excludeList.length&&Ge.excludeList.some(i=>i===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){Ge.enable&&this.warn(...t)}warn(...t){Ge.showWarn&&console.warn(this.name,...t)}repeat(t,...i){this.repeatMap[t]||(this.warn("repeat:"+t,...i),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(i){console.error(this.name,...t,i)}}};function pa(e){return e?J(e)&&(e=[e]):e=[],e}et.filterList=[],et.excludeList=[],et.showWarn=!0;const Ge=et,Gd=et.get("RunTime"),re={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(e,t){const i=Re.create(Re.RUNTIME);return Vt.currentId=Vt.idMap[i]=t?performance.now():Date.now(),Vt.currentName=Vt.nameMap[i]=e,Vt.nameToIdMap[e]=i,i},end(e,t){const i=Vt.idMap[e],s=Vt.nameMap[e],r=t?(performance.now()-i)/1e3:Date.now()-i;Vt.idMap[e]=Vt.nameMap[e]=Vt.nameToIdMap[s]=void 0,Gd.log(s,r,"ms")},endOfName(e,t){const i=Vt.nameToIdMap[e];P(i)||Vt.end(i,t)}},Vt=re,td=[],vt={list:{},add(e,...t){this.list[e]=!0,td.push(...t)},has(e,t){const i=this.list[e];return!i&&t&&this.need(e),i},need(e){console.error("please install and import plugin: "+(e.includes("-x")?"":"@leafer-in/")+e)}};setTimeout(()=>td.forEach(e=>vt.has(e,!0)));const at={editor:e=>vt.need("editor")},ga=et.get("UICreator"),Rs={list:{},register(e){const{__tag:t}=e.prototype;Ys[t]&&ga.repeat(t),Ys[t]=e},get(e,t,i,s,r,n){Ys[e]||ga.error("not register "+e);const o=new Ys[e](t);return P(i)||(o.x=i,s&&(o.y=s),r&&(o.width=r),n&&(o.height=n)),o}},{list:Ys}=Rs,Kd=et.get("EventCreator"),zi={nameList:{},register(e){let t;Object.keys(e).forEach(i=>{t=e[i],J(t)&&(Hi[t]&&Kd.repeat(t),Hi[t]=e)})},changeName(e,t){const i=Hi[e];if(i){const s=Object.keys(i).find(r=>i[r]===e);s&&(i[s]=t,Hi[t]=i)}},has(e){return!!this.nameList[e]},get:(e,...t)=>new Hi[e](...t)},{nameList:Hi}=zi;let ed=class{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let i;const{list:s}=this;for(let n=0,o=s.length;n<o;n++)if(i=s[n],i.recycled&&i.isSameSize(t))return i.recycled=!1,i.manager||(i.manager=this),i;const r=at.canvas(t);return this.add(r),r}recycle(t){t.recycled=!0}clearRecycled(){let t;const i=[];for(let s=0,r=this.list.length;s<r;s++)t=this.list[s],t.recycled?t.destroy():i.push(t);this.list=i}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}};function E(e,t,i,s){var r,n=arguments.length,o=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}function id(e,t,i,s){return new(i||(i=Promise))(function(r,n){function o(d){try{h(s.next(d))}catch(u){n(u)}}function a(d){try{h(s.throw(d))}catch(u){n(u)}}function h(d){var u;d.done?r(d.value):(u=d.value,u instanceof i?u:new i(function(l){l(u)})).then(o,a)}h((s=s.apply(e,[])).next())})}function st(e){return(t,i)=>{e||(e=i);const s={get(){return this.context[e]},set(r){this.context[e]=r}};i==="strokeCap"&&(s.set=function(r){this.context[e]=r==="none"?"butt":r}),Object.defineProperty(t,i,s)}}const sd=[];function Y(){return(e,t)=>{sd.push(t)}}const Qd=[];let T=class{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||Qd)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;sd.forEach(i=>{t=this.context[i],t&&(this[i]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,i,s,r,n,o){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,i,s,r,n,o){W(t)?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,i,s,r,n,o)}translate(t,i){}scale(t,i){}rotate(t){}fill(t,i){}stroke(t){}clip(t,i){}fillRect(t,i,s,r){}strokeRect(t,i,s,r){}clearRect(t,i,s,r){}drawImage(t,i,s,r,n,o,a,h,d){switch(arguments.length){case 9:if(i<0){const u=-i/r*h;r+=i,i=0,o+=u,h-=u}if(s<0){const u=-s/n*d;n+=s,s=0,a+=u,d-=u}this.context.drawImage(t,i,s,r,n,o,a,h,d);break;case 5:this.context.drawImage(t,i,s,r,n);break;case 3:this.context.drawImage(t,i,s)}}beginPath(){}moveTo(t,i){}lineTo(t,i){}bezierCurveTo(t,i,s,r,n,o){}quadraticCurveTo(t,i,s,r){}closePath(){}arc(t,i,s,r,n,o){}arcTo(t,i,s,r,n){}ellipse(t,i,s,r,n,o,a,h){}rect(t,i,s,r){}roundRect(t,i,s,r,n){}createConicGradient(t,i,s){}createLinearGradient(t,i,s,r){}createPattern(t,i){}createRadialGradient(t,i,s,r,n,o){}fillText(t,i,s,r){}measureText(t){}strokeText(t,i,s,r){}destroy(){this.context=null}};E([st("imageSmoothingEnabled")],T.prototype,"smooth",void 0),E([st("imageSmoothingQuality")],T.prototype,"smoothLevel",void 0),E([st("globalAlpha")],T.prototype,"opacity",void 0),E([st()],T.prototype,"fillStyle",void 0),E([st()],T.prototype,"strokeStyle",void 0),E([st("lineWidth")],T.prototype,"strokeWidth",void 0),E([st("lineCap")],T.prototype,"strokeCap",void 0),E([st("lineJoin")],T.prototype,"strokeJoin",void 0),E([st("lineDashOffset")],T.prototype,"dashOffset",void 0),E([st()],T.prototype,"miterLimit",void 0),E([st()],T.prototype,"shadowBlur",void 0),E([st()],T.prototype,"shadowColor",void 0),E([st()],T.prototype,"shadowOffsetX",void 0),E([st()],T.prototype,"shadowOffsetY",void 0),E([st()],T.prototype,"filter",void 0),E([st()],T.prototype,"font",void 0),E([st()],T.prototype,"fontKerning",void 0),E([st()],T.prototype,"fontStretch",void 0),E([st()],T.prototype,"fontVariantCaps",void 0),E([st()],T.prototype,"textAlign",void 0),E([st()],T.prototype,"textBaseline",void 0),E([st()],T.prototype,"textRendering",void 0),E([st()],T.prototype,"wordSpacing",void 0),E([st()],T.prototype,"letterSpacing",void 0),E([st()],T.prototype,"direction",void 0),E([Y()],T.prototype,"setTransform",null),E([Y()],T.prototype,"resetTransform",null),E([Y()],T.prototype,"getTransform",null),E([Y()],T.prototype,"save",null),E([Y()],T.prototype,"restore",null),E([Y()],T.prototype,"translate",null),E([Y()],T.prototype,"scale",null),E([Y()],T.prototype,"rotate",null),E([Y()],T.prototype,"fill",null),E([Y()],T.prototype,"stroke",null),E([Y()],T.prototype,"clip",null),E([Y()],T.prototype,"fillRect",null),E([Y()],T.prototype,"strokeRect",null),E([Y()],T.prototype,"clearRect",null),E([Y()],T.prototype,"beginPath",null),E([Y()],T.prototype,"moveTo",null),E([Y()],T.prototype,"lineTo",null),E([Y()],T.prototype,"bezierCurveTo",null),E([Y()],T.prototype,"quadraticCurveTo",null),E([Y()],T.prototype,"closePath",null),E([Y()],T.prototype,"arc",null),E([Y()],T.prototype,"arcTo",null),E([Y()],T.prototype,"ellipse",null),E([Y()],T.prototype,"rect",null),E([Y()],T.prototype,"roundRect",null),E([Y()],T.prototype,"createConicGradient",null),E([Y()],T.prototype,"createLinearGradient",null),E([Y()],T.prototype,"createPattern",null),E([Y()],T.prototype,"createRadialGradient",null),E([Y()],T.prototype,"fillText",null),E([Y()],T.prototype,"measureText",null),E([Y()],T.prototype,"strokeText",null);const{copy:Zd,multiplyParent:Jd,pixelScale:tu}=C,{round:Xs}=Math,X=new ft,fa=new ft,eu={width:1,height:1,pixelRatio:1},ie=["width","height","pixelRatio"];let rd=class extends T{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio||0}get pixelHeight(){return this.height*this.pixelRatio||0}get pixelSnap(){return this.config.pixelSnap}set pixelSnap(t){this.config.pixelSnap=t}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,i){super(),this.size={},this.worldTransform={},t||(t=eu),this.manager=i,this.innerId=Re.create(Re.CNAVAS);const{width:s,height:r,pixelRatio:n}=t;this.autoLayout=!s||!r,this.size.pixelRatio=n||S.devicePixelRatio,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:i}=this.config;this.context=i?t.getContext("2d",i):t.getContext("2d"),this.__bindContext()}export(t,i){}toBlob(t,i){}toDataURL(t,i){}saveAs(t,i){}resize(t,i=!0){if(this.isSameSize(t))return;let s;this.context&&!this.unreal&&i&&this.width&&(s=this.getSameCanvas(),s.copyWorld(this));const r=this.size;Z.copyAttrs(r,t,ie),ie.forEach(n=>r[n]||(r[n]=1)),this.bounds=new ft(0,0,this.width,this.height),this.updateViewSize(),this.updateClientBounds(),this.context&&(this.smooth=this.config.smooth,!this.unreal&&s&&(this.clearWorld(s.bounds),this.copyWorld(s),s.recycle()))}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,i){}stopAutoLayout(){}setCursor(t){}setWorld(t,i){const{pixelRatio:s,pixelSnap:r}=this,n=this.worldTransform;i&&Jd(t,i,n),tu(t,s,n),r&&!t.ignorePixelSnap&&(t.half&&t.half*s%2?(n.e=Xs(n.e-.5)+.5,n.f=Xs(n.f-.5)+.5):(n.e=Xs(n.e),n.f=Xs(n.f))),this.setTransform(n.a,n.b,n.c,n.d,n.e,n.f)}useWorldTransform(t){t&&(this.worldTransform=t);const i=this.worldTransform;i&&this.setTransform(i.a,i.b,i.c,i.d,i.e,i.f)}setStroke(t,i,s,r){i&&(this.strokeWidth=i),t&&(this.strokeStyle=t),s&&this.setStrokeOptions(s,r)}setStrokeOptions(t,i){let{strokeCap:s,strokeJoin:r,dashPattern:n,dashOffset:o,miterLimit:a}=t;i&&(i.strokeCap&&(s=i.strokeCap),i.strokeJoin&&(r=i.strokeJoin),P(i.dashPattern)||(n=i.dashPattern),P(i.dashOffset)||(o=i.dashOffset),i.miterLimit&&(a=i.miterLimit)),this.strokeCap=s,this.strokeJoin=r,this.dashPattern=n,this.dashOffset=o,this.miterLimit=a}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,i){return!0}hitStroke(t,i){return!0}hitPixel(t,i,s=1){return!0}setWorldShadow(t,i,s,r){const{pixelRatio:n}=this;this.shadowOffsetX=t*n,this.shadowOffsetY=i*n,this.shadowBlur=s*n,this.shadowColor=r||"black"}setWorldBlur(t){const{pixelRatio:i}=this;this.filter=`blur(${t*i}px)`}copyWorld(t,i,s,r,n){r&&(this.blendMode=r),i?(this.setTempPixelBounds(i,n),s?(this.setTempPixelBounds2(s,n),s=fa):s=X,this.drawImage(t.view,X.x,X.y,X.width,X.height,s.x,s.y,s.width,s.height)):this.drawImage(t.view,0,0),r&&(this.blendMode="source-over")}copyWorldToInner(t,i,s,r,n){i.b||i.c?(this.save(),this.resetTransform(),this.copyWorld(t,i,B.tempToOuterOf(s,i),r,n),this.restore()):(r&&(this.blendMode=r),this.setTempPixelBounds(i,n),this.drawImage(t.view,X.x,X.y,X.width,X.height,s.x,s.y,s.width,s.height),r&&(this.blendMode="source-over"))}copyWorldByReset(t,i,s,r,n,o){this.resetTransform(),this.copyWorld(t,i,s,r,o),n||this.useWorldTransform()}useGrayscaleAlpha(t){let i,s;this.setTempPixelBounds(t,!0,!0);const{context:r}=this,n=r.getImageData(X.x,X.y,X.width,X.height),{data:o}=n;for(let a=0,h=o.length;a<h;a+=4)s=.299*o[a]+.587*o[a+1]+.114*o[a+2],(i=o[a+3])&&(o[a+3]=i===255?s:i*(s/255));r.putImageData(n,X.x,X.y)}useMask(t,i,s){this.copyWorld(t,i,s,"destination-in")}useEraser(t,i,s){this.copyWorld(t,i,s,"destination-out")}fillWorld(t,i,s,r){s&&(this.blendMode=s),this.fillStyle=i,this.setTempPixelBounds(t,r),this.fillRect(X.x,X.y,X.width,X.height),s&&(this.blendMode="source-over")}strokeWorld(t,i,s,r){s&&(this.blendMode=s),this.strokeStyle=i,this.setTempPixelBounds(t,r),this.strokeRect(X.x,X.y,X.width,X.height),s&&(this.blendMode="source-over")}clipWorld(t,i=!0){this.beginPath(),this.setTempPixelBounds(t,i),this.rect(X.x,X.y,X.width,X.height),this.clip()}clipUI(t){t.windingRule?this.clip(t.windingRule):this.clip()}clearWorld(t,i=!0){this.setTempPixelBounds(t,i),this.clearRect(X.x,X.y,X.width,X.height)}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempPixelBounds(t,i,s){this.copyToPixelBounds(X,t,i,s)}setTempPixelBounds2(t,i,s){this.copyToPixelBounds(fa,t,i,s)}copyToPixelBounds(t,i,s,r){t.set(i),r&&t.intersect(this.bounds),t.scale(this.pixelRatio),s&&t.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&(!t.pixelRatio||this.pixelRatio===t.pixelRatio)}getSameCanvas(t,i){const{size:s,pixelSnap:r}=this,n=this.manager?this.manager.get(s):at.canvas(Object.assign({},s));return n.save(),t&&(Zd(n.worldTransform,this.worldTransform),n.useWorldTransform()),i&&(n.smooth=this.smooth),n.pixelSnap!==r&&(n.pixelSnap=r),n}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}};const ce={creator:{},parse(e,t){},convertToCanvasData(e,t){}},nd={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},Ut=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},nd),od={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},ad={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},iu=Object.assign(Object.assign({},ad),nd),Dr=Ut,hd={};for(let e in Dr)hd[Dr[e]]=e;const Wo={};for(let e in Dr)Wo[Dr[e]]=od[e];const ld={drawRoundRect(e,t,i,s,r,n){const o=wt.fourNumber(n,Math.min(s/2,r/2)),a=t+s,h=i+r;o[0]?e.moveTo(t+o[0],i):e.moveTo(t,i),o[1]?e.arcTo(a,i,a,h,o[1]):e.lineTo(a,i),o[2]?e.arcTo(a,h,t,h,o[2]):e.lineTo(a,h),o[3]?e.arcTo(t,h,t,i,o[3]):e.lineTo(t,h),o[0]?e.arcTo(t,i,a,i,o[0]):e.lineTo(t,i)}},{sin:vi,cos:Vi,hypot:ya,atan2:ma,ceil:su,abs:va,PI:wa,sqrt:xa,pow:js}=Math,{setPoint:rn,addPoint:Us}=zr,{set:Hs,toNumberPoints:ru}=L,{M:ba,L:nn,C:on,Q:Sa,Z:nu}=Ut,an={},Te={points(e,t,i,s){let r=ru(t);if(e.push(ba,r[0],r[1]),i&&r.length>5){let n,o,a,h,d,u,l,c,_,g,y,f,w,v,x,b=r.length;const k=i===!0?.5:i;s&&(r=[r[b-2],r[b-1],...r,r[0],r[1],r[2],r[3]],b=r.length);for(let O=2;O<b-2;O+=2)n=r[O-2],o=r[O-1],a=r[O],h=r[O+1],d=r[O+2],u=r[O+3],y=a-n,f=h-o,w=xa(js(y,2)+js(f,2)),v=xa(js(d-a,2)+js(u-h,2)),(w||v)&&(x=w+v,w=k*w/x,v=k*v/x,d-=n,u-=o,l=a-w*d,c=h-w*u,O===2?s||e.push(Sa,l,c,a,h):(y||f)&&e.push(on,_,g,l,c,a,h),_=a+v*d,g=h+v*u);s||e.push(Sa,_,g,r[b-2],r[b-1])}else for(let n=2,o=r.length;n<o;n+=2)e.push(nn,r[n],r[n+1]);s&&e.push(nu)},rect(e,t,i,s,r){ce.creator.path=e,ce.creator.moveTo(t,i).lineTo(t+s,i).lineTo(t+s,i+r).lineTo(t,i+r).lineTo(t,i)},roundRect(e,t,i,s,r,n){ce.creator.path=[],ld.drawRoundRect(ce.creator,t,i,s,r,n),e.push(...ce.convertToCanvasData(ce.creator.path,!0))},arcTo(e,t,i,s,r,n,o,a,h,d,u){const l=s-t,c=r-i,_=n-s,g=o-r;let y=ma(c,l),f=ma(g,_);const w=ya(l,c),v=ya(_,g);let x=f-y;if(x<0&&(x+=Jt),w<1e-12||v<1e-12||x<1e-12||va(x-wa)<1e-12)return e&&e.push(nn,s,r),h&&(rn(h,t,i),Us(h,s,r)),u&&Hs(u,t,i),void(d&&Hs(d,s,r));const b=l*g-_*c<0,k=b?-1:1,O=a/Vi(x/2),A=s+O*Vi(y+x/2+Mi*k),M=r+O*vi(y+x/2+Mi*k);return y-=Mi*k,f-=Mi*k,Pa(e,A,M,a,a,0,y/G,f/G,b,h,d,u)},arc:(e,t,i,s,r,n,o,a,h,d)=>Pa(e,t,i,s,s,0,r,n,o,a,h,d),ellipse(e,t,i,s,r,n,o,a,h,d,u,l){const c=n*G,_=vi(c),g=Vi(c);let y=o*G,f=a*G;y>wa&&(y-=Jt),f<0&&(f+=Jt);let w=f-y;w<0?w+=Jt:w>Jt&&(w-=Jt),h&&(w-=Jt);const v=su(va(w/Mi)),x=w/v,b=vi(x/4),k=8/3*b*b/vi(x/2);f=y+x;let O,A,M,tt,mt,z,D,H,bt=Vi(y),ut=vi(y),Ct=M=g*s*bt-_*r*ut,je=tt=_*s*bt+g*r*ut,Oe=t+M,fi=i+tt;e&&e.push(e.length?nn:ba,Oe,fi),d&&rn(d,Oe,fi),l&&Hs(l,Oe,fi);for(let Ue=0;Ue<v;Ue++)O=Vi(f),A=vi(f),M=g*s*O-_*r*A,tt=_*s*O+g*r*A,mt=t+Ct-k*(g*s*ut+_*r*bt),z=i+je-k*(_*s*ut-g*r*bt),D=t+M+k*(g*s*A+_*r*O),H=i+tt+k*(_*s*A-g*r*O),e&&e.push(on,mt,z,D,H,t+M,i+tt),d&&Ba(t+Ct,i+je,mt,z,D,H,t+M,i+tt,d,!0),Ct=M,je=tt,bt=O,ut=A,y=f,f+=x;u&&Hs(u,t+M,i+tt)},quadraticCurveTo(e,t,i,s,r,n,o){e.push(on,(t+2*s)/3,(i+2*r)/3,(n+2*s)/3,(o+2*r)/3,n,o)},toTwoPointBoundsByQuadraticCurve(e,t,i,s,r,n,o,a){Ba(e,t,(e+2*i)/3,(t+2*s)/3,(r+2*i)/3,(n+2*s)/3,r,n,o,a)},toTwoPointBounds(e,t,i,s,r,n,o,a,h,d){const u=[];let l,c,_,g,y,f,w,v,x=e,b=i,k=r,O=o;for(let A=0;A<2;++A)if(A==1&&(x=t,b=s,k=n,O=a),l=-3*x+9*b-9*k+3*O,c=6*x-12*b+6*k,_=3*b-3*x,Math.abs(l)<1e-12){if(Math.abs(c)<1e-12)continue;g=-_/c,0<g&&g<1&&u.push(g)}else w=c*c-4*_*l,v=Math.sqrt(w),w<0||(y=(-c+v)/(2*l),0<y&&y<1&&u.push(y),f=(-c-v)/(2*l),0<f&&f<1&&u.push(f));d?Us(h,e,t):rn(h,e,t),Us(h,o,a);for(let A=0,M=u.length;A<M;A++)ka(u[A],e,t,i,s,r,n,o,a,an),Us(h,an.x,an.y)},getPointAndSet(e,t,i,s,r,n,o,a,h,d){const u=1-e,l=u*u*u,c=3*u*u*e,_=3*u*e*e,g=e*e*e;d.x=l*t+c*s+_*n+g*a,d.y=l*i+c*r+_*o+g*h},getPoint(e,t,i,s,r,n,o,a,h){const d={};return ka(e,t,i,s,r,n,o,a,h,d),d},getDerivative(e,t,i,s,r){const n=1-e;return 3*n*n*(i-t)+6*n*e*(s-i)+3*e*e*(r-s)}},{getPointAndSet:ka,toTwoPointBounds:Ba,ellipse:Pa}=Te,{sin:ou,cos:au,sqrt:Ea,atan2:Ta}=Math,{ellipse:hu}=Te,lu={ellipticalArc(e,t,i,s,r,n,o,a,h,d,u){const l=(h-t)/2,c=(d-i)/2,_=n*G,g=ou(_),y=au(_),f=-y*l-g*c,w=-y*c+g*l,v=s*s,x=r*r,b=w*w,k=f*f,O=v*x-v*b-x*k;let A=0;if(O<0){const Ct=Ea(1-O/(v*x));s*=Ct,r*=Ct}else A=(o===a?-1:1)*Ea(O/(v*b+x*k));const M=A*s*w/r,tt=-A*r*f/s,mt=Ta((w-tt)/r,(f-M)/s),z=Ta((-w-tt)/r,(-f-M)/s);let D=z-mt;a===0&&D>0?D-=Jt:a===1&&D<0&&(D+=Jt);const H=t+l+y*M-g*tt,bt=i+c+g*M+y*tt,ut=D<0?1:0;u||S.ellipseToCurve?hu(e,H,bt,s,r,n,mt/G,z/G,ut):s!==r||n?e.push(Ut.G,H,bt,s,r,n,mt/G,z/G,ut):e.push(Ut.O,H,bt,s,mt/G,z/G,ut)}},du={toCommand:e=>[],toNode:e=>[]},{M:hn,m:uu,L:qi,l:cu,H:_u,h:pu,V:gu,v:fu,C:wi,c:yu,S:ln,s:mu,Q:xi,q:vu,T:dn,t:wu,A:xu,a:bu,Z:un,z:Su,N:ku,D:Bu,X:Pu,G:Eu,F:Tu,O:Ru,P:Cu,U:Lu}=Ut,{rect:Ou,roundRect:Ra,arcTo:Au,arc:Ca,ellipse:La,quadraticCurveTo:Oa}=Te,{ellipticalArc:Du}=lu,Mu=et.get("PathConvert"),fe={},di={current:{dot:0},stringify(e,t){let i,s,r,n=0,o=e.length,a="";for(;n<o;){s=e[n],i=Wo[s],a+=s===r?" ":hd[s];for(let h=1;h<i;h++)a+=wt.float(e[n+h],t),h===i-1||(a+=" ");r=s,n+=i}return a},parse(e,t){let i,s,r,n="";const o=[],a=t?iu:ad;for(let h=0,d=e.length;h<d;h++)s=e[h],qd[s]?(s==="."&&(qt.dot&&(Ke(o,n),n=""),qt.dot++),n==="0"&&s!=="."&&(Ke(o,n),n=""),n+=s):Ut[s]?(n&&(Ke(o,n),n=""),qt.name=Ut[s],qt.length=od[s],qt.index=0,Ke(o,qt.name),!i&&a[s]&&(i=!0)):s==="-"||s==="+"?r==="e"||r==="E"?n+=s:(n&&Ke(o,n),n=s):n&&(Ke(o,n),n=""),r=s;return n&&Ke(o,n),i?di.toCanvasData(o,t):o},toCanvasData(e,t){let i,s,r,n,o,a=0,h=0,d=0,u=0,l=0,c=e.length;const _=[];for(;l<c;){switch(r=e[l],r){case uu:e[l+1]+=a,e[l+2]+=h;case hn:a=e[l+1],h=e[l+2],_.push(hn,a,h),l+=3;break;case pu:e[l+1]+=a;case _u:a=e[l+1],_.push(qi,a,h),l+=2;break;case fu:e[l+1]+=h;case gu:h=e[l+1],_.push(qi,a,h),l+=2;break;case cu:e[l+1]+=a,e[l+2]+=h;case qi:a=e[l+1],h=e[l+2],_.push(qi,a,h),l+=3;break;case mu:e[l+1]+=a,e[l+2]+=h,e[l+3]+=a,e[l+4]+=h,r=ln;case ln:o=n===wi||n===ln,d=o?2*a-i:e[l+1],u=o?2*h-s:e[l+2],i=e[l+1],s=e[l+2],a=e[l+3],h=e[l+4],_.push(wi,d,u,i,s,a,h),l+=5;break;case yu:e[l+1]+=a,e[l+2]+=h,e[l+3]+=a,e[l+4]+=h,e[l+5]+=a,e[l+6]+=h,r=wi;case wi:i=e[l+3],s=e[l+4],a=e[l+5],h=e[l+6],_.push(wi,e[l+1],e[l+2],i,s,a,h),l+=7;break;case wu:e[l+1]+=a,e[l+2]+=h,r=dn;case dn:o=n===xi||n===dn,i=o?2*a-i:e[l+1],s=o?2*h-s:e[l+2],t?Oa(_,a,h,i,s,e[l+1],e[l+2]):_.push(xi,i,s,e[l+1],e[l+2]),a=e[l+1],h=e[l+2],l+=3;break;case vu:e[l+1]+=a,e[l+2]+=h,e[l+3]+=a,e[l+4]+=h,r=xi;case xi:i=e[l+1],s=e[l+2],t?Oa(_,a,h,i,s,e[l+3],e[l+4]):_.push(xi,i,s,e[l+3],e[l+4]),a=e[l+3],h=e[l+4],l+=5;break;case bu:e[l+6]+=a,e[l+7]+=h;case xu:Du(_,a,h,e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],e[l+6],e[l+7],t),a=e[l+6],h=e[l+7],l+=8;break;case Su:case un:_.push(un),l++;break;case ku:a=e[l+1],h=e[l+2],t?Ou(_,a,h,e[l+3],e[l+4]):De(_,e,l,5),l+=5;break;case Bu:a=e[l+1],h=e[l+2],t?Ra(_,a,h,e[l+3],e[l+4],[e[l+5],e[l+6],e[l+7],e[l+8]]):De(_,e,l,9),l+=9;break;case Pu:a=e[l+1],h=e[l+2],t?Ra(_,a,h,e[l+3],e[l+4],e[l+5]):De(_,e,l,6),l+=6;break;case Eu:La(t?_:De(_,e,l,9),e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],e[l+6],e[l+7],e[l+8],null,fe),a=fe.x,h=fe.y,l+=9;break;case Tu:t?La(_,e[l+1],e[l+2],e[l+3],e[l+4],0,0,360,!1):De(_,e,l,5),a=e[l+1]+e[l+3],h=e[l+2],l+=5;break;case Ru:Ca(t?_:De(_,e,l,7),e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],e[l+6],null,fe),a=fe.x,h=fe.y,l+=7;break;case Cu:t?Ca(_,e[l+1],e[l+2],e[l+3],0,360,!1):De(_,e,l,4),a=e[l+1]+e[l+3],h=e[l+2],l+=4;break;case Lu:Au(t?_:De(_,e,l,6),a,h,e[l+1],e[l+2],e[l+3],e[l+4],e[l+5],null,fe),a=fe.x,h=fe.y,l+=6;break;default:return Mu.error(`command: ${r} [index:${l}]`,e),_}n=r}return _},objectToCanvasData(e){if(e[0].name.length>1)return du.toCommand(e);{const t=[];return e.forEach(i=>{switch(i.name){case"M":t.push(hn,i.x,i.y);break;case"L":t.push(qi,i.x,i.y);break;case"C":t.push(wi,i.x1,i.y1,i.x2,i.y2,i.x,i.y);break;case"Q":t.push(xi,i.x1,i.y1,i.x,i.y);break;case"Z":t.push(un)}}),t}},copyData(e,t,i,s){for(let r=i,n=i+s;r<n;r++)e.push(t[r])},pushData(e,t){qt.index===qt.length&&(qt.index=1,e.push(qt.name)),e.push(Number(t)),qt.index++,qt.dot=0}},{current:qt,pushData:Ke,copyData:De}=di,{M:cn,L:$u,C:Fu,Q:Iu,Z:Wu,N:Aa,D:Nu,X:zu,G:Yu,F:Xu,O:ju,P:Uu,U:Hu}=Ut,{getMinDistanceFrom:Vu,getRadianFrom:qu}=L,{tan:Gu,min:Da,abs:Ku}=Math,bi={},_i={beginPath(e){e.length=0},moveTo(e,t,i){e.push(cn,t,i)},lineTo(e,t,i){e.push($u,t,i)},bezierCurveTo(e,t,i,s,r,n,o){e.push(Fu,t,i,s,r,n,o)},quadraticCurveTo(e,t,i,s,r){e.push(Iu,t,i,s,r)},closePath(e){e.push(Wu)},rect(e,t,i,s,r){e.push(Aa,t,i,s,r)},roundRect(e,t,i,s,r,n){if(I(n))e.push(zu,t,i,s,r,n);else{const o=wt.fourNumber(n);o?e.push(Nu,t,i,s,r,...o):e.push(Aa,t,i,s,r)}},ellipse(e,t,i,s,r,n,o,a,h){if(s===r)return Ma(e,t,i,s,o,a,h);Pt(n)?e.push(Xu,t,i,s,r):(Pt(o)&&(o=0),Pt(a)&&(a=360),e.push(Yu,t,i,s,r,n,o,a,h?1:0))},arc(e,t,i,s,r,n,o){Pt(r)?e.push(Uu,t,i,s):(Pt(r)&&(r=0),Pt(n)&&(n=360),e.push(ju,t,i,s,r,n,o?1:0))},arcTo(e,t,i,s,r,n,o,a){if(!P(o)){const h=Vu(o,a,t,i,s,r);n=Da(n,Da(h/2,h/2*Ku(Gu(qu(o,a,t,i,s,r)/2))))}e.push(Hu,t,i,s,r,n)},drawEllipse(e,t,i,s,r,n,o,a,h){Te.ellipse(null,t,i,s,r,Pt(n)?0:n,Pt(o)?0:o,Pt(a)?360:a,h,null,null,bi),e.push(cn,bi.x,bi.y),Qu(e,t,i,s,r,n,o,a,h)},drawArc(e,t,i,s,r,n,o){Te.arc(null,t,i,s,Pt(r)?0:r,Pt(n)?360:n,o,null,null,bi),e.push(cn,bi.x,bi.y),Ma(e,t,i,s,r,n,o)},drawPoints(e,t,i,s){Te.points(e,t,i,s)}},{ellipse:Qu,arc:Ma}=_i,{moveTo:Zu,lineTo:Ju,quadraticCurveTo:tc,bezierCurveTo:ec,closePath:ic,beginPath:sc,rect:rc,roundRect:nc,ellipse:oc,arc:ac,arcTo:hc,drawEllipse:lc,drawArc:dc,drawPoints:uc}=_i;class dd{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return this.__path=t?J(t)?ce.parse(t):t:[],this}beginPath(){return sc(this.__path),this.paint(),this}moveTo(t,i){return Zu(this.__path,t,i),this.paint(),this}lineTo(t,i){return Ju(this.__path,t,i),this.paint(),this}bezierCurveTo(t,i,s,r,n,o){return ec(this.__path,t,i,s,r,n,o),this.paint(),this}quadraticCurveTo(t,i,s,r){return tc(this.__path,t,i,s,r),this.paint(),this}closePath(){return ic(this.__path),this.paint(),this}rect(t,i,s,r){return rc(this.__path,t,i,s,r),this.paint(),this}roundRect(t,i,s,r,n){return nc(this.__path,t,i,s,r,n),this.paint(),this}ellipse(t,i,s,r,n,o,a,h){return oc(this.__path,t,i,s,r,n,o,a,h),this.paint(),this}arc(t,i,s,r,n,o){return ac(this.__path,t,i,s,r,n,o),this.paint(),this}arcTo(t,i,s,r,n){return hc(this.__path,t,i,s,r,n),this.paint(),this}drawEllipse(t,i,s,r,n,o,a,h){return lc(this.__path,t,i,s,r,n,o,a,h),this.paint(),this}drawArc(t,i,s,r,n,o){return dc(this.__path,t,i,s,r,n,o),this.paint(),this}drawPoints(t,i,s){return uc(this.__path,t,i,s),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:cc,L:_c,C:pc,Q:gc,Z:fc,N:yc,D:mc,X:vc,G:wc,F:xc,O:bc,P:Sc,U:kc}=Ut,Bc=et.get("PathDrawer"),Pc={drawPathByData(e,t){if(!t)return;let i,s=0,r=t.length;for(;s<r;)switch(i=t[s],i){case cc:e.moveTo(t[s+1],t[s+2]),s+=3;break;case _c:e.lineTo(t[s+1],t[s+2]),s+=3;break;case pc:e.bezierCurveTo(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5],t[s+6]),s+=7;break;case gc:e.quadraticCurveTo(t[s+1],t[s+2],t[s+3],t[s+4]),s+=5;break;case fc:e.closePath(),s+=1;break;case yc:e.rect(t[s+1],t[s+2],t[s+3],t[s+4]),s+=5;break;case mc:e.roundRect(t[s+1],t[s+2],t[s+3],t[s+4],[t[s+5],t[s+6],t[s+7],t[s+8]]),s+=9;break;case vc:e.roundRect(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]),s+=6;break;case wc:e.ellipse(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]*G,t[s+6]*G,t[s+7]*G,t[s+8]),s+=9;break;case xc:e.ellipse(t[s+1],t[s+2],t[s+3],t[s+4],0,0,Jt,!1),s+=5;break;case bc:e.arc(t[s+1],t[s+2],t[s+3],t[s+4]*G,t[s+5]*G,t[s+6]),s+=7;break;case Sc:e.arc(t[s+1],t[s+2],t[s+3],0,Jt,!1),s+=4;break;case kc:e.arcTo(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]),s+=6;break;default:return void Bc.error(`command: ${i} [index:${s}]`,t)}}},{M:Ec,L:Tc,C:$a,Q:Fa,Z:Ia,N:Rc,D:Wa,X:Cc,G:Lc,F:Oc,O:Ac,P:Dc,U:Mc}=Ut,{toTwoPointBounds:$c,toTwoPointBoundsByQuadraticCurve:Fc,arcTo:Ic,arc:Wc,ellipse:Nc}=Te,{addPointBounds:Gi,copy:_n,addPoint:zc,setPoint:pn,addBounds:Vs,toBounds:Yc}=zr,Xc=et.get("PathBounds");let Si,qs,gn;const zt={},Na={},ye={},ud={toBounds(e,t){ud.toTwoPointBounds(e,Na),Yc(Na,t)},toTwoPointBounds(e,t){if(!e||!e.length)return pn(t,0,0);let i,s,r,n,o,a=0,h=0,d=0;const u=e.length;for(;a<u;)switch(o=e[a],a===0&&(o===Ia||o===$a||o===Fa?pn(t,h,d):pn(t,e[a+1],e[a+2])),o){case Ec:case Tc:h=e[a+1],d=e[a+2],zc(t,h,d),a+=3;break;case $a:r=e[a+5],n=e[a+6],$c(h,d,e[a+1],e[a+2],e[a+3],e[a+4],r,n,zt),Gi(t,zt),h=r,d=n,a+=7;break;case Fa:i=e[a+1],s=e[a+2],r=e[a+3],n=e[a+4],Fc(h,d,i,s,r,n,zt),Gi(t,zt),h=r,d=n,a+=5;break;case Ia:a+=1;break;case Rc:h=e[a+1],d=e[a+2],Vs(t,h,d,e[a+3],e[a+4]),a+=5;break;case Wa:case Cc:h=e[a+1],d=e[a+2],Vs(t,h,d,e[a+3],e[a+4]),a+=o===Wa?9:6;break;case Lc:Nc(null,e[a+1],e[a+2],e[a+3],e[a+4],e[a+5],e[a+6],e[a+7],e[a+8],zt,ye),a===0?_n(t,zt):Gi(t,zt),h=ye.x,d=ye.y,a+=9;break;case Oc:h=e[a+1],d=e[a+2],qs=e[a+3],gn=e[a+4],Vs(t,h-qs,d-gn,2*qs,2*gn),h+=qs,a+=5;break;case Ac:Wc(null,e[a+1],e[a+2],e[a+3],e[a+4],e[a+5],e[a+6],zt,ye),a===0?_n(t,zt):Gi(t,zt),h=ye.x,d=ye.y,a+=7;break;case Dc:h=e[a+1],d=e[a+2],Si=e[a+3],Vs(t,h-Si,d-Si,2*Si,2*Si),h+=Si,a+=4;break;case Mc:Ic(null,h,d,e[a+1],e[a+2],e[a+3],e[a+4],e[a+5],zt,ye),a===0?_n(t,zt):Gi(t,zt),h=ye.x,d=ye.y,a+=6;break;default:return void Xc.error(`command: ${o} [index:${a}]`,e)}}},{M:fn,L:Gs,Z:Ki}=Ut,{getCenterX:jc,getCenterY:Uc}=L,{arcTo:yn}=_i,Hc={smooth(e,t,i){let s,r,n,o=0,a=0,h=0,d=0,u=0,l=0,c=0,_=0,g=0;Q(t)&&(t=t[0]||0);const y=e.length,f=[];for(;o<y;){switch(s=e[o],s){case fn:d=_=e[o+1],u=g=e[o+2],o+=3,e[o]===Gs?(l=e[o+1],c=e[o+2],f.push(fn,jc(d,l),Uc(u,c))):f.push(fn,d,u);break;case Gs:switch(a=e[o+1],h=e[o+2],o+=3,e[o]){case Gs:yn(f,a,h,e[o+1],e[o+2],t,_,g);break;case Ki:yn(f,a,h,d,u,t,_,g);break;default:f.push(Gs,a,h)}_=a,g=h;break;case Ki:r!==Ki&&(yn(f,d,u,l,c,t,_,g),f.push(Ki)),o+=1;break;default:n=Wo[s];for(let w=0;w<n;w++)f.push(e[o+w]);o+=n}r=s}return s!==Ki&&(f[1]=d,f[2]=u),f}};function cd(e){return new dd(e)}const Qi=cd();ce.creator=cd(),ce.parse=di.parse,ce.convertToCanvasData=di.toCanvasData;const{drawRoundRect:Vc}=ld;function za(e){(function(t){t&&!t.roundRect&&(t.roundRect=function(i,s,r,n,o){Vc(this,i,s,r,n,o)})})(e)}const Ss={alphaPixelTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType:e=>!e||e.startsWith("image")?e:(e==="jpg"&&(e="jpeg"),"image/"+e),fileType(e){const t=e.split(".");return t[t.length-1]},isOpaqueImage(e){const t=yo.fileType(e);return["jpg","jpeg"].some(i=>i===t)},getExportOptions(e){switch(typeof e){case"object":return e;case"number":return{quality:e};case"boolean":return{blob:e};default:return{}}}},yo=Ss;yo.alphaPixelTypes.forEach(e=>yo.upperCaseTypeMap[e]=e.toUpperCase());const qc=et.get("TaskProcessor");let Gc=class{constructor(t){this.parallel=!0,this.time=1,this.id=Re.create(Re.TASK),this.task=t}run(){return id(this,void 0,void 0,function*(){try{if(this.isComplete)return;if(this.canUse&&!this.canUse())return this.cancel();this.task&&this.parent.running&&(yield this.task())}catch(t){qc.error(t)}})}complete(){this.isComplete=!0,this.parent=this.task=this.canUse=null}cancel(){this.isCancel=!0,this.complete()}},_d=class{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let i=0,s=0;for(let r=0;r<t;r++)r<=this.finishedIndex?(s+=this.list[r].time,r===this.finishedIndex&&(i=s)):i+=this.list[r].time;return this.isComplete?1:s/i}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&Z.assign(this.config,t),this.empty()}add(t,i,s){let r,n,o,a;const h=new Gc(t);return h.parent=this,I(i)?a=i:i&&(n=i.parallel,r=i.start,o=i.time,a=i.delay,s||(s=i.canUse)),o&&(h.time=o),n===!1&&(h.parallel=!1),s&&(h.canUse=s),P(a)?this.push(h,r):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(h,r))},a)),this.isComplete=!1,h}push(t,i){this.list.push(t),i===!1||this.timer||(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];t?t.run().then(()=>{this.onTask(t),this.index++,t.isCancel?this.runTask():this.nextTask()}).catch(i=>{this.onError(i)}):this.timer=setTimeout(()=>this.nextTask())}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(i=>{this.onParallelError(i)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;const{config:i,list:s,index:r}=this;this.parallelList=[],this.parallelSuccessNumber=0;let n=r+i.parallel;if(n>s.length&&(n=s.length),i.parallel>1)for(let o=r;o<n&&(t=s[o],t.parallel);o++)this.parallelList.push(t)}fillParallelTask(){let t;const i=this.parallelList;this.parallelSuccessNumber++,i.pop();const s=i.length,r=this.finishedIndex+s;if(i.length){if(!this.running)return;r<this.total&&(t=this.list[r],t&&t.parallel&&(i.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(i=>{i.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}};const Kc=et.get("Resource"),ai={tasker:new _d,map:{},get isComplete(){return Me.tasker.isComplete},set(e,t){Me.map[e]&&Kc.repeat(e),Me.map[e]=t},get:e=>Me.map[e],remove(e){const t=Me.map[e];t&&(t.destroy&&t.destroy(),delete Me.map[e])},loadImage(e,t){return new Promise((i,s)=>{const r=this.setImage(e,e,t);r.load(()=>i(r),n=>s(n))})},setImage(e,t,i){let s;return J(t)?s={url:t}:t.url||(s={url:e,view:t}),s&&(i&&(s.format=i),t=at.image(s)),Me.set(e,t),t},destroy(){Me.map={}}},Me=ai,Qt={maxRecycled:10,recycledList:[],patternTasker:new _d({parallel:1}),get(e){let t=ai.get(e.url);return t||ai.set(e.url,t=at.image(e)),t.use++,t},recycle(e){e.use--,setTimeout(()=>{e.use||(S.image.isLarge(e)?e.url&&ai.remove(e.url):(e.clearLevels(),Zi.recycledList.push(e)))})},recyclePaint(e){Zi.recycle(e.image)},clearRecycled(e){const t=Zi.recycledList;(t.length>Zi.maxRecycled||e)&&(t.forEach(i=>(!i.use||e)&&i.url&&ai.remove(i.url)),t.length=0)},clearLevels(){},hasAlphaPixel:e=>Ss.alphaPixelTypes.some(t=>Zi.isFormat(t,e)),isFormat(e,t){if(t.format)return t.format===e;const{url:i}=t;if(i.startsWith("data:")){if(i.startsWith("data:"+Ss.mineType(e)))return!0}else if(i.includes("."+e)||i.includes("."+Ss.upperCaseTypeMap[e])||e==="png"&&!i.includes("."))return!0;return!1},destroy(){this.clearRecycled(!0)}},Zi=Qt,{IMAGE:Qc,create:Zc}=Re;class pd{get url(){return this.config.url}get crossOrigin(){const{crossOrigin:t}=this.config;return P(t)?S.image.crossOrigin:t}get completed(){return this.ready||!!this.error}constructor(t){if(this.use=0,this.waitComplete=[],this.innerId=Zc(Qc),this.config=t||(t={url:""}),t.view){const{view:i}=t;this.setView(i.config?i.view:i)}Qt.isFormat("svg",t)&&(this.isSVG=!0),Qt.hasAlphaPixel(t)&&(this.hasAlphaPixel=!0)}load(t,i,s){return this.loading||(this.loading=!0,ai.tasker.add(()=>id(this,void 0,void 0,function*(){return yield S.origin.loadImage(this.getLoadUrl(s),this.crossOrigin,this).then(r=>{s&&this.setThumbView(r),this.setView(r)}).catch(r=>{this.error=r,this.onComplete(!1)})}))),this.waitComplete.push(t,i),this.waitComplete.length-2}unload(t,i){const s=this.waitComplete;if(i){const r=s[t+1];r&&r({type:"stop"})}s[t]=s[t+1]=void 0}setView(t){this.ready=!0,this.width||(this.width=t.width,this.height=t.height,this.view=t),this.onComplete(!0)}onComplete(t){let i;this.waitComplete.forEach((s,r)=>{i=r%2,s&&(t?i||s(this):i&&s(this.error))}),this.waitComplete.length=0,this.loading=!1}getFull(t){return this.view}getCanvas(t,i,s,r,n,o,a){if(t||(t=this.width),i||(i=this.height),this.cache){let{params:d,data:u}=this.cache;for(let l in d)if(d[l]!==arguments[l]){u=null;break}if(u)return u}const h=S.image.resize(this.view,t,i,n,o,void 0,a,s,r);return this.cache=this.use>1?{data:h,params:arguments}:null,h}getPattern(t,i,s,r){const n=S.canvas.createPattern(t,i);return S.image.setPatternTransform(n,s,r),n}getLoadUrl(t){return this.url}setThumbView(t){}getThumbSize(t){}getMinLevel(){}getLevelData(t,i,s){}clearLevels(t){}destroy(){this.clearLevels();const{view:t}=this;t&&t.close&&t.close(),this.config={url:""},this.cache=this.view=null,this.waitComplete.length=0}}function pi(e,t,i,s){i.configurable=i.enumerable=!0,Object.defineProperty(e,t,i)}function No(e,t){return Object.getOwnPropertyDescriptor(e,t)}function Jc(e,t){const i="_"+e;return{get(){const s=this[i];return s??t},set(s){this[i]=s}}}function it(e,t){return(i,s)=>t_(i,s,e,t&&t(s))}function t_(e,t,i,s){pi(e,t,Object.assign({get(){return this.__getAttr(t)},set(n){this.__setAttr(t,n)}},s||{})),fd(e,t,i)}function dt(e){return it(e)}function Ks(e,t){return it(e,i=>({set(s){this.__setAttr(i,s,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function Ya(e,t){return it(e,i=>({set(s){this.__setAttr(i,s,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__scrollWorld||(this.__scrollWorld={}))}}))}function Xa(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal(),gi(this))}}))}function ja(e,t){return it(e,i=>({set(s){this.__setAttr(i,s,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function mn(e,t){return it(e,i=>({set(s){this.__setAttr(i,s,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function $(e,t){return it(e,i=>({set(s){this.__setAttr(i,s,t)&&gi(this)}}))}function e_(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(gi(this),this.__.__removeNaturalSize())}}))}function gi(e){e.__layout.boxChanged||e.__layout.boxChange(),e.__hasAutoLayout&&(e.__layout.matrixChanged||e.__layout.matrixChange())}function i_(e){return it(e,t=>({set(i){const s=this.__;s.__pathInputed!==2&&(s.__pathInputed=i?1:0),i||(s.__pathForRender=void 0),this.__setAttr(t,i),gi(this)}}))}const Dt=$;function Yr(e,t){return it(e,i=>({set(s){this.__setAttr(i,s)&&(s_(this),t&&(this.__.__useStroke=!0))}}))}function s_(e){e.__layout.strokeChanged||e.__layout.strokeChange(),e.__.__useArrow&&gi(e)}const de=Yr;function zo(e){return it(e,t=>({set(i){this.__setAttr(t,i),this.__layout.renderChanged||this.__layout.renderChange()}}))}function Be(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function Ua(e){return it(e,t=>({set(i){if(this.__setAttr(t,i)){const s=this.__;Z.stintSet(s,"__useDim",s.dim||s.bright||s.dimskip),this.__layout.surfaceChange()}}}))}function r_(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(this.__layout.opacityChanged||this.__layout.opacityChange()),this.mask&&gd(this)}}))}function n_(e){return it(e,t=>({set(i){const s=this.visible;if(s===!0&&i===0){if(this.animationOut)return this.__runAnimation("out",()=>Ha(this,t,i,s))}else s===0&&i===!0&&this.animation&&this.__runAnimation("in");Ha(this,t,i,s),this.mask&&gd(this)}}))}function gd(e){const{parent:t}=e;if(t){const{__hasMask:i}=t;t.__updateMask(),i!==t.__hasMask&&t.forceUpdate()}}function Ha(e,t,i,s){e.__setAttr(t,i)&&(e.__layout.opacityChanged||e.__layout.opacityChange(),s!==0&&i!==0||gi(e))}function o_(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function a_(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(i)}))}}))}function h_(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&this.waitParent(()=>{this.parent.__updateEraser(i)})}}))}function ri(e){return it(e,t=>({set(i){this.__setAttr(t,i)&&(this.__layout.hitCanvasChanged=!0,et.showBounds==="hit"&&this.__layout.surfaceChange(),this.leafer&&this.leafer.updateCursor())}}))}function l_(e){return it(e,t=>({set(i){this.__setAttr(t,i),this.leafer&&this.leafer.updateCursor()}}))}function Tt(e){return(t,i)=>{pi(t,"__DataProcessor",{get:()=>e})}}function fd(e,t,i){const s=e.__DataProcessor.prototype,r="_"+t,n=(function(u){return"set"+u.charAt(0).toUpperCase()+u.slice(1)})(t),o=Jc(t,i);if(P(i))o.get=function(){return this[r]};else if(typeof i=="function")o.get=function(){const u=this[r];return u??i(this.__leaf)};else if(W(i)){const u=Ad(i);o.get=function(){const l=this[r];return l??(this[r]=u?{}:Z.clone(i))}}const a=e.isBranchLeaf;t==="width"?o.get=function(){const u=this[r];if(u==null){const l=this,c=l.__naturalWidth,_=l.__leaf;return!i||_.pathInputed?_.boxBounds.width:c?l._height&&l.__useNaturalRatio?l._height*c/l.__naturalHeight:c:a&&_.children.length?_.boxBounds.width:i}return u}:t==="height"&&(o.get=function(){const u=this[r];if(u==null){const l=this,c=l.__naturalHeight,_=l.__leaf;return!i||_.pathInputed?_.boxBounds.height:c?l._width&&l.__useNaturalRatio?l._width*c/l.__naturalWidth:c:a&&_.children.length?_.boxBounds.height:i}return u});let h,d=s;for(;!h&&d;)h=No(d,t),d=d.__proto__;h&&h.set&&(o.set=h.set),s[n]&&(o.set=s[n],delete s[n]),pi(s,t,o)}const d_=new et("rewrite"),Tr=[],u_=["destroy","constructor"];function ke(e){return(t,i)=>{Tr.push({name:t.constructor.name+"."+i,run:()=>{t[i]=e}})}}function Xr(){return e=>{yd()}}function yd(e){Tr.length&&(Tr.forEach(t=>{e&&d_.error(t.name,"Class@rewriteAble()"),t.run()}),Tr.length=0)}function jt(e,t){return i=>{var s;(e.prototype?(s=e.prototype,Object.getOwnPropertyNames(s)):Object.keys(e)).forEach(r=>{u_.includes(r)||t&&t.includes(r)||(e.prototype?No(e.prototype,r).writable&&(i.prototype[r]=e.prototype[r]):i.prototype[r]=e[r])})}}function Rt(){return e=>{Rs.register(e)}}function Ce(){return e=>{zi.register(e)}}setTimeout(()=>yd(!0));const{copy:ki,toInnerPoint:c_,toOuterPoint:__,scaleOfOuter:Va,rotateOfOuter:p_,skewOfOuter:g_,multiplyParent:qa,divideParent:Ga,getLayout:f_}=C,ot={},{round:Ka}=Math,yt={updateAllMatrix(e,t,i){if(t&&e.__hasAutoLayout&&e.__layout.matrixChanged&&(i=!0),m_(e,t,i),e.isBranch){const{children:s}=e;for(let r=0,n=s.length;r<n;r++)y_(s[r],t,i)}},updateMatrix(e,t,i){const s=e.__layout;t?i&&(s.waitAutoLayout=!0,e.__hasAutoLayout&&(s.matrixChanged=!1)):s.waitAutoLayout&&(s.waitAutoLayout=!1),s.matrixChanged&&e.__updateLocalMatrix(),s.waitAutoLayout||e.__updateWorldMatrix()},updateBounds(e){const t=e.__layout;t.boundsChanged&&e.__updateLocalBounds(),t.waitAutoLayout||e.__updateWorldBounds()},updateAllWorldOpacity(e){if(e.__updateWorldOpacity(),e.isBranch){const{children:t}=e;for(let i=0,s=t.length;i<s;i++)Qa(t[i])}},updateChange(e){const t=e.__layout;t.stateStyleChanged&&e.updateState(),t.opacityChanged&&Qa(e),e.__updateChange()},updateAllChange(e){if(w_(e),e.isBranch){const{children:t}=e;for(let i=0,s=t.length;i<s;i++)v_(t[i])}},worldHittable(e){for(;e;){if(!e.__.hittable)return!1;e=e.parent}return!0},draggable:e=>(e.draggable||e.editable)&&e.hitSelf&&!e.locked,copyCanvasByWorld(e,t,i,s,r,n){s||(s=e.__nowWorld),e.__worldFlipped||S.fullImageShadow?t.copyWorldByReset(i,s,e.__nowWorld,r,n):t.copyWorldToInner(i,s,e.__layout.renderBounds,r)},moveWorld(e,t,i=0,s,r){const n=W(t)?Object.assign({},t):{x:t,y:i};s?__(e.localTransform,n,n,!0):e.parent&&c_(e.parent.scrollWorldTransform,n,n,!0),pt.moveLocal(e,n.x,n.y,r)},moveLocal(e,t,i=0,s){W(t)&&(i=t.y,t=t.x),t+=e.x,i+=e.y,e.leafer&&e.leafer.config.pointSnap&&(t=Ka(t),i=Ka(i)),s?e.animate({x:t,y:i},s):(e.x=t,e.y=i)},zoomOfWorld(e,t,i,s,r,n){pt.zoomOfLocal(e,vn(e,t),i,s,r,n)},zoomOfLocal(e,t,i,s=i,r,n){const o=e.__localMatrix;if(I(s)||(s&&(n=s),s=i),ki(ot,o),Va(ot,t,i,s),pt.hasHighPosition(e))pt.setTransform(e,ot,r,n);else{const a=e.x+ot.e-o.e,h=e.y+ot.f-o.f;n&&!r?e.animate({x:a,y:h,scaleX:e.scaleX*i,scaleY:e.scaleY*s},n):(e.x=a,e.y=h,e.scaleResize(i,s,r!==!0))}},rotateOfWorld(e,t,i,s){pt.rotateOfLocal(e,vn(e,t),i,s)},rotateOfLocal(e,t,i,s){const r=e.__localMatrix;ki(ot,r),p_(ot,t,i),pt.hasHighPosition(e)?pt.setTransform(e,ot,!1,s):e.set({x:e.x+ot.e-r.e,y:e.y+ot.f-r.f,rotation:wt.formatRotation(e.rotation+i)},s)},skewOfWorld(e,t,i,s,r,n){pt.skewOfLocal(e,vn(e,t),i,s,r,n)},skewOfLocal(e,t,i,s=0,r,n){ki(ot,e.__localMatrix),g_(ot,t,i,s),pt.setTransform(e,ot,r,n)},transformWorld(e,t,i,s){ki(ot,e.worldTransform),qa(ot,t),e.parent&&Ga(ot,e.parent.scrollWorldTransform),pt.setTransform(e,ot,i,s)},transform(e,t,i,s){ki(ot,e.localTransform),qa(ot,t),pt.setTransform(e,ot,i,s)},setTransform(e,t,i,s){const r=e.__,n=r.origin&&pt.getInnerOrigin(e,r.origin),o=f_(t,n,r.around&&pt.getInnerOrigin(e,r.around));if(pt.hasOffset(e)&&(o.x-=r.offsetX,o.y-=r.offsetY),i){const a=o.scaleX/e.scaleX,h=o.scaleY/e.scaleY;if(delete o.scaleX,delete o.scaleY,n){B.scale(e.boxBounds,Math.abs(a),Math.abs(h));const d=pt.getInnerOrigin(e,r.origin);L.move(o,n.x-d.x,n.y-d.y)}e.set(o),e.scaleResize(a,h,!1)}else e.set(o,s)},getFlipTransform(e,t){const i={a:1,b:0,c:0,d:1,e:0,f:0},s=t==="x"?1:-1;return Va(i,pt.getLocalOrigin(e,"center"),-1*s,1*s),i},getLocalOrigin:(e,t)=>L.tempToOuterOf(pt.getInnerOrigin(e,t),e.localTransform),getInnerOrigin(e,t){const i={};return ci.toPoint(t,e.boxBounds,i),i},getRelativeWorld:(e,t,i)=>(ki(ot,e.worldTransform),Ga(ot,t.scrollWorldTransform),i?ot:Object.assign({},ot)),drop(e,t,i,s){e.setTransform(pt.getRelativeWorld(e,t,!0),s),t.add(e,i)},hasHighPosition:e=>e.origin||e.around||pt.hasOffset(e),hasOffset:e=>e.offsetX||e.offsetY,hasParent(e,t){if(!t)return!1;for(;e;){if(t===e)return!0;e=e.parent}},animateMove(e,t,i=.3){if(t.x||t.y)if(Math.abs(t.x)<1&&Math.abs(t.y)<1)e.move(t);else{const s=t.x*i,r=t.y*i;t.x-=s,t.y-=r,e.move(s,r),S.requestRender(()=>pt.animateMove(e,t,i))}}},pt=yt,{updateAllMatrix:y_,updateMatrix:m_,updateAllWorldOpacity:Qa,updateAllChange:v_,updateChange:w_}=pt;function vn(e,t){return e.updateLayout(),e.parent?L.tempToInnerOf(t,e.parent.scrollWorldTransform):t}const jr={worldBounds:e=>e.__world,localBoxBounds:e=>e.__.eraser||e.__.visible===0?null:e.__local||e.__layout,localStrokeBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localStrokeBounds,localRenderBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localRenderBounds,maskLocalBoxBounds:(e,t)=>wn(e,t)&&e.__localBoxBounds,maskLocalStrokeBounds:(e,t)=>wn(e,t)&&e.__layout.localStrokeBounds,maskLocalRenderBounds:(e,t)=>wn(e,t)&&e.__layout.localRenderBounds,excludeRenderBounds:(e,t)=>!(!t.bounds||t.bounds.hit(e.__world,t.matrix))||!(!t.hideBounds||!t.hideBounds.includes(e.__world,t.matrix))};let Ji;function wn(e,t){return t||(Ji=0),e.__.mask&&(Ji=1),Ji<0?null:(Ji&&(Ji=-1),!0)}const{updateBounds:Za}=yt,ji={sort:(e,t)=>e.__.zIndex===t.__.zIndex?e.__tempNumber-t.__tempNumber:e.__.zIndex-t.__.zIndex,pushAllChildBranch(e,t){if(e.__tempNumber=1,e.__.__childBranchNumber){const{children:i}=e;for(let s=0,r=i.length;s<r;s++)(e=i[s]).isBranch&&(e.__tempNumber=1,t.add(e),x_(e,t))}},pushAllParent(e,t){const{keys:i}=t;if(i)for(;e.parent&&P(i[e.parent.innerId]);)t.add(e.parent),e=e.parent;else for(;e.parent;)t.add(e.parent),e=e.parent},pushAllBranchStack(e,t){let i=t.length;const{children:s}=e;for(let r=0,n=s.length;r<n;r++)s[r].isBranch&&t.push(s[r]);for(let r=i,n=t.length;r<n;r++)Ja(t[r],t)},updateBounds(e,t){const i=[e];Ja(e,i),b_(i,t)},updateBoundsByBranchStack(e,t){let i,s;for(let r=e.length-1;r>-1;r--){i=e[r],s=i.children;for(let n=0,o=s.length;n<o;n++)Za(s[n]);t&&t===i||Za(i)}},move(e,t,i){let s;const{children:r}=e;for(let n=0,o=r.length;n<o;n++)s=(e=r[n]).__world,s.e+=t,s.f+=i,s.x+=t,s.y+=i,e.isBranch&&S_(e,t,i)},scale(e,t,i,s,r,n,o){let a;const{children:h}=e,d=s-1,u=r-1;for(let l=0,c=h.length;l<c;l++)a=(e=h[l]).__world,a.a*=s,a.d*=r,(a.b||a.c)&&(a.b*=s,a.c*=r),a.e===a.x&&a.f===a.y?(a.x=a.e+=(a.e-n)*d+t,a.y=a.f+=(a.f-o)*u+i):(a.e+=(a.e-n)*d+t,a.f+=(a.f-o)*u+i,a.x+=(a.x-n)*d+t,a.y+=(a.y-o)*u+i),a.width*=s,a.height*=r,a.scaleX*=s,a.scaleY*=r,e.isBranch&&k_(e,t,i,s,r,n,o)}},{pushAllChildBranch:x_,pushAllBranchStack:Ja,updateBoundsByBranchStack:b_,move:S_,scale:k_}=ji,ts={run(e){if(e&&e.length){const t=e.length;for(let i=0;i<t;i++)e[i]();e.length===t?e.length=0:e.splice(0,t)}}},{getRelativeWorld:th,updateBounds:B_}=yt,{toOuterOf:Qs,getPoints:P_,copy:E_}=B,xn="_localContentBounds",bn="_worldContentBounds",Sn="_worldBoxBounds",kn="_worldStrokeBounds";class T_{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}set renderBounds(t){this._renderBounds=t}get localContentBounds(){return Qs(this.contentBounds,this.leaf.__localMatrix,this[xn]||(this[xn]={})),this[xn]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return Qs(this.contentBounds,this.leaf.__world,this[bn]||(this[bn]={})),this[bn]}get worldBoxBounds(){return Qs(this.boxBounds,this.leaf.__world,this[Sn]||(this[Sn]={})),this[Sn]}get worldStrokeBounds(){return Qs(this.strokeBounds,this.leaf.__world,this[kn]||(this[kn]={})),this[kn]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),t.__world&&(this.boxBounds={x:0,y:0,width:0,height:0},this.boxChange(),this.matrixChange())}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leaf:t}=this,{leafer:i}=t;if(t.isApp)return B_(t);if(i)i.ready?i.watcher.changed&&i.layouter.layout():i.start();else{let s=t;for(;s.parent&&!s.parent.leafer;)s=s.parent;const r=s;if(r.__fullLayouting)return;r.__fullLayouting=!0,S.layout(r),delete r.__fullLayouting}}getTransform(t="world"){this.update();const{leaf:i}=this;switch(t){case"world":return i.__world;case"local":return i.__localMatrix;case"inner":return C.defaultMatrix;case"page":t=i.zoomLayer;default:return th(i,t)}}getBounds(t,i="world"){switch(this.update(),i){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":i=this.leaf.zoomLayer;default:return new ft(this.getInnerBounds(t)).toOuterOf(this.getTransform(i))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,i="world",s){const{leaf:r}=this;let n,o,a,h=this.getInnerBounds(t);switch(i){case"world":n=r.getWorldPoint(h),o=r.__world;break;case"local":const{scaleX:d,scaleY:u,rotation:l,skewX:c,skewY:_}=r.__;a={scaleX:d,scaleY:u,rotation:l,skewX:c,skewY:_},n=r.getLocalPointByInner(h);break;case"inner":n=h,o=C.defaultMatrix;break;case"page":i=r.zoomLayer;default:n=r.getWorldPoint(h,i),o=th(r,i,!0)}if(a||(a=C.getLayout(o)),E_(a,h),L.copy(a,n),s){const{scaleX:d,scaleY:u}=a,l=Math.abs(d),c=Math.abs(u);l===1&&c===1||(a.scaleX/=l,a.scaleY/=c,a.width*=l,a.height*=c)}return a}getLayoutPoints(t,i="world"){const{leaf:s}=this,r=P_(this.getInnerBounds(t));let n;switch(i){case"world":n=null;break;case"local":n=s.parent;break;case"inner":break;case"page":i=s.zoomLayer;default:n=i}return P(n)||r.forEach(o=>s.innerToWorld(o,null,!1,n)),r}shrinkContent(){const{x:t,y:i,width:s,height:r}=this.boxBounds;this._contentBounds={x:t,y:i,width:s,height:r}}spreadStroke(){const{x:t,y:i,width:s,height:r}=this.strokeBounds;this._strokeBounds={x:t,y:i,width:s,height:r},this._localStrokeBounds={x:t,y:i,width:s,height:r},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:i,width:s,height:r}=this.renderBounds;this._renderBounds={x:t,y:i,width:s,height:r},this._localRenderBounds={x:t,y:i,width:s,height:r}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=this.affectChildrenSort=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class _e{constructor(t,i){this.bubbles=!1,this.type=t,i&&(this.target=i)}stopDefault(){this.isStopDefault=!0,this.origin&&S.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&S.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&S.event.stop(this.origin)}}class _t extends _e{constructor(t,i,s){super(t,i),this.parent=s,this.child=i}}_t.ADD="child.add",_t.REMOVE="child.remove",_t.CREATED="created",_t.MOUNTED="mounted",_t.UNMOUNTED="unmounted",_t.DESTROY="destroy";const mo="property.scroll";class Pe extends _e{constructor(t,i,s,r,n){super(t,i),this.attrName=s,this.oldValue=r,this.newValue=n}}Pe.CHANGE="property.change",Pe.LEAFER_CHANGE="property.leafer_change",Pe.SCROLL=mo;const R_={scrollX:mo,scrollY:mo};class oe extends _e{constructor(t,i){super(t),Object.assign(this,i)}}oe.LOAD="image.load",oe.LOADED="image.loaded",oe.ERROR="image.error";class Ee extends _e{static checkHas(t,i,s){s==="on"?i===Rr?t.__hasWorldEvent=!0:t.__hasLocalEvent=!0:(t.__hasLocalEvent=t.hasEvent(vo)||t.hasEvent(wo)||t.hasEvent(xo),t.__hasWorldEvent=t.hasEvent(Rr))}static emitLocal(t){if(t.leaferIsReady){const{resized:i}=t.__layout;i!=="local"&&(t.emit(vo,t),i==="inner"&&t.emit(wo,t)),t.emit(xo,t)}}static emitWorld(t){t.leaferIsReady&&t.emit(Rr,this)}}Ee.RESIZE="bounds.resize",Ee.INNER="bounds.inner",Ee.LOCAL="bounds.local",Ee.WORLD="bounds.world";const{RESIZE:vo,INNER:wo,LOCAL:xo,WORLD:Rr}=Ee,bo={};[vo,wo,xo,Rr].forEach(e=>bo[e]=1);class Xe extends _e{get bigger(){if(!this.old)return!0;const{width:t,height:i}=this.old;return this.width>=t&&this.height>=i}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,i){W(t)?(super(Xe.RESIZE),Object.assign(this,t)):super(t),this.old=i}static isResizing(t){return this.resizingKeys&&!P(this.resizingKeys[t.innerId])}}Xe.RESIZE="resize";class ze extends _e{constructor(t,i){super(t),this.data=i}}ze.REQUEST="watch.request",ze.DATA="watch.data";class rt extends _e{constructor(t,i,s){super(t),i&&(this.data=i,this.times=s)}}rt.REQUEST="layout.request",rt.START="layout.start",rt.BEFORE="layout.before",rt.LAYOUT="layout",rt.AFTER="layout.after",rt.AGAIN="layout.again",rt.END="layout.end";class K extends _e{constructor(t,i,s,r){super(t),i&&(this.times=i),s&&(this.renderBounds=s,this.renderOptions=r)}}K.REQUEST="render.request",K.CHILD_START="render.child_start",K.CHILD_END="render.child_end",K.START="render.start",K.BEFORE="render.before",K.RENDER="render",K.AFTER="render.after",K.AGAIN="render.again",K.END="render.end",K.NEXT="render.next";class j extends _e{}j.START="leafer.start",j.BEFORE_READY="leafer.before_ready",j.READY="leafer.ready",j.AFTER_READY="leafer.after_ready",j.VIEW_READY="leafer.view_ready",j.VIEW_COMPLETED="leafer.view_completed",j.STOP="leafer.stop",j.RESTART="leafer.restart",j.END="leafer.end",j.UPDATE_MODE="leafer.update_mode",j.TRANSFORM="leafer.transform",j.MOVE="leafer.move",j.SCALE="leafer.scale",j.ROTATE="leafer.rotate",j.SKEW="leafer.skew";const{MOVE:eh,SCALE:ih,ROTATE:C_,SKEW:sh}=j,L_={x:eh,y:eh,scaleX:ih,scaleY:ih,rotation:C_,skewX:sh,skewY:sh},rh={};class md{set event(t){this.on(t)}on(t,i,s){if(!i){let u;if(Q(t))t.forEach(l=>this.on(l[0],l[1],l[2]));else for(let l in t)Q(u=t[l])?this.on(l,u[0],u[1]):this.on(l,u);return}let r,n,o;s&&(s==="once"?n=!0:typeof s=="boolean"?r=s:(r=s.capture,n=s.once));const a=Bn(this,r,!0),h=J(t)?t.split(" "):t,d=n?{listener:i,once:n}:{listener:i};h.forEach(u=>{u&&(o=a[u],o?o.findIndex(l=>l.listener===i)===-1&&o.push(d):a[u]=[d],bo[u]&&Ee.checkHas(this,u,"on"))})}off(t,i,s){if(t){const r=J(t)?t.split(" "):t;if(i){let n,o,a;s&&(n=typeof s=="boolean"?s:s!=="once"&&s.capture);const h=Bn(this,n);r.forEach(d=>{d&&(o=h[d],o&&(a=o.findIndex(u=>u.listener===i),a>-1&&o.splice(a,1),o.length||delete h[d],bo[d]&&Ee.checkHas(this,d,"off")))})}else{const{__bubbleMap:n,__captureMap:o}=this;r.forEach(a=>{n&&delete n[a],o&&delete o[a]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,i,s,r){return i?this.on(t,s?i=i.bind(s):i,r):Q(t)&&t.forEach(n=>this.on(n[0],n[2]?n[1]=n[1].bind(n[2]):n[1],n[3])),{type:t,current:this,listener:i,options:r}}off_(t){if(!t)return;const i=Q(t)?t:[t];i.forEach(s=>{s&&(s.listener?s.current.off(s.type,s.listener,s.options):Q(s.type)&&s.type.forEach(r=>s.current.off(r[0],r[1],r[3])))}),i.length=0}once(t,i,s,r){if(!i)return Q(t)&&t.forEach(n=>this.once(n[0],n[1],n[2],n[3]));W(s)?i=i.bind(s):r=s,this.on(t,i,{once:!0,capture:r})}emit(t,i,s){!i&&zi.has(t)&&(i=zi.get(t,{type:t,target:this,current:this}));const r=Bn(this,s)[t];if(r){let n;for(let o=0,a=r.length;o<a&&!((n=r[o])&&(n.listener(i),n.once&&(this.off(t,n.listener,s),o--,a--),i&&i.isStopNow));o++);}this.syncEventer&&this.syncEventer.emitEvent(i,s)}emitEvent(t,i){t.current=this,this.emit(t.type,t,i)}hasEvent(t,i){if(this.syncEventer&&this.syncEventer.hasEvent(t,i))return!0;const{__bubbleMap:s,__captureMap:r}=this,n=s&&s[t],o=r&&r[t];return!!(P(i)?n||o:i?o:n)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function Bn(e,t,i){if(t){const{__captureMap:s}=e;return s||(i?e.__captureMap={}:rh)}{const{__bubbleMap:s}=e;return s||(i?e.__bubbleMap={}:rh)}}const{on:O_,on_:A_,off:D_,off_:M_,once:$_,emit:F_,emitEvent:I_,hasEvent:W_,destroy:N_}=md.prototype,Yo={on:O_,on_:A_,off:D_,off_:M_,once:$_,emit:F_,emitEvent:I_,hasEvent:W_,destroyEventer:N_},z_=et.get("setAttr"),Y_={__setAttr(e,t,i){if(this.leaferIsCreated){const s=this.__.__getInput(e);if(!i||co(t)||P(t)||(z_.warn(this.innerName,e,t),t=void 0),W(t)||s!==t){if(this.__realSetAttr(e,t),this.isLeafer){this.emitEvent(new Pe(Pe.LEAFER_CHANGE,this,e,s,t));const n=L_[e];n&&(this.emitEvent(new j(n,this)),this.emitEvent(new j(j.TRANSFORM,this)))}this.emitPropertyEvent(Pe.CHANGE,e,s,t);const r=R_[e];return r&&this.emitPropertyEvent(r,e,s,t),!0}return!1}return this.__realSetAttr(e,t),!0},emitPropertyEvent(e,t,i,s){const r=new Pe(e,this,t,i,s);this.isLeafer||this.hasEvent(e)&&this.emitEvent(r),this.leafer.emitEvent(r)},__realSetAttr(e,t){const i=this.__;i[e]=t,this.__proxyData&&this.setProxyAttr(e,t),i.normalStyle&&(this.lockNormalStyle||P(i.normalStyle[e])||(i.normalStyle[e]=t))},__getAttr(e){return this.__proxyData?this.getProxyAttr(e):this.__.__get(e)}},{setLayout:X_,multiplyParent:j_,translateInner:nh,defaultWorld:U_}=C,{toPoint:H_,tempPoint:Pn}=ci,V_={__updateWorldMatrix(){const{parent:e,__layout:t,__world:i,__scrollWorld:s,__:r}=this;j_(this.__local||t,e?e.__scrollWorld||e.__world:U_,i,!!t.affectScaleOrRotation,r),s&&nh(Object.assign(s,i),r.scrollX,r.scrollY)},__updateLocalMatrix(){if(this.__local){const e=this.__layout,t=this.__local,i=this.__;e.affectScaleOrRotation&&(e.scaleChanged&&(e.resized||(e.resized="scale"))||e.rotationChanged)&&(X_(t,i,null,null,e.affectRotation),e.scaleChanged=e.rotationChanged=void 0),t.e=i.x+i.offsetX,t.f=i.y+i.offsetY,(i.around||i.origin)&&(H_(i.around||i.origin,e.boxBounds,Pn),nh(t,-Pn.x,-Pn.y,!i.around))}this.__layout.matrixChanged=void 0}},{updateMatrix:q_,updateAllMatrix:oh}=yt,{updateBounds:ah}=ji,{toOuterOf:Zs,copyAndSpread:hh,copy:G_}=B,{toBounds:K_}=ud,Q_={__updateWorldBounds(){const{__layout:e,__world:t}=this;Zs(e.renderBounds,t,t),e.resized&&(e.resized==="inner"&&this.__onUpdateSize(),this.__hasLocalEvent&&Ee.emitLocal(this),e.resized=void 0),this.__hasWorldEvent&&Ee.emitWorld(this)},__updateLocalBounds(){const e=this.__layout;e.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),e.resized="inner"),e.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),e.localBoxChanged=void 0,e.strokeSpread&&(e.strokeChanged=!0),e.renderSpread&&(e.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),e.boxChanged=void 0,e.strokeChanged&&(e.strokeSpread=this.__updateStrokeSpread(),e.strokeSpread?(e.strokeBounds===e.boxBounds&&e.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):e.spreadStrokeCancel(),e.strokeChanged=void 0,(e.renderSpread||e.strokeSpread!==e.strokeBoxSpread)&&(e.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),e.resized="inner"),e.renderChanged&&(e.renderSpread=this.__updateRenderSpread(),e.renderSpread?(e.renderBounds!==e.boxBounds&&e.renderBounds!==e.strokeBounds||e.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):e.spreadRenderCancel(),e.renderChanged=void 0,this.parent&&this.parent.__layout.renderChange()),e.resized||(e.resized="local"),e.boundsChanged=void 0},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),Zs(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){Zs(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){Zs(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(e,t){const i=this.__layout.boxBounds,s=this.__;s.__usePathBox?K_(s.path,i):(i.x=0,i.y=0,i.width=s.width,i.height=s.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.__extraUpdate(),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),oh(this),ah(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(oh(this),ah(this,this))):q_(this)},__updateNaturalSize(){const{__:e,__layout:t}=this;e.__naturalWidth=t.boxBounds.width,e.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(e){const t=this.__layout;hh(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(e){const t=this.__layout,{renderSpread:i}=t;I(i)&&i<=0?G_(t.renderBounds,t.strokeBounds):hh(t.renderBounds,t.boxBounds,i)}},Z_={__render(e,t){if(t.shape)return this.__renderShape(e,t);if((!t.cellList||t.cellList.has(this))&&this.__worldOpacity){const i=this.__;if(i.bright&&!t.topRendering)return t.topList.add(this);if(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),e.opacity=t.dimOpacity&&!i.dimskip?i.opacity*t.dimOpacity:i.opacity,this.__.__single){if(i.eraser==="path")return this.__renderEraser(e,t);const s=e.getSameCanvas(!0,!0);this.__draw(s,t,e),yt.copyCanvasByWorld(this,e,s,this.__nowWorld,i.__blendMode,!0),s.recycle(this.__nowWorld)}else this.__draw(e,t);et.showBounds&&et.drawBounds(this,e,t)}},__renderShape(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawShape(e,t))},__clip(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(e),e.clipUI(this))},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:lh}=jr,J_={__updateChange(){const{__layout:e}=this;e.childrenSortChanged&&(this.__updateSortChildren(),e.childrenSortChanged=!1),this.__.__checkSingle()},__render(e,t){if(this.__nowWorld=this.__getNowWorld(t),this.__worldOpacity){const i=this.__;if(i.__useDim)if(i.dim)t.dimOpacity=i.dim===!0?.2:i.dim;else{if(i.bright&&!t.topRendering)return t.topList.add(this);i.dimskip&&t.dimOpacity&&(t.dimOpacity=0)}if(i.__single&&!this.isBranchLeaf){if(i.eraser==="path")return this.__renderEraser(e,t);const s=e.getSameCanvas(!1,!0);this.__renderBranch(s,t);const r=this.__nowWorld;e.opacity=t.dimOpacity?i.opacity*t.dimOpacity:i.opacity,e.copyWorldByReset(s,r,r,i.__blendMode,!0),s.recycle(r)}else this.__renderBranch(e,t)}},__renderBranch(e,t){if(this.__hasMask)this.__renderMask(e,t);else{const{children:i}=this;for(let s=0,r=i.length;s<r;s++)lh(i[s],t)||i[s].__render(e,t)}},__clip(e,t){if(this.__worldOpacity){const{children:i}=this;for(let s=0,r=i.length;s<r;s++)lh(i[s],t)||i[s].__clip(e,t)}}},En={},{LEAF:tp,create:ep}=Re,{stintSet:dh}=Z,{toInnerPoint:ip,toOuterPoint:sp,multiplyParent:rp}=C,{toOuterOf:uh}=B,{copy:ch,move:_h}=L,{moveLocal:np,zoomOfLocal:op,rotateOfLocal:ap,skewOfLocal:hp,moveWorld:ph,zoomOfWorld:lp,rotateOfWorld:dp,skewOfWorld:up,transform:gh,transformWorld:cp,setTransform:_p,getFlipTransform:pp,getLocalOrigin:Tn,getRelativeWorld:gp,drop:fp}=yt;let Yi=class{get tag(){return this.__tag}set tag(e){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return Gl}get __LayoutProcessor(){return T_}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get scrollWorldTransform(){return this.updateLayout(),this.__scrollWorld||this.__world}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.updateLayout(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){return this.leaferIsCreated&&this.leafer.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(e){this.on(e)}constructor(e){this.innerId=ep(tp),this.reset(e),this.__bubbleMap&&this.__emitLifeEvent(_t.CREATED)}reset(e){this.leafer&&this.leafer.forceRender(this.__world),e!==0&&(this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},e!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0})),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),e&&(e.__&&(e=e.toJSON()),e.children?this.set(e):Object.assign(this,e))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(e,t){t&&(e=e.bind(t)),this.parent?e():this.on(_t.ADD,e,"once")}waitLeafer(e,t){t&&(e=e.bind(t)),this.leafer?e():this.on(_t.MOUNTED,e,"once")}nextRender(e,t,i){this.leafer?this.leafer.nextRender(e,t,i):this.waitLeafer(()=>this.leafer.nextRender(e,t,i))}removeNextRender(e){this.nextRender(e,null,"off")}__bindLeafer(e){if(this.isLeafer&&e!==null&&(e=this),this.leafer&&!e&&this.leafer.leafs--,this.leafer=e,e?(e.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(_t.MOUNTED)):this.__emitLifeEvent(_t.UNMOUNTED),this.isBranch){const{children:t}=this;for(let i=0,s=t.length;i<s;i++)t[i].__bindLeafer(e)}}set(e,t){}get(e){}setAttr(e,t){this[e]=t}getAttr(e){return this[e]}getComputedAttr(e){return this.__[e]}toJSON(e){return e&&this.__layout.update(),this.__.__getInputData(null,e)}toString(e){return JSON.stringify(this.toJSON(e))}toSVG(){}__SVG(e){}toHTML(){}__setAttr(e,t){return!0}__getAttr(e){}setProxyAttr(e,t){}getProxyAttr(e){}find(e,t){}findTag(e){}findOne(e,t){}findId(e){}focus(e){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(e){P(e)?e="width":e==="surface"&&(e="blendMode");const t=this.__.__getInput(e);this.__[e]=P(t)?null:void 0,this[e]=t}forceRender(e,t){this.forceUpdate("surface")}__extraUpdate(){this.leaferIsReady&&this.leafer.layouter.addExtra(this)}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(e,t){}__updateContentBounds(){}__updateStrokeBounds(e){}__updateRenderBounds(e){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(e){this.__hasEraser=!!e||this.children.some(t=>t.__.eraser)}__renderEraser(e,t){e.save(),this.__clip(e,t);const{renderBounds:i}=this.__layout;e.clearRect(i.x,i.y,i.width,i.height),e.restore()}__updateMask(e){this.__hasMask=this.children.some(t=>t.__.mask&&t.__.visible&&t.__.opacity)}__renderMask(e,t){}__getNowWorld(e){if(e.matrix){this.__cameraWorld||(this.__cameraWorld={});const t=this.__cameraWorld,i=this.__world;return rp(i,e.matrix,t,void 0,i),uh(this.__layout.renderBounds,t,t),dh(t,"half",i.half),dh(t,"ignorePixelSnap",i.ignorePixelSnap),t}return this.__world}getClampRenderScale(){let{scaleX:e}=this.__nowWorld||this.__world;return e<0&&(e=-e),e>1?e:1}getRenderScaleData(e,t){let{scaleX:i,scaleY:s}=Qt.patternLocked?this.__world:this.__nowWorld;return e&&(i<0&&(i=-i),s<0&&(s=-s)),(t===!0||t==="zoom-in"&&i>1&&s>1)&&(i=s=1),En.scaleX=i,En.scaleY=s,En}getTransform(e){return this.__layout.getTransform(e||"local")}getBounds(e,t){return this.__layout.getBounds(e,t)}getLayoutBounds(e,t,i){return this.__layout.getLayoutBounds(e,t,i)}getLayoutPoints(e,t){return this.__layout.getLayoutPoints(e,t)}getWorldBounds(e,t,i){const s=t?gp(this,t):this.worldTransform,r=i?e:{};return uh(e,s,r),r}worldToLocal(e,t,i,s){this.parent?this.parent.worldToInner(e,t,i,s):t&&ch(t,e)}localToWorld(e,t,i,s){this.parent?this.parent.innerToWorld(e,t,i,s):t&&ch(t,e)}worldToInner(e,t,i,s){s&&(s.innerToWorld(e,t,i),e=t||e),ip(this.scrollWorldTransform,e,t,i)}innerToWorld(e,t,i,s){sp(this.scrollWorldTransform,e,t,i),s&&s.worldToInner(t||e,null,i)}getBoxPoint(e,t,i,s){return this.getBoxPointByInner(this.getInnerPoint(e,t,i,s),null,null,!0)}getBoxPointByInner(e,t,i,s){const r=s?e:Object.assign({},e),{x:n,y:o}=this.boxBounds;return _h(r,-n,-o),r}getInnerPoint(e,t,i,s){const r=s?e:{};return this.worldToInner(e,r,i,t),r}getInnerPointByBox(e,t,i,s){const r=s?e:Object.assign({},e),{x:n,y:o}=this.boxBounds;return _h(r,n,o),r}getInnerPointByLocal(e,t,i,s){return this.getInnerPoint(e,this.parent,i,s)}getLocalPoint(e,t,i,s){const r=s?e:{};return this.worldToLocal(e,r,i,t),r}getLocalPointByInner(e,t,i,s){return this.getWorldPoint(e,this.parent,i,s)}getPagePoint(e,t,i,s){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(e,t,i,s)}getWorldPoint(e,t,i,s){const r=s?e:{};return this.innerToWorld(e,r,i,t),r}getWorldPointByBox(e,t,i,s){return this.getWorldPoint(this.getInnerPointByBox(e,null,null,s),t,i,!0)}getWorldPointByLocal(e,t,i,s){const r=s?e:{};return this.localToWorld(e,r,i,t),r}getWorldPointByPage(e,t,i,s){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(e,t,i,s)}setTransform(e,t,i){_p(this,e,t,i)}transform(e,t,i){gh(this,e,t,i)}move(e,t,i){np(this,e,t,i)}moveInner(e,t,i){ph(this,e,t,!0,i)}scaleOf(e,t,i,s,r){op(this,Tn(this,e),t,i,s,r)}rotateOf(e,t,i){ap(this,Tn(this,e),t,i)}skewOf(e,t,i,s,r){hp(this,Tn(this,e),t,i,s,r)}transformWorld(e,t,i){cp(this,e,t,i)}moveWorld(e,t,i){ph(this,e,t,!1,i)}scaleOfWorld(e,t,i,s,r){lp(this,e,t,i,s,r)}rotateOfWorld(e,t){dp(this,e,t)}skewOfWorld(e,t,i,s,r){up(this,e,t,i,s,r)}flip(e,t){gh(this,pp(this,e),!1,t)}scaleResize(e,t=e,i){this.scaleX*=e,this.scaleY*=t}__scaleResize(e,t){}resizeWidth(e){}resizeHeight(e){}hit(e,t){return!0}__hitWorld(e,t){return!0}__hit(e,t){return!0}__hitFill(e){return!0}__hitStroke(e,t){return!0}__hitPixel(e){return!0}__drawHitPath(e){}__updateHitCanvas(){}__render(e,t){}__drawFast(e,t){}__draw(e,t,i){}__clip(e,t){}__renderShape(e,t){}__drawShape(e,t){}__updateWorldOpacity(){}__updateChange(){}__drawPath(e){}__drawRenderPath(e){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return vt.need("path")}getMotionPoint(e){return vt.need("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(e,t){}__updateSortChildren(){}add(e,t){}remove(e,t){this.parent&&this.parent.remove(this,t)}dropTo(e,t,i){fp(this,e,t,i)}on(e,t,i){}off(e,t,i){}on_(e,t,i,s){}off_(e){}once(e,t,i,s){}emit(e,t,i){}emitEvent(e,t){}hasEvent(e,t){return!1}static changeAttr(e,t,i){i?this.addAttr(e,t,i):fd(this.prototype,e,t)}static addAttr(e,t,i,s){i||(i=$),i(t,s)(this.prototype,e)}__emitLifeEvent(e){this.hasEvent(e)&&this.emitEvent(new _t(e,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(_t.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};Yi=E([jt(Y_),jt(V_),jt(Q_),jt(Yo),jt(Z_)],Yi);const{setListWithFn:Rn}=B,{sort:yp}=ji,{localBoxBounds:mp,localStrokeBounds:vp,localRenderBounds:wp,maskLocalBoxBounds:xp,maskLocalStrokeBounds:bp,maskLocalRenderBounds:Sp}=jr,kp=new et("Branch");let So=class extends Yi{__updateStrokeSpread(){const{children:e}=this;for(let t=0,i=e.length;t<i;t++)if(e[t].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:e}=this;for(let t=0,i=e.length;t<i;t++)if(e[t].__layout.renderSpread)return 1;return 0}__updateBoxBounds(e,t){Rn(t||this.__layout.boxBounds,this.children,this.__hasMask?xp:mp)}__updateStrokeBounds(e){Rn(e||this.__layout.strokeBounds,this.children,this.__hasMask?bp:vp)}__updateRenderBounds(e){Rn(e||this.__layout.renderBounds,this.children,this.__hasMask?Sp:wp)}__updateSortChildren(){let e;const{children:t}=this;if(t.length>1){for(let i=0,s=t.length;i<s;i++)t[i].__tempNumber=i,t[i].__.zIndex&&(e=!0);t.sort(yp),this.__layout.affectChildrenSort=e}}add(e,t){if(e===this||e.destroyed)return kp.warn("add self or destroyed");const i=P(t);if(!e.__){if(Q(e))return e.forEach(r=>{this.add(r,t),i||t++});e=Rs.get(e.tag,e)}e.parent&&e.parent.remove(e),e.parent=this,i?this.children.push(e):this.children.splice(t,0,e),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1);const s=e.__layout;s.boxChanged||s.boxChange(),s.matrixChanged||s.matrixChange(),e.__bubbleMap&&e.__emitLifeEvent(_t.ADD),this.leafer&&(e.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(_t.ADD,e)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...e){this.add(e)}remove(e,t){e?e.__?e.animationOut?e.__runAnimation("out",()=>this.__remove(e,t)):this.__remove(e,t):this.find(e).forEach(i=>this.remove(i,t)):P(e)&&super.remove(null,t)}removeAll(e){const{children:t}=this;t.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,t.forEach(i=>{this.__realRemoveChild(i),e&&i.destroy()}))}clear(){this.removeAll(!0)}__remove(e,t){const i=this.children.indexOf(e);i>-1&&(this.children.splice(i,1),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(e),t&&e.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(e){e.__emitLifeEvent(_t.REMOVE),e.parent=null,this.leafer&&(e.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(_t.REMOVE,e),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(e,t){const i=new _t(e,t,this);this.hasEvent(e)&&!this.isLeafer&&this.emitEvent(i),this.leafer.emitEvent(i)}};So=E([jt(J_)],So);class ht{get length(){return this.list.length}constructor(t){this.reset(),t&&(Q(t)?this.addList(t):this.add(t))}has(t){return t&&!P(this.keys[t.innerId])}indexAt(t){return this.list[t]}indexOf(t){const i=this.keys[t.innerId];return P(i)?-1:i}add(t){const{list:i,keys:s}=this;P(s[t.innerId])&&(i.push(t),s[t.innerId]=i.length-1)}addAt(t,i=0){const{keys:s}=this;if(P(s[t.innerId])){const{list:r}=this;for(let n=i,o=r.length;n<o;n++)s[r[n].innerId]++;i===0?r.unshift(t):(i>r.length&&(i=r.length),r.splice(i,0,t)),s[t.innerId]=i}}addList(t){for(let i=0;i<t.length;i++)this.add(t[i])}remove(t){const{list:i}=this;let s;for(let r=0,n=i.length;r<n;r++)P(s)?i[r].innerId===t.innerId&&(s=r,delete this.keys[t.innerId]):this.keys[i[r].innerId]=r-1;P(s)||i.splice(s,1)}sort(t){const{list:i}=this;t?i.sort((s,r)=>r.__level-s.__level):i.sort((s,r)=>s.__level-r.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new ht;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:i}=this;for(let s=0,r=t.length;s<r;s++)i[t[s].innerId]=s}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class Bp{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(Q(t)?this.addList(t):this.add(t))}has(t){return!P(this.keys[t.innerId])}without(t){return P(this.keys[t.innerId])}sort(t){const{levels:i}=this;t?i.sort((s,r)=>r-s):i.sort((s,r)=>s-r)}addList(t){t.forEach(i=>{this.add(i)})}add(t){const{keys:i,levelMap:s}=this;i[t.innerId]||(i[t.innerId]=1,s[t.__level]?s[t.__level].push(t):(s[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let i;this.levels.forEach(s=>{i=this.levelMap[s];for(let r=0,n=i.length;r<n;r++)t(i[r])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}function p(e,t,i,s){var r,n=arguments.length,o=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}function Bi(e){return it(e,t=>({set(i){this.__setAttr(t,i),i&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function es(e){return it(e,t=>({set(i){this.__setAttr(t,i),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function Pp(){return(e,t)=>{const i="_"+t;pi(e,t,{set(s){this.isLeafer&&(this[i]=s)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[i]||this:this.leafer&&this.leafer.zoomLayer}})}}const vd={},Et={hasTransparent:function(e){if(!e||e.length===7||e.length===4)return!1;if(e==="transparent")return!0;const t=e[0];if(t==="#")switch(e.length){case 5:return e[4]!=="f"&&e[4]!=="F";case 9:return e[7]!=="f"&&e[7]!=="F"||e[8]!=="f"&&e[8]!=="F"}else if((t==="r"||t==="h")&&e[3]==="a"){const i=e.lastIndexOf(",");if(i>-1)return parseFloat(e.slice(i+1))<1}return!1}},ui={number:(e,t)=>W(e)?e.type==="percent"?e.value*t:e.value:e},Ep={},F={},xt={},Cr={},Ye={},wd={apply(){vt.need("filter")}},Tp={},N={setStyleName:()=>vt.need("state"),set:()=>vt.need("state")},ne={list:{},register(e,t){ne.list[e]=t},get:e=>ne.list[e]},{parse:Rp,objectToCanvasData:Cp}=di,{stintSet:is}=Z,{hasTransparent:fh}=Et,yh={originPaint:{}},mh=et.get("UIData");let Le=class extends Gl{get scale(){const{scaleX:t,scaleY:i}=this;return t!==i?{x:t,y:i}:t}get __strokeWidth(){return this.__getRealStrokeWidth()}get __maxStrokeWidth(){const t=this;return t.__hasMultiStrokeStyle?Math.max(t.__hasMultiStrokeStyle,t.strokeWidth):t.strokeWidth}get __hasMultiPaint(){const t=this;return t.fill&&this.__useStroke||t.__isFills&&t.fill.length>1||t.__isStrokes&&t.stroke.length>1||t.__useEffect}get __clipAfterFill(){const t=this;return t.cornerRadius||t.innerShadow||t.__pathInputed}get __hasSurface(){return this.fill||this.stroke}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;const{leafer:i}=this.__leaf;i&&(i.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,mh.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,mh.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),J(t)||!t?(is(this,"__isTransparentFill",fh(t)),this.__isFills&&this.__removePaint("fill",!0),this._fill=t):W(t)&&this.__setPaint("fill",t)}setStroke(t){J(t)||!t?(is(this,"__isTransparentStroke",fh(t)),this.__isStrokes&&this.__removePaint("stroke",!0),this._stroke=t):W(t)&&this.__setPaint("stroke",t)}setPath(t){const i=J(t);i||t&&W(t[0])?(this.__setInput("path",t),this._path=i?Rp(t):Cp(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){Cn(this,"shadow",t)}setInnerShadow(t){Cn(this,"innerShadow",t)}setFilter(t){Cn(this,"filter",t)}__computePaint(){const{fill:t,stroke:i}=this.__input;t&&F.compute("fill",this.__leaf),i&&F.compute("stroke",this.__leaf),this.__needComputePaint=void 0}__getRealStrokeWidth(t){let{strokeWidth:i,strokeWidthFixed:s}=this;if(t&&(t.strokeWidth&&(i=t.strokeWidth),P(t.strokeWidthFixed)||(s=t.strokeWidthFixed)),s){const r=this.__leaf.getClampRenderScale();return r>1?i/r:i}return i}__setPaint(t,i){this.__setInput(t,i);const s=this.__leaf.__layout;s.boxChanged||s.boxChange(),Q(i)&&!i.length?this.__removePaint(t):t==="fill"?(this.__isFills=!0,this._fill||(this._fill=yh)):(this.__isStrokes=!0,this._stroke||(this._stroke=yh))}__removePaint(t,i){i&&this.__removeInput(t),xt.recycleImage(t,this),t==="fill"?(is(this,"__isAlphaPixelFill",void 0),this._fill=this.__isFills=void 0):(is(this,"__isAlphaPixelStroke",void 0),is(this,"__hasMultiStrokeStyle",void 0),this._stroke=this.__isStrokes=void 0)}};function Cn(e,t,i){e.__setInput(t,i),Q(i)?(i.some(s=>s.visible===!1)&&(i=i.filter(s=>s.visible!==!1)),i.length||(i=void 0)):i=i&&i.visible!==!1?[i]:void 0,e["_"+t]=i}let Ur=class extends Le{},xd=class extends Ur{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.__single||this.__clipAfterFill}get __clipAfterFill(){const t=this;return t.overflow!=="show"&&t.__leaf.children.length&&(t.__leaf.isOverflow||super.__clipAfterFill)}},Lp=class extends Ur{__getInputData(t,i){const s=super.__getInputData(t,i);return ie.forEach(r=>delete s[r]),s}},Op=class extends xd{},bd=class extends Le{get __usePathBox(){return this.points||this.__pathInputed}},Xo=class extends Le{get __boxStroke(){return!this.__pathInputed}},Ap=class extends Le{get __boxStroke(){return!this.__pathInputed}},Dp=class extends bd{},Mp=class extends Le{},$p=class extends Le{get __pathInputed(){return 2}},Fp=class extends Ur{};const Ip={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};let Wp=class extends Le{get __useNaturalRatio(){return!1}setFontWeight(t){J(t)?(this.__setInput("fontWeight",t),t=Ip[t]||400):this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t}setBoxStyle(t){let i=this.__leaf,s=i.__box;if(t){const{boxStyle:r}=this;if(s)for(let a in r)s[a]=void 0;else s=i.__box=Rs.get("Rect",0);const n=i.__layout,o=s.__layout;r||(s.parent=i,s.__world=i.__world,o.boxBounds=n.boxBounds),s.set(t),o.strokeChanged&&n.strokeChange()}else s&&(i.__box=s.parent=null,s.destroy());this._boxStyle=t}__getInputData(t,i){const s=super.__getInputData(t,i);return s.textEditing&&delete s.textEditing,s}},Np=class extends Xo{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){const t=super.__getData();return t.url&&delete t.fill,t}__getInputData(t,i){const s=super.__getInputData(t,i);return s.url&&delete s.fill,s}},zp=class extends Xo{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,i){const s=super.__getInputData(t,i);return s.url=this.__leaf.canvas.toDataURL("image/png"),s}};const{max:ss,add:Ln}=Nr,Yp={__updateStrokeSpread(){let e=0,t=0;const i=this.__,{strokeAlign:s,__maxStrokeWidth:r}=i,n=this.__box;if((i.stroke||i.hitStroke==="all")&&r&&s!=="inside"&&(t=e=s==="center"?r/2:r,!i.__boxStroke)){const o=i.__isLinePath?0:10*e,a=i.strokeCap==="none"?0:r;e+=Math.max(o,a)}return i.__useArrow&&(e+=5*r),n&&(e=ss(e,n.__layout.strokeSpread=n.__updateStrokeSpread()),t=Math.max(t,n.__layout.strokeBoxSpread)),this.__layout.strokeBoxSpread=t,e},__updateRenderSpread(){let e=0;const{shadow:t,innerShadow:i,blur:s,backgroundBlur:r,filter:n,renderSpread:o}=this.__,{strokeSpread:a}=this.__layout,h=this.__box;t&&(e=Ye.getShadowRenderSpread(this,t)),s&&(e=ss(e,s)),n&&(e=Ln(e,wd.getSpread(n))),o&&(e=Ln(e,o)),a&&(e=Ln(e,a));let d=e;return i&&(d=ss(d,Ye.getInnerShadowSpread(this,i))),r&&(d=ss(d,r)),this.__layout.renderShapeSpread=d,h?ss(h.__updateRenderSpread(),e):e}},{stintSet:Js}=Z,Xp={__updateChange(){const e=this.__;if(e.__useStroke){const t=e.__useStroke=!(!e.stroke||!e.strokeWidth);Js(this.__world,"half",t&&e.strokeAlign==="center"&&e.strokeWidth%2),Js(e,"__fillAfterStroke",t&&e.strokeAlign==="outside"&&e.fill&&!e.__isTransparentFill)}if(e.__useEffect){const{shadow:t,fill:i,stroke:s}=e,r=e.innerShadow||e.blur||e.backgroundBlur||e.filter;Js(e,"__isFastShadow",t&&!r&&t.length<2&&!t[0].spread&&!Ye.isTransformShadow(t[0])&&i&&!e.__isTransparentFill&&!(Q(i)&&i.length>1)&&(this.useFastShadow||!s||s&&e.strokeAlign==="inside")),e.__useEffect=!(!t&&!r)}e.__checkSingle(),Js(e,"__complex",e.__isFills||e.__isStrokes||e.cornerRadius||e.__useEffect)},__drawFast(e,t){vh(this,e,t)},__draw(e,t,i){const s=this.__;if(s.__complex){s.__needComputePaint&&s.__computePaint();const{fill:r,stroke:n,__drawAfterFill:o,__fillAfterStroke:a,__isFastShadow:h}=s;if(this.__drawRenderPath(e),s.__useEffect&&!h){const d=F.shape(this,e,t);this.__nowWorld=this.__getNowWorld(t);const{shadow:u,innerShadow:l,filter:c}=s;u&&Ye.shadow(this,e,d),a&&(s.__isStrokes?F.strokes(n,this,e,t):F.stroke(n,this,e,t)),r&&(s.__isFills?F.fills(r,this,e,t):F.fill(r,this,e,t)),o&&this.__drawAfterFill(e,t),l&&Ye.innerShadow(this,e,d),n&&!a&&(s.__isStrokes?F.strokes(n,this,e,t):F.stroke(n,this,e,t)),c&&wd.apply(c,this,this.__nowWorld,e,i,d),d.worldCanvas&&d.worldCanvas.recycle(),d.canvas.recycle()}else{if(a&&(s.__isStrokes?F.strokes(n,this,e,t):F.stroke(n,this,e,t)),h){const d=s.shadow[0],{scaleX:u,scaleY:l}=this.getRenderScaleData(!0,d.scaleFixed);e.save(),e.setWorldShadow(d.x*u,d.y*l,d.blur*u,Et.string(d.color))}r&&(s.__isFills?F.fills(r,this,e,t):F.fill(r,this,e,t)),h&&e.restore(),o&&this.__drawAfterFill(e,t),n&&!a&&(s.__isStrokes?F.strokes(n,this,e,t):F.stroke(n,this,e,t))}}else s.__pathForRender?vh(this,e,t):this.__drawFast(e,t)},__drawShape(e,t){this.__drawRenderPath(e);const i=this.__,{fill:s,stroke:r}=i;s&&!t.ignoreFill&&(i.__isAlphaPixelFill?F.fills(s,this,e,t):F.fill("#000000",this,e,t)),i.__isCanvas&&this.__drawAfterFill(e,t),r&&!t.ignoreStroke&&(i.__isAlphaPixelStroke?F.strokes(r,this,e,t):F.stroke("#000000",this,e,t))},__drawAfterFill(e,t){this.__.__clipAfterFill?(e.save(),e.clipUI(this),this.__drawContent(e,t),e.restore()):this.__drawContent(e,t)}};function vh(e,t,i){const{fill:s,stroke:r,__drawAfterFill:n,__fillAfterStroke:o}=e.__;e.__drawRenderPath(t),o&&F.stroke(r,e,t,i),s&&F.fill(s,e,t,i),n&&e.__drawAfterFill(t,i),r&&!o&&F.stroke(r,e,t,i)}const jp={__drawFast(e,t){let{x:i,y:s,width:r,height:n}=this.__layout.boxBounds;const{fill:o,stroke:a,__drawAfterFill:h}=this.__;if(o&&(e.fillStyle=o,e.fillRect(i,s,r,n)),h&&this.__drawAfterFill(e,t),a){const{strokeAlign:d,__strokeWidth:u}=this.__;if(!u)return;e.setStroke(a,u,this.__);const l=u/2;switch(d){case"center":e.strokeRect(0,0,r,n);break;case"inside":r-=u,n-=u,r<0||n<0?(e.save(),this.__clip(e,t),e.strokeRect(i+l,s+l,r,n),e.restore()):e.strokeRect(i+l,s+l,r,n);break;case"outside":e.strokeRect(i-l,s-l,r+u,n+u)}}}};var ko;let m=ko=class extends Yi{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(e){wt.assignScale(this,e)}get scale(){return this.__.scale}get isAutoWidth(){const e=this.__;return e.__autoWidth||e.autoWidth}get isAutoHeight(){const e=this.__;return e.__autoHeight||e.autoHeight}get pen(){const{path:e}=this.__;return Qi.set(this.path=e||[]),e||this.__drawPathByBox(Qi),Qi}reset(e){}set(e,t){e&&Object.assign(this,e)}get(e){return J(e)?this.__.__getInput(e):this.__.__getInputData(e)}createProxyData(){}find(e,t){return vt.need("find")}findTag(e){return this.find({tag:e})}findOne(e,t){return vt.need("find")}findId(e){return this.findOne({id:e})}getPath(e,t){this.__layout.update();let i=t?this.__.__pathForRender:this.__.path;return i||(Qi.set(i=[]),this.__drawPathByBox(Qi,!t)),e?di.toCanvasData(i,!0):i}getPathString(e,t,i){return di.stringify(this.getPath(e,t),i)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const e=this.__;!e.lazy||this.__inLazyBounds||Tp.running?e.__computePaint():e.__needComputePaint=!0}}__updateRenderPath(){const e=this.__;e.path?(e.__pathForRender=e.cornerRadius?Hc.smooth(e.path,e.cornerRadius,e.cornerSmoothing):e.path,e.__useArrow&&Ep.addArrows(this)):e.__pathForRender&&(e.__pathForRender=void 0)}__drawRenderPath(e){e.beginPath(),this.__drawPathByData(e,this.__.__pathForRender)}__drawPath(e){e.beginPath(),this.__drawPathByData(e,this.__.path,!0)}__drawPathByData(e,t,i){t?Pc.drawPathByData(e,t):this.__drawPathByBox(e,i)}__drawPathByBox(e,t){const{x:i,y:s,width:r,height:n}=this.__layout.boxBounds;if(this.__.cornerRadius&&!t){const{cornerRadius:o}=this.__;e.roundRect(i,s,r,n,I(o)?[o]:o)}else e.rect(i,s,r,n);e.closePath()}drawImagePlaceholder(e,t,i){F.fill(this.__.placeholderColor,this,t,i)}animate(e,t,i,s){return this.set(e),vt.need("animate")}killAnimate(e,t){}export(e,t){return vt.need("export")}syncExport(e,t){return vt.need("export")}clone(e){const t=Z.clone(this.toJSON());return e&&Object.assign(t,e),ko.one(t)}static one(e,t,i,s,r){return Rs.get(e.tag||this.prototype.__tag,e,t,i,s,r)}static registerUI(){Rt()(this)}static registerData(e){Tt(e)(this.prototype)}static setEditConfig(e){}static setEditOuter(e){}static setEditInner(e){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}};p([Tt(Le)],m.prototype,"__",void 0),p([Pp()],m.prototype,"zoomLayer",void 0),p([dt("")],m.prototype,"id",void 0),p([dt("")],m.prototype,"name",void 0),p([dt("")],m.prototype,"className",void 0),p([Be("pass-through")],m.prototype,"blendMode",void 0),p([r_(1)],m.prototype,"opacity",void 0),p([n_(!0)],m.prototype,"visible",void 0),p([Be(!1)],m.prototype,"locked",void 0),p([Ua(!1)],m.prototype,"dim",void 0),p([Ua(!1)],m.prototype,"dimskip",void 0),p([o_(0)],m.prototype,"zIndex",void 0),p([a_(!1)],m.prototype,"mask",void 0),p([h_(!1)],m.prototype,"eraser",void 0),p([Ks(0,!0)],m.prototype,"x",void 0),p([Ks(0,!0)],m.prototype,"y",void 0),p([$(100,!0)],m.prototype,"width",void 0),p([$(100,!0)],m.prototype,"height",void 0),p([ja(1,!0)],m.prototype,"scaleX",void 0),p([ja(1,!0)],m.prototype,"scaleY",void 0),p([mn(0,!0)],m.prototype,"rotation",void 0),p([mn(0,!0)],m.prototype,"skewX",void 0),p([mn(0,!0)],m.prototype,"skewY",void 0),p([Ks(0,!0)],m.prototype,"offsetX",void 0),p([Ks(0,!0)],m.prototype,"offsetY",void 0),p([Ya(0,!0)],m.prototype,"scrollX",void 0),p([Ya(0,!0)],m.prototype,"scrollY",void 0),p([Xa()],m.prototype,"origin",void 0),p([Xa()],m.prototype,"around",void 0),p([dt(!1)],m.prototype,"lazy",void 0),p([e_(1)],m.prototype,"pixelRatio",void 0),p([zo(0)],m.prototype,"renderSpread",void 0),p([i_()],m.prototype,"path",void 0),p([Dt()],m.prototype,"windingRule",void 0),p([Dt(!0)],m.prototype,"closed",void 0),p([$(0)],m.prototype,"padding",void 0),p([$(!1)],m.prototype,"lockRatio",void 0),p([$()],m.prototype,"widthRange",void 0),p([$()],m.prototype,"heightRange",void 0),p([dt(!1)],m.prototype,"draggable",void 0),p([dt()],m.prototype,"dragBounds",void 0),p([dt("auto")],m.prototype,"dragBoundsType",void 0),p([dt(!1)],m.prototype,"editable",void 0),p([ri(!0)],m.prototype,"hittable",void 0),p([ri("path")],m.prototype,"hitFill",void 0),p([de("path")],m.prototype,"hitStroke",void 0),p([ri(!1)],m.prototype,"hitBox",void 0),p([ri(!0)],m.prototype,"hitChildren",void 0),p([ri(!0)],m.prototype,"hitSelf",void 0),p([ri()],m.prototype,"hitRadius",void 0),p([l_("")],m.prototype,"cursor",void 0),p([Be()],m.prototype,"fill",void 0),p([de(void 0,!0)],m.prototype,"stroke",void 0),p([de("inside")],m.prototype,"strokeAlign",void 0),p([de(1,!0)],m.prototype,"strokeWidth",void 0),p([de(!1)],m.prototype,"strokeWidthFixed",void 0),p([de("none")],m.prototype,"strokeCap",void 0),p([de("miter")],m.prototype,"strokeJoin",void 0),p([de()],m.prototype,"dashPattern",void 0),p([de(0)],m.prototype,"dashOffset",void 0),p([de(10)],m.prototype,"miterLimit",void 0),p([Dt(0)],m.prototype,"cornerRadius",void 0),p([Dt()],m.prototype,"cornerSmoothing",void 0),p([Bi()],m.prototype,"shadow",void 0),p([Bi()],m.prototype,"innerShadow",void 0),p([Bi()],m.prototype,"blur",void 0),p([Bi()],m.prototype,"backgroundBlur",void 0),p([Bi()],m.prototype,"grayscale",void 0),p([Bi()],m.prototype,"filter",void 0),p([Be()],m.prototype,"placeholderColor",void 0),p([dt(100)],m.prototype,"placeholderDelay",void 0),p([dt({})],m.prototype,"data",void 0),p([ke(Yi.prototype.reset)],m.prototype,"reset",null),m=ko=p([jt(Yp),jt(Xp),Xr()],m);let se=class extends m{get __tag(){return"Group"}get isBranch(){return!0}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t,i){if(t)if(t.children){const{children:s}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t,i),s.forEach(r=>this.add(r)),t.children=s}else super.set(t,i)}toJSON(t){const i=super.toJSON(t);return this.childlessJSON||(i.children=this.children.map(s=>s.toJSON(t))),i}pick(t,i){}addAt(t,i){this.add(t,i)}addAfter(t,i){this.add(t,this.children.indexOf(i)+1)}addBefore(t,i){this.add(t,this.children.indexOf(i))}add(t,i){}addMany(...t){}remove(t,i){}removeAll(t){}clear(){}};var Lr;p([Tt(Ur)],se.prototype,"__",void 0),p([$(0)],se.prototype,"width",void 0),p([$(0)],se.prototype,"height",void 0),se=p([jt(So),Rt()],se);const Up=et.get("Leafer");let Ne=Lr=class extends se{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&ai.isComplete}get layoutLocked(){return!this.layouter.running}get view(){return this.canvas&&this.canvas.view}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds(!0)||Kl()}constructor(e,t){super(t),this.config={start:!0,hittable:!0,smooth:!0,lazySpeard:100},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=e,e&&(e.view||e.width)&&this.init(e),Lr.list.add(this)}init(e,t){if(this.canvas)return;let i;const{config:s}=this;this.__setLeafer(this),t&&(this.parentApp=t,this.__bindApp(t),i=t.running),e&&(this.parent=t,this.initType(e.type),this.parent=void 0,Z.assign(s,e));const r=this.canvas=at.canvas(s);this.__controllers.push(this.renderer=at.renderer(this,r,s),this.watcher=at.watcher(this,s),this.layouter=at.layouter(this,s)),this.isApp&&this.__setApp(),this.__checkAutoLayout(),t||(this.selector=at.selector(this),this.interaction=at.interaction(this,r,this.selector,s),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=at.hitCanvasManager()),this.canvasManager=new ed,i=s.start),this.hittable=s.hittable,this.fill=s.fill,this.canvasManager.add(r),this.__listenEvents(),i&&(this.__startTimer=setTimeout(this.start.bind(this))),ts.run(this.__initWait),this.onInit()}onInit(){}initType(e){}set(e,t){this.waitInit(()=>{super.set(e,t)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(j.RESTART):this.emitLeafer(j.START),this.__controllers.forEach(e=>e.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(e=>e.stop()),this.running=!1,this.emitLeafer(j.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(e){const t=Z.copyAttrs({},e,ie);Object.keys(t).forEach(i=>this[i]=t[i])}forceRender(e,t){const{renderer:i}=this;i&&(i.addBlock(e?new ft(e):this.canvas.bounds),this.viewReady&&(t?i.render():i.update()))}requestRender(e=!1){this.renderer&&this.renderer.update(e)}updateCursor(e){const t=this.interaction;t&&(e?t.setCursor(e):t.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(e){const{canvas:t}=this;if(!t||t.isSameSize(e))return;const i=Z.copyAttrs({},this.canvas,ie);t.resize(e),this.updateLazyBounds(),this.__onResize(new Xe(e,i))}__onResize(e){this.emitEvent(e),Z.copyAttrs(this.__,e,ie),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(e){this.selector=e.selector,this.interaction=e.interaction,this.canvasManager=e.canvasManager,this.hitCanvasManager=e.hitCanvasManager}__setLeafer(e){this.leafer=e,this.__level=1}__checkAutoLayout(){const{config:e,parentApp:t}=this;t||(e.width&&e.height||(this.autoLayout=new Vd(e)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(e,t){return this.canvas&&(ie.includes(e)?this.__changeCanvasSize(e,t):e==="fill"?this.__changeFill(t):e==="hittable"?this.parent||(this.canvas.hittable=t):e==="zIndex"?(this.canvas.zIndex=t,setTimeout(()=>this.parent&&this.parent.__updateSortChildren())):e==="mode"&&this.emit(j.UPDATE_MODE,{mode:t})),super.__setAttr(e,t)}__getAttr(e){return this.canvas&&ie.includes(e)?this.canvas[e]:super.__getAttr(e)}__changeCanvasSize(e,t){const{config:i,canvas:s}=this,r=Z.copyAttrs({},s,ie);r[e]=i[e]=t,i.width&&i.height?s.stopAutoLayout():this.__checkAutoLayout(),this.__doResize(r)}__changeFill(e){this.config.fill=e,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=e:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready=!0,this.emitLeafer(j.BEFORE_READY),this.emitLeafer(j.READY),this.emitLeafer(j.AFTER_READY),ts.run(this.__readyWait)}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(j.VIEW_READY),ts.run(this.__viewReadyWait))}__onLayoutEnd(){const{grow:e,width:t,height:i}=this.config;if(e){let{width:s,height:r,pixelRatio:n}=this;const o=e==="box"?this.worldBoxBounds:this.__world;t||(s=Math.max(1,o.x+o.width)),i||(r=Math.max(1,o.y+o.height)),this.__doResize({width:s,height:r,pixelRatio:n})}this.ready||this.__onReady()}__onNextRender(){if(this.viewReady){ts.run(this.__nextRenderWait);const{imageReady:e}=this;e&&!this.viewCompleted&&this.__checkViewCompleted(),e||(this.viewCompleted=!1,this.requestRender())}else this.requestRender()}__checkViewCompleted(e=!0){this.nextRender(()=>{this.imageReady&&(e&&this.emitLeafer(j.VIEW_COMPLETED),ts.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(e,t){t&&(e=e.bind(t)),this.__initWait||(this.__initWait=[]),this.canvas?e():this.__initWait.push(e)}waitReady(e,t){t&&(e=e.bind(t)),this.ready?e():this.__readyWait.push(e)}waitViewReady(e,t){t&&(e=e.bind(t)),this.viewReady?e():this.__viewReadyWait.push(e)}waitViewCompleted(e,t){t&&(e=e.bind(t)),this.__viewCompletedWait.push(e),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(e,t,i){t&&(e=e.bind(t));const s=this.__nextRenderWait;if(i){for(let r=0;r<s.length;r++)if(s[r]===e){s.splice(r,1);break}}else s.push(e);this.requestRender()}zoom(e,t,i,s){return vt.need("view")}getValidMove(e,t,i){return{x:e,y:t}}getValidScale(e){return e}getWorldPointByClient(e,t){return this.interaction&&this.interaction.getLocal(e,t)}getPagePointByClient(e,t){return this.getPagePoint(this.getWorldPointByClient(e,t))}getClientPointByWorld(e){const{x:t,y:i}=this.clientBounds;return{x:t+e.x,y:i+e.y}}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(e){}emitLeafer(e){this.emitEvent(new j(e,this))}__listenEvents(){const e=re.start("FirstCreate "+this.innerName);this.once([[j.START,()=>re.end(e)],[rt.START,this.updateLazyBounds,this],[K.START,this.__onCreated,this],[K.END,this.__onViewReady,this]]),this.__eventIds.push(this.on_([[ze.DATA,this.__onWatchData,this],[rt.END,this.__onLayoutEnd,this],[K.NEXT,this.__onNextRender,this]]))}__removeListenEvents(){this.off_(this.__eventIds)}destroy(e){const t=()=>{if(!this.destroyed){Lr.list.remove(this);try{this.stop(),this.emitLeafer(j.END),this.__removeListenEvents(),this.__controllers.forEach(i=>!(this.parent&&i===this.interaction)&&i.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager&&this.canvasManager.destroy()),this.canvas&&this.canvas.destroy(),this.config.view=this.parentApp=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{Qt.clearRecycled()},100)}catch(i){Up.error(i)}}};e?t():setTimeout(t)}};Ne.list=new ht,p([Tt(Lp)],Ne.prototype,"__",void 0),p([$()],Ne.prototype,"pixelRatio",void 0),p([dt("normal")],Ne.prototype,"mode",void 0),Ne=Lr=p([Rt()],Ne);let hi=class extends m{get __tag(){return"Rect"}};p([Tt(Xo)],hi.prototype,"__",void 0),hi=p([jt(jp),Xr(),Rt()],hi);const{add:wh,includes:Hp,scroll:Vp}=B,Qe=hi.prototype,qp=se.prototype;let Bt=class extends se{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(t){if(this.children.length&&!this.pathInputed){const i=this.__;if(i.__autoSide){i.__hasSurface&&this.__extraUpdate(),super.__updateBoxBounds();const{boxBounds:s}=this.__layout;i.__autoSize||(i.__autoWidth?(s.width+=s.x,s.x=0,s.height=i.height,s.y=0):(s.height+=s.y,s.y=0,s.width=i.width,s.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds()}else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t,i;if(this.children.length){const s=this.__,r=this.__layout,{renderBounds:n,boxBounds:o}=r,{overflow:a}=s,h=r.childrenRenderBounds||(r.childrenRenderBounds=Kl());super.__updateRenderBounds(h),(i=a&&a.includes("scroll"))&&(wh(h,o),Vp(h,s)),this.__updateRectRenderBounds(),t=!Hp(o,h),t&&a==="show"&&wh(n,h)}else this.__updateRectRenderBounds();Z.stintSet(this,"isOverflow",t),this.__checkScroll(i)}__updateRectRenderBounds(){}__checkScroll(t){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,i){}__renderGroup(t,i){}__render(t,i){this.__.__drawAfterFill?this.__renderRect(t,i):(this.__renderRect(t,i),this.children.length&&this.__renderGroup(t,i)),this.hasScroller&&this.scroller.__render(t,i)}__drawContent(t,i){this.__renderGroup(t,i),(this.__.__useStroke||this.__.__useEffect)&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}};p([Tt(xd)],Bt.prototype,"__",void 0),p([$(100)],Bt.prototype,"width",void 0),p([$(100)],Bt.prototype,"height",void 0),p([dt(!1)],Bt.prototype,"resizeChildren",void 0),p([zo("show")],Bt.prototype,"overflow",void 0),p([ke(Qe.__updateStrokeSpread)],Bt.prototype,"__updateStrokeSpread",null),p([ke(Qe.__updateRenderSpread)],Bt.prototype,"__updateRectRenderSpread",null),p([ke(Qe.__updateBoxBounds)],Bt.prototype,"__updateRectBoxBounds",null),p([ke(Qe.__updateStrokeBounds)],Bt.prototype,"__updateStrokeBounds",null),p([ke(Qe.__updateRenderBounds)],Bt.prototype,"__updateRectRenderBounds",null),p([ke(Qe.__updateChange)],Bt.prototype,"__updateRectChange",null),p([ke(Qe.__render)],Bt.prototype,"__renderRect",null),p([ke(qp.__render)],Bt.prototype,"__renderGroup",null),Bt=p([Xr(),Rt()],Bt);let rs=class extends Bt{get __tag(){return"Frame"}get isFrame(){return!0}};p([Tt(Op)],rs.prototype,"__",void 0),p([Be("#FFFFFF")],rs.prototype,"fill",void 0),p([zo("hide")],rs.prototype,"overflow",void 0),rs=p([Rt()],rs);const{moveTo:xh,closePath:Gp,ellipse:Pi}=_i;let Ei=class extends m{get __tag(){return"Ellipse"}__updatePath(){const{width:t,height:i,innerRadius:s,startAngle:r,endAngle:n}=this.__,o=t/2,a=i/2,h=this.__.path=[];s?r||n?(s<1&&Pi(h,o,a,o*s,a*s,0,r,n,!1),Pi(h,o,a,o,a,0,n,r,!0)):(s<1&&(Pi(h,o,a,o*s,a*s),xh(h,t,a)),Pi(h,o,a,o,a,0,360,0,!0)):r||n?(xh(h,o,a),Pi(h,o,a,o,a,0,r,n,!1)):Pi(h,o,a,o,a),Gp(h),S.ellipseToCurve&&(this.__.path=this.getPath(!0))}};p([Tt(Ap)],Ei.prototype,"__",void 0),p([Dt(0)],Ei.prototype,"innerRadius",void 0),p([Dt(0)],Ei.prototype,"startAngle",void 0),p([Dt(0)],Ei.prototype,"endAngle",void 0),Ei=p([Rt()],Ei);const{sin:Kp,cos:Qp,PI:bh}=Math,{moveTo:Zp,lineTo:Jp,closePath:tg,drawPoints:eg}=_i;let Ti=class extends m{get __tag(){return"Polygon"}__updatePath(){const t=this.__,i=t.path=[];if(t.points)eg(i,t.points,t.curve,!0);else{const{width:s,height:r,sides:n}=t,o=s/2,a=r/2;Zp(i,o,0);for(let h=1;h<n;h++)Jp(i,o+o*Kp(2*h*bh/n),a-a*Qp(2*h*bh/n));tg(i)}}};p([Tt(Dp)],Ti.prototype,"__",void 0),p([Dt(3)],Ti.prototype,"sides",void 0),p([Dt()],Ti.prototype,"points",void 0),p([Dt(0)],Ti.prototype,"curve",void 0),Ti=p([Xr(),Rt()],Ti);const{sin:ig,cos:sg,PI:Sh}=Math,{moveTo:rg,lineTo:ng,closePath:og}=_i;let ns=class extends m{get __tag(){return"Star"}__updatePath(){const{width:t,height:i,corners:s,innerRadius:r}=this.__,n=t/2,o=i/2,a=this.__.path=[];rg(a,n,0);for(let h=1;h<2*s;h++)ng(a,n+(h%2==0?n:n*r)*ig(h*Sh/s),o-(h%2==0?o:o*r)*sg(h*Sh/s));og(a)}};p([Tt(Mp)],ns.prototype,"__",void 0),p([Dt(5)],ns.prototype,"corners",void 0),p([Dt(.382)],ns.prototype,"innerRadius",void 0),ns=p([Rt()],ns);const{moveTo:ag,lineTo:hg,drawPoints:lg}=_i,{rotate:dg,getAngle:ug,getDistance:cg,defaultPoint:kh}=L;let $e=class extends m{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:i}=this.__,s=Wd();return t&&(s.x=t),i&&dg(s,i),s}set toPoint(t){this.width=cg(kh,t),this.rotation=ug(kh,t),this.height&&(this.height=0)}__updatePath(){const t=this.__,i=t.path=[];t.points?lg(i,t.points,t.curve,t.closed):(ag(i,0,0),hg(i,this.width,0))}};p([Tt(bd)],$e.prototype,"__",void 0),p([Yr("center")],$e.prototype,"strokeAlign",void 0),p([$(0)],$e.prototype,"height",void 0),p([Dt()],$e.prototype,"points",void 0),p([Dt(0)],$e.prototype,"curve",void 0),p([Dt(!1)],$e.prototype,"closed",void 0),$e=p([Rt()],$e);let tr=class extends hi{get __tag(){return"Image"}get ready(){const{image:t}=this;return t&&t.ready}get image(){const{fill:t}=this.__;return Q(t)&&t[0].image}};p([Tt(Np)],tr.prototype,"__",void 0),p([$("")],tr.prototype,"url",void 0),tr=p([Rt()],tr);let me=class extends hi{get __tag(){return"Canvas"}get context(){return this.canvas.context}get ready(){return!this.url}constructor(t){super(t),this.canvas=at.canvas(this.__),t&&t.url&&this.drawImage(t.url)}drawImage(t){new pd({url:t}).load(i=>{this.context.drawImage(i.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new oe(oe.LOADED,{image:i}))})}draw(t,i,s,r){const n=new li(t.worldTransform).invert(),o=new li;i&&o.translate(i.x,i.y),s&&(I(s)?o.scale(s):o.scale(s.x,s.y)),r&&o.rotate(r),n.multiplyParent(o),t.__render(this.canvas,{matrix:n.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(t,i){const{width:s,height:r}=this.__,{view:n}=this.canvas;t.drawImage(n,0,0,n.width,n.height,0,0,s,r)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:i,safeResize:s}=this.__;t.resize(this.__,s),t.smooth!==i&&(t.smooth=i)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=null),super.destroy()}};p([Tt(zp)],me.prototype,"__",void 0),p([es(100)],me.prototype,"width",void 0),p([es(100)],me.prototype,"height",void 0),p([es(1)],me.prototype,"pixelRatio",void 0),p([es(!0)],me.prototype,"smooth",void 0),p([dt(!1)],me.prototype,"safeResize",void 0),p([es()],me.prototype,"contextSettings",void 0),me=p([Rt()],me);const{copyAndSpread:_g,includes:pg,spread:gg,setList:fg}=B,{stintSet:On}=Z;let U=class extends m{get __tag(){return"Text"}get textDrawData(){return this.updateLayout(),this.__.__textDrawData}__updateTextDrawData(){const t=this.__,{lineHeight:i,letterSpacing:s,fontFamily:r,fontSize:n,fontWeight:o,italic:a,textCase:h,textOverflow:d,padding:u,width:l,height:c}=t;t.__lineHeight=ui.number(i,n),t.__letterSpacing=ui.number(s,n),t.__baseLine=t.__lineHeight-(t.__lineHeight-.7*n)/2,t.__font=`${a?"italic ":""}${h==="small-caps"?"small-caps ":""}${o!=="normal"?o+" ":""}${n||12}px ${r||"caption"}`,On(t,"__padding",u&&wt.fourNumber(u)),On(t,"__clipText",d!=="show"&&!t.__autoSize),On(t,"__isCharMode",l||c||t.__letterSpacing||h!=="none"),t.__textDrawData=vd.getDrawData((t.__isPlacehold=t.placeholder&&t.text==="")?t.placeholder:t.text,this.__)}__updateBoxBounds(){const t=this.__,i=this.__layout,{fontSize:s,italic:r,padding:n,__autoWidth:o,__autoHeight:a}=t;this.__updateTextDrawData();const{bounds:h}=t.__textDrawData,d=i.boxBounds;if(i.contentBounds=h,t.__lineHeight<s&&gg(h,s/2),o||a){if(d.x=o?h.x:0,d.y=a?h.y:0,d.width=o?h.width:t.width,d.height=a?h.height:t.height,n){const[u,l,c,_]=t.__padding;o&&(d.x-=_,d.width+=l+_),a&&(d.y-=u,d.height+=c+u)}this.__updateNaturalSize()}else super.__updateBoxBounds();r&&(d.width+=.16*s),Z.stintSet(this,"isOverflow",!pg(d,h)),this.isOverflow?(fg(t.__textBoxBounds={},[d,h]),i.renderChanged=!0):t.__textBoxBounds=d}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.isOverflow?1:0),t}__updateRenderBounds(){const{renderBounds:t,renderSpread:i}=this.__layout;_g(t,this.__.__textBoxBounds,i),this.__box&&(this.__box.__layout.renderBounds=t)}__updateChange(){super.__updateChange();const t=this.__box;t&&(t.__onUpdateSize(),t.__updateChange())}__drawRenderPath(t){t.font=this.__.__font}__draw(t,i,s){const r=this.__box;r&&(r.__nowWorld=this.__nowWorld,r.__draw(t,i,s)),this.textEditing&&!i.exporting||super.__draw(t,i,s)}__drawShape(t,i){i.shape&&this.__box&&this.__box.__drawShape(t,i),super.__drawShape(t,i)}destroy(){this.boxStyle&&(this.boxStyle=null),super.destroy()}};p([Tt(Wp)],U.prototype,"__",void 0),p([$(0)],U.prototype,"width",void 0),p([$(0)],U.prototype,"height",void 0),p([Be()],U.prototype,"boxStyle",void 0),p([dt(!1)],U.prototype,"resizeFontSize",void 0),p([Be("#000000")],U.prototype,"fill",void 0),p([Yr("outside")],U.prototype,"strokeAlign",void 0),p([ri("all")],U.prototype,"hitFill",void 0),p([$("")],U.prototype,"text",void 0),p([$("")],U.prototype,"placeholder",void 0),p([$("caption")],U.prototype,"fontFamily",void 0),p([$(12)],U.prototype,"fontSize",void 0),p([$("normal")],U.prototype,"fontWeight",void 0),p([$(!1)],U.prototype,"italic",void 0),p([$("none")],U.prototype,"textCase",void 0),p([$("none")],U.prototype,"textDecoration",void 0),p([$(0)],U.prototype,"letterSpacing",void 0),p([$({type:"percent",value:1.5})],U.prototype,"lineHeight",void 0),p([$(0)],U.prototype,"paraIndent",void 0),p([$(0)],U.prototype,"paraSpacing",void 0),p([$("x")],U.prototype,"writingMode",void 0),p([$("left")],U.prototype,"textAlign",void 0),p([$("top")],U.prototype,"verticalAlign",void 0),p([$(!0)],U.prototype,"autoSizeAlign",void 0),p([$("normal")],U.prototype,"textWrap",void 0),p([$("show")],U.prototype,"textOverflow",void 0),p([Be(!1)],U.prototype,"textEditing",void 0),U=p([Rt()],U);let bs=class extends m{get __tag(){return"Path"}};p([Tt($p)],bs.prototype,"__",void 0),p([Yr("center")],bs.prototype,"strokeAlign",void 0),bs=p([Rt()],bs);let er=class extends se{get __tag(){return"Pen"}setStyle(t){const i=this.pathElement=new bs(t);return this.pathStyle=t,this.__path=i.path||(i.path=[]),this.add(i),this}beginPath(){return this}moveTo(t,i){return this}lineTo(t,i){return this}bezierCurveTo(t,i,s,r,n,o){return this}quadraticCurveTo(t,i,s,r){return this}closePath(){return this}rect(t,i,s,r){return this}roundRect(t,i,s,r,n){return this}ellipse(t,i,s,r,n,o,a,h){return this}arc(t,i,s,r,n,o){return this}arcTo(t,i,s,r,n){return this}drawEllipse(t,i,s,r,n,o,a,h){return this}drawArc(t,i,s,r,n,o){return this}drawPoints(t,i,s){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}};p([Tt(Fp)],er.prototype,"__",void 0),p([(e,t)=>{pi(e,t,{get(){return this.__path}})}],er.prototype,"path",void 0),er=p([jt(dd,["set","path","paint"]),Rt()],er);function pe(e,t,i,s){var r,n=arguments.length,o=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}let Bh=class extends Ne{get __tag(){return"App"}get isApp(){return!0}constructor(t,i){super(t,i)}init(t,i){if(super.init(t,i),t){const{ground:s,tree:r,sky:n,editor:o}=t;s&&(this.ground=this.addLeafer(s)),(r||o)&&(this.tree=this.addLeafer(r||{type:t.type||"design"})),(n||o)&&(this.sky=this.addLeafer(n)),o&&at.editor(o,this)}}__setApp(){const{canvas:t}=this,{realCanvas:i,view:s}=this.config;i||s===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable()}__updateLocalBounds(){this.forEach(t=>t.updateLayout()),super.__updateLocalBounds()}start(){super.start(),this.forEach(t=>t.start())}stop(){this.forEach(t=>t.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.forEach(t=>t.unlockLayout())}lockLayout(){super.lockLayout(),this.forEach(t=>t.lockLayout())}forceRender(t,i){this.forEach(s=>s.forceRender(t,i))}addLeafer(t){const i=new Ne(t);return this.add(i),i}add(t,i){if(!t.view){if(this.realCanvas&&!this.canvas.bounds)return void setTimeout(()=>this.add(t,i),10);t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,i),P(i)||(t.canvas.childIndex=i),this.__listenChildEvents(t)}forEach(t){this.children.forEach(t)}__onCreated(){this.created=this.children.every(t=>t.created)}__onReady(){this.children.every(t=>t.ready)&&super.__onReady()}__onViewReady(){this.children.every(t=>t.viewReady)&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,i){t.context&&this.forEach(s=>i.matrix?s.__render(t,i):t.copyWorld(s.canvas,i.bounds))}__onResize(t){this.forEach(i=>i.resize(t)),super.__onResize(t)}updateLayout(){this.forEach(t=>t.updateLayout())}__getChildConfig(t){const i=Object.assign({},this.config);return i.hittable=i.realCanvas=void 0,t&&Z.assign(i,t),this.autoLayout&&Z.copyAttrs(i,this,ie),i.view=this.realCanvas?void 0:this.view,i.fill=void 0,i}__listenChildEvents(t){t.once([[rt.END,this.__onReady,this],[K.START,this.__onCreated,this],[K.END,this.__onViewReady,this]]),this.realCanvas&&this.__eventIds.push(t.on_(K.END,this.__onChildRenderEnd,this))}};Bh=pe([Rt()],Bh);const ir={},Ni={isHoldSpaceKey:()=>Ni.isHold("Space"),isHold:e=>ir[e],isHoldKeys:(e,t)=>t?e(t):void 0,setDownCode(e){ir[e]||(ir[e]=!0)},setUpCode(e){ir[e]=!1}},te={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(e){e.buttons||(e.buttons=1)},left:e=>e.buttons===1,right:e=>e.buttons===2,middle:e=>e.buttons===4};let jo=class extends _e{get spaceKey(){return Ni.isHoldSpaceKey()}get left(){return te.left(this)}get right(){return te.right(this)}get middle(){return te.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}isHoldKeys(t){return Ni.isHoldKeys(t,this)}getBoxPoint(t){return(t||this.current).getBoxPoint(this)}getInnerPoint(t){return(t||this.current).getInnerPoint(this)}getLocalPoint(t){return(t||this.current).getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(t){return this.getInnerPoint(t)}getLocal(t){return this.getLocalPoint(t)}getPage(){return this.getPagePoint()}static changeName(t,i){zi.changeName(t,i)}};const{min:Ph,max:An,abs:Eh}=Math,{float:Ft,sign:Th}=wt,{minX:Rh,maxX:Ch,minY:Lh,maxY:Oh}=B,lt=new ft,ve=new ft,Bo={limitMove(e,t){const{dragBounds:i,dragBoundsType:s}=e;i&&we.getValidMove(e.__localBoxBounds,we.getDragBounds(e),s,t,!0),we.axisMove(e,t)},limitScaleOf(e,t,i,s){const{dragBounds:r,dragBoundsType:n}=e;r&&we.getValidScaleOf(e.__localBoxBounds,we.getDragBounds(e),n,e.getLocalPointByInner(e.getInnerPointByBox(t)),i,s,!0)},axisMove(e,t){const{draggable:i}=e;i==="x"&&(t.y=0),i==="y"&&(t.x=0)},getDragBounds(e){const{dragBounds:t}=e;return t==="parent"?e.parent.boxBounds:t},isInnerMode:(e,t,i,s)=>i==="inner"||i==="auto"&&e[s]>t[s],getValidMove(e,t,i,s,r){const n=e.x+s.x,o=e.y+s.y,a=n+e.width,h=o+e.height,d=t.x+t.width,u=t.y+t.height;return r||(s=Object.assign({},s)),we.isInnerMode(e,t,i,"width")?n>t.x?s.x+=t.x-n:a<d&&(s.x+=d-a):n<t.x?s.x+=t.x-n:a>d&&(s.x+=d-a),we.isInnerMode(e,t,i,"height")?o>t.y?s.y+=t.y-o:h<u&&(s.y+=u-h):o<t.y?s.y+=t.y-o:h>u&&(s.y+=u-h),s.x=Ft(s.x),s.y=Ft(s.y),s},getValidScaleOf(e,t,i,s,r,n,o){o||(r=Object.assign({},r)),ve.set(t),lt.set(e).scaleOf(s,r.x,r.y);const a=(s.x-e.x)/e.width,h=1-a,d=(s.y-e.y)/e.height,u=1-d;let l,c,_,g,y=1,f=1;return we.isInnerMode(e,t,i,"width")?(r.x<0&&lt.scaleOf(s,y=1/r.x,1),_=Ft(lt.minX-ve.minX),g=Ft(ve.maxX-lt.maxX),l=a&&_>0?1+_/(a*lt.width):1,c=h&&g>0?1+g/(h*lt.width):1,y*=An(l,c)):(r.x<0&&((Ft(Rh(e)-Rh(t))<=0||Ft(Ch(t)-Ch(e))<=0)&&lt.scaleOf(s,y=1/r.x,1),lt.unsign()),_=Ft(ve.minX-lt.minX),g=Ft(lt.maxX-ve.maxX),l=a&&_>0?1-_/(a*lt.width):1,c=h&&g>0?1-g/(h*lt.width):1,y*=Ph(l,c)),we.isInnerMode(e,t,i,"height")?(r.y<0&&lt.scaleOf(s,1,f=1/r.y),_=Ft(lt.minY-ve.minY),g=Ft(ve.maxY-lt.maxY),l=d&&_>0?1+_/(d*lt.height):1,c=u&&g>0?1+g/(u*lt.height):1,f*=An(l,c),n&&(l=An(Eh(y),Eh(f)),y=Th(y)*l,f=Th(f)*l)):(r.y<0&&((Ft(Lh(e)-Lh(t))<=0||Ft(Oh(t)-Oh(e))<=0)&&lt.scaleOf(s,1,f=1/r.y),lt.unsign()),_=Ft(ve.minY-lt.minY),g=Ft(lt.maxY-ve.maxY),l=d&&_>0?1-_/(d*lt.height):1,c=u&&g>0?1-g/(u*lt.height):1,f*=Ph(l,c)),r.x*=co(y)?y:1,r.y*=co(f)?f:1,r}},we=Bo;let R=class extends jo{};R.POINTER="pointer",R.BEFORE_DOWN="pointer.before_down",R.BEFORE_MOVE="pointer.before_move",R.BEFORE_UP="pointer.before_up",R.DOWN="pointer.down",R.MOVE="pointer.move",R.UP="pointer.up",R.OVER="pointer.over",R.OUT="pointer.out",R.ENTER="pointer.enter",R.LEAVE="pointer.leave",R.TAP="tap",R.DOUBLE_TAP="double_tap",R.CLICK="click",R.DOUBLE_CLICK="double_click",R.LONG_PRESS="long_press",R.LONG_TAP="long_tap",R.MENU="pointer.menu",R.MENU_TAP="pointer.menu_tap",R=pe([Ce()],R);const os={};let q=class extends R{static setList(t){this.list=t instanceof ht?t:new ht(t)}static setData(t){this.data=t}static getValidMove(t,i,s,r=!0){const n=t.getLocalPoint(s,null,!0);return L.move(n,i.x-t.x,i.y-t.y),r&&this.limitMove(t,n),Bo.axisMove(t,n),n}static limitMove(t,i){Bo.limitMove(t,i)}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(os,null,!0)}getInnerMove(t,i){return t||(t=this.current),this.assignMove(i),t.getInnerPoint(os,null,!0)}getLocalMove(t,i){return t||(t=this.current),this.assignMove(i),t.getLocalPoint(os,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),i=this.getPagePoint(),s={};return B.set(s,i.x-t.x,i.y-t.y,t.x,t.y),B.unsign(s),s}assignMove(t){os.x=t?this.totalX:this.moveX,os.y=t?this.totalY:this.moveY}};q.BEFORE_DRAG="drag.before_drag",q.START="drag.start",q.DRAG="drag",q.END="drag.end",q.OVER="drag.over",q.OUT="drag.out",q.ENTER="drag.enter",q.LEAVE="drag.leave",q=pe([Ce()],q);let ks=class extends R{static setList(t){q.setList(t)}static setData(t){q.setData(t)}};ks.DROP="drop",ks=pe([Ce()],ks);let Xt=class extends q{};Xt.BEFORE_MOVE="move.before_move",Xt.START="move.start",Xt.MOVE="move",Xt.DRAG_ANIMATE="move.drag_animate",Xt.END="move.end",Xt.PULL_DOWN="move.pull_down",Xt.REACH_BOTTOM="move.reach_bottom",Xt=pe([Ce()],Xt);let Ah=class extends jo{};Ah=pe([Ce()],Ah);let Ri=class extends R{};Ri.BEFORE_ROTATE="rotate.before_rotate",Ri.START="rotate.start",Ri.ROTATE="rotate",Ri.END="rotate.end",Ri=pe([Ce()],Ri);let ee=class extends q{};ee.SWIPE="swipe",ee.LEFT="swipe.left",ee.RIGHT="swipe.right",ee.UP="swipe.up",ee.DOWN="swipe.down",ee=pe([Ce()],ee);let Ci=class extends R{};Ci.BEFORE_ZOOM="zoom.before_zoom",Ci.START="zoom.start",Ci.ZOOM="zoom",Ci.END="zoom.end",Ci=pe([Ce()],Ci);let Kt=class extends jo{};Kt.BEFORE_DOWN="key.before_down",Kt.BEFORE_UP="key.before_up",Kt.DOWN="key.down",Kt.HOLD="key.hold",Kt.UP="key.up",Kt=pe([Ce()],Kt);const ae={getDragEventData:(e,t,i)=>Object.assign(Object.assign({},i),{x:i.x,y:i.y,moveX:i.x-t.x,moveY:i.y-t.y,totalX:i.x-e.x,totalY:i.y-e.y}),getDropEventData:(e,t,i)=>Object.assign(Object.assign({},e),{list:t,data:i}),getSwipeDirection:e=>e<-45&&e>-135?ee.UP:e>45&&e<135?ee.DOWN:e<=45&&e>=-45?ee.RIGHT:ee.LEFT,getSwipeEventData:(e,t,i)=>Object.assign(Object.assign({},i),{moveX:t.moveX,moveY:t.moveY,totalX:i.x-e.x,totalY:i.y-e.y,type:yg.getSwipeDirection(L.getAngle(e,i))}),getBase(e){const t=e.button===1?4:e.button;return{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,time:Date.now(),buttons:P(e.buttons)?1:e.buttons===0?t:e.buttons,origin:e}},pathHasEventType(e,t){const{list:i}=e;for(let s=0,r=i.length;s<r;s++)if(i[s].hasEvent(t))return!0;return!1},filterPathByEventType(e,t){const i=new ht,{list:s}=e;for(let r=0,n=s.length;r<n;r++)s[r].hasEvent(t)&&i.add(s[r]);return i},pathCanDrag:e=>e&&e.list.some(t=>yt.draggable(t)||!t.isLeafer&&t.hasEvent(q.DRAG)),pathHasOutside:e=>e&&e.list.some(t=>t.isOutside)},yg=ae,Dh=new ht,{getDragEventData:Dn,getDropEventData:mg,getSwipeEventData:vg}=ae;let wg=class{constructor(t){this.dragDataList=[],this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=Dn(t,t,t),this.canAnimate=this.canDragOut=!0}getList(t,i){const{proxy:s}=this.interaction.selector,r=s&&s.list.length,n=q.list||this.draggableList||Dh;return this.dragging&&(r?t?Dh:new ht(i?[...s.list,...s.dragHoverExclude]:s.list):n)}checkDrag(t,i){const{interaction:s}=this;if(this.moving&&t.buttons<1)return this.canAnimate=!1,void s.pointerCancel();!this.moving&&i&&(this.moving=s.canMove(this.downData)||s.isHoldRightKey||s.isMobileDragEmpty)&&(this.dragData.moveType="drag",s.emit(Xt.START,this.dragData)),this.moving||this.dragStart(t,i),this.drag(t)}dragStart(t,i){this.dragging||(this.dragging=i&&te.left(t),this.dragging&&(this.interaction.emit(q.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(i=>this.dragStartPoints[i.innerId]={x:i.x,y:i.y})}getDraggableList(t){let i;for(let s=0,r=t.length;s<r;s++)if(i=t.list[s],yt.draggable(i)){this.draggableList=new ht(i);break}}drag(t){const{interaction:i,dragData:s,downData:r}=this,{path:n,throughPath:o}=r;this.dragData=Dn(r,s,t),o&&(this.dragData.throughPath=o),this.dragData.path=n,this.dragDataList.push(this.dragData),this.moving?(t.moving=!0,this.dragData.moveType="drag",i.emit(Xt.BEFORE_MOVE,this.dragData),i.emit(Xt.MOVE,this.dragData)):this.dragging&&(t.dragging=!0,this.dragReal(),i.emit(q.BEFORE_DRAG,this.dragData),i.emit(q.DRAG,this.dragData))}dragReal(t){const{interaction:i}=this,{running:s}=i,r=this.realDraggableList;if(r.length&&s){const{totalX:n,totalY:o}=this.dragData,{dragLimitAnimate:a}=i.p,h=!a||!!t;r.forEach(d=>{if(d.draggable){const u=J(d.draggable),l=q.getValidMove(d,this.dragStartPoints[d.innerId],{x:n,y:o},h||u);a&&!u&&t?yt.animateMove(d,l,I(a)?a:.3):d.move(l)}})}}dragOverOrOut(t){const{interaction:i}=this,{dragOverPath:s}=this,{path:r}=t;this.dragOverPath=r,s?r.indexAt(0)!==s.indexAt(0)&&(i.emit(q.OUT,t,s),i.emit(q.OVER,t,r)):i.emit(q.OVER,t,r)}dragEnterOrLeave(t){const{interaction:i}=this,{dragEnterPath:s}=this,{path:r}=t;i.emit(q.LEAVE,t,s,r),i.emit(q.ENTER,t,r,s),this.dragEnterPath=r}dragEnd(t){(this.dragging||this.moving)&&(this.checkDragEndAnimate(t)||this.dragEndReal(t))}dragEndReal(t){const{interaction:i,downData:s,dragData:r}=this;t||(t=r);const{path:n,throughPath:o}=s,a=Dn(s,t,t);if(o&&(a.throughPath=o),a.path=n,this.moving&&(this.moving=!1,a.moveType="drag",i.emit(Xt.END,a)),this.dragging){const h=this.getList();this.dragging=!1,i.p.dragLimitAnimate&&this.dragReal(!0),i.emit(q.END,a),this.swipe(t,s,r,a),this.drop(t,h,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}swipe(t,i,s,r){const{interaction:n}=this;if(L.getDistance(i,t)>n.config.pointer.swipeDistance){const o=vg(i,s,r);this.interaction.emit(o.type,o)}}drop(t,i,s){const r=mg(t,i,q.data);r.path=s,this.interaction.emit(ks.DROP,r),this.interaction.emit(q.LEAVE,t,s)}dragReset(){q.list=q.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null,this.dragDataList=[]}checkDragEndAnimate(t,i){return!1}animate(t,i){}stopAnimate(){}checkDragOut(t){}autoMoveOnDragOut(t){}autoMoveCancel(){}destroy(){this.dragReset()}};const xg=et.get("emit"),bg=["move","zoom","rotate","key"];function Mh(e,t,i,s,r){if(bg.some(n=>t.startsWith(n))&&e.__.hitChildren&&!Sd(e,r)){let n;for(let o=0,a=e.children.length;o<a;o++)n=e.children[o],!i.path.has(n)&&n.__.hittable&&Po(n,t,i,s,r)}}function Po(e,t,i,s,r){if(e.destroyed)return!1;if(e.__.hitSelf&&!Sd(e,r)&&(N.updateEventStyle&&!s&&N.updateEventStyle(e,t),e.hasEvent(t,s))){i.phase=s?1:e===i.target?2:3;const n=zi.get(t,i);if(e.emitEvent(n,s),n.isStop)return!0}return!1}function Sd(e,t){return t&&t.has(e)}const Sg={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:20,y:8}},pointer:{type:"pointer",snap:!0,hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20},touch:{preventDefault:"auto"},multiTouch:{},move:{autoDistance:2},zoom:{},cursor:!0,keyEvent:!0},{pathHasEventType:Mn,pathCanDrag:kg,pathHasOutside:$h}=ae;let Bg=class{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return this.m.drag===!0||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&te.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&te.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&Ni.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(t,i,s,r){this.config=Z.clone(Sg),this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=i,this.selector=s,this.defaultPath=new ht(t),this.createTransformer(),this.dragger=new wg(this),r&&(this.config=Z.default(r,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,i){t||(t=this.hoverData),t&&(te.defaultLeft(t),this.updateDownData(t),this.checkPath(t,i),this.downTime=Date.now(),this.emit(R.BEFORE_DOWN,t),this.emit(R.DOWN,t),te.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitRightTap=te.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:i}=this;i&&te.defaultLeft(t),(this.canvas.bounds.hitPoint(t)||i)&&(this.pointerMoveReal(t),i&&this.dragger.checkDragOut(t))}pointerMoveReal(t){if(this.emit(R.BEFORE_MOVE,t,this.defaultPath),this.downData){const i=L.getDistance(this.downData,t)>this.p.dragDistance;i&&(this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(t,i)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(R.MOVE,t),this.pointerHover(t),this.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){const{downData:i}=this;if(t||(t=i),!i)return;te.defaultLeft(t),t.multiTouch=i.multiTouch,this.findPath(t);const s=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(i.path.list),this.checkPath(t),this.downData=null,this.emit(R.BEFORE_UP,t),this.emit(R.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(s)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}menu(t){this.findPath(t),this.emit(R.MENU,t),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(t)}menuTap(t){this.waitRightTap&&this.waitMenuTap&&(this.emit(R.MENU_TAP,t),this.waitRightTap=this.waitMenuTap=!1)}createTransformer(){}move(t){}zoom(t){}rotate(t){}transformEnd(){}wheel(t){}multiTouch(t,i){}keyDown(t){if(!this.config.keyEvent)return;this.emit(Kt.BEFORE_DOWN,t,this.defaultPath);const{code:i}=t;this.downKeyMap[i]||(this.downKeyMap[i]=!0,Ni.setDownCode(i),this.emit(Kt.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(Kt.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;this.emit(Kt.BEFORE_UP,t,this.defaultPath);const{code:i}=t;this.downKeyMap[i]=!1,Ni.setUpCode(i),this.emit(Kt.UP,t,this.defaultPath),this.cursor==="grab"&&this.updateCursor()}pointerHover(t){!this.canHover||this.dragging&&!this.p.dragHover||(t.path||(t.path=new ht),this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){const{path:i}=t,{overPath:s}=this;this.overPath=i,s?i.indexAt(0)!==s.indexAt(0)&&(this.emit(R.OUT,t,s),this.emit(R.OVER,t,i)):this.emit(R.OVER,t,i)}pointerEnterOrLeave(t){let{path:i}=t;this.downData&&!this.moveMode&&(i=i.clone(),this.downData.path.forEach(r=>i.add(r)));const{enterPath:s}=this;this.enterPath=i,this.emit(R.LEAVE,t,s,i),this.emit(R.ENTER,t,i,s)}touchLeave(t){t.pointerType==="touch"&&this.enterPath&&(this.emit(R.LEAVE,t),this.dragger.dragging&&this.emit(ks.LEAVE,t))}tap(t){const{pointer:i}=this.config,s=this.longTap(t);if(!i.tapMore&&s||!this.waitTap)return;i.tapMore&&this.emitTap(t);const r=Date.now()-this.downTime,n=[R.DOUBLE_TAP,R.DOUBLE_CLICK].some(o=>Mn(t.path,o));r<i.tapTime+50&&n?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{i.tapMore||(this.tapWaitCancel(),this.emitTap(t))},i.tapTime))):i.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,i){const{hitRadius:s,through:r}=this.p,{bottomList:n,target:o}=this;S.backgrounder||t.origin||o&&o.updateLayout();const a=this.selector.getByPoint(t,s,Object.assign({bottomList:n,name:t.type},i||{through:r}));return a.throughPath&&(t.throughPath=a.throughPath),t.path=a.path,a.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const i=this.target.app;return!(!i||!i.isApp)&&i.editor&&!t.path.has(i.editor)&&t.path.has(i.tree)&&!t.target.syncEventer}checkPath(t,i){(i||this.moveMode&&!$h(t.path))&&(t.path=this.defaultPath)}canMove(t){return t&&(this.moveMode||this.m.drag==="auto"&&!kg(t.path))&&!$h(t.path)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}stopDragAnimate(){this.dragger.stopAnimate()}updateDownData(t,i,s){const{downData:r}=this;!t&&r&&(t=r),t&&(this.findPath(t,i),s&&r&&t.path.addList(r.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(!1,!0),name:R.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.canHover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let i,s;const{path:r}=t;for(let n=0,o=r.length;n<o&&(i=r.list[n],s=i.syncEventer&&i.syncEventer.cursor||i.cursor,!s);n++);this.setCursor(s)}setCursor(t){this.cursor=t}getLocal(t,i){const s=this.canvas.getClientBounds(i),r={x:t.clientX-s.x,y:t.clientY-s.y},{bounds:n}=this.canvas;return r.x*=n.width/s.width,r.y*=n.height/s.height,this.p.snap&&L.round(r),r}emitTap(t){this.emit(R.TAP,t),this.emit(R.CLICK,t)}emitDoubleTap(t){this.emit(R.DOUBLE_TAP,t),this.emit(R.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){this.waitTap&&(clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0)}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(R.LONG_PRESS,t)},this.p.longPressTime)}longTap(t){let i;return this.longPressed&&(this.emit(R.LONG_TAP,t),(Mn(t.path,R.LONG_TAP)||Mn(t.path,R.LONG_PRESS))&&(i=!0)),this.longPressWaitCancel(),i}longPressWaitCancel(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressed=!1)}__onResize(){const{dragOut:t}=this.m;this.shrinkCanvasBounds=new ft(this.canvas.bounds),this.shrinkCanvasBounds.spread(-(I(t)?t:2))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Xe.RESIZE,this.__onResize,this)],t.once(j.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,i,s,r){this.running&&(function(n,o,a,h){if(!a&&!o.path)return;let d;o.type=n,a?o=Object.assign(Object.assign({},o),{path:a}):a=o.path,o.target=a.indexAt(0);try{for(let u=a.length-1;u>-1;u--){if(d=a.list[u],Po(d,n,o,!0,h))return;d.isApp&&Mh(d,n,o,!0,h)}for(let u=0,l=a.length;u<l;u++)if(d=a.list[u],d.isApp&&Mh(d,n,o,!1,h),Po(d,n,o,!1,h))return}catch(u){xg.error(u)}})(t,i,s,r)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer&&this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}},kd=class{static set(t,i){this.custom[t]=i}static get(t){return this.custom[t]}};kd.custom={};let Pg=class extends ed{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new ht,this.pixelList=new ht}getPixelType(t,i){return this.__autoClear(),this.pixelList.add(t),at.hitCanvas(i)}getPathType(t){return this.__autoClear(),this.pathList.add(t),at.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(i=>{i.__hitCanvas&&(i.__hitCanvas.destroy(),i.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}};S.getSelector=function(e){return e.leafer?e.leafer.selector:S.selector||(S.selector=at.selector())};const{toInnerRadiusPointOf:Eg,copyRadiusPoint:Fh}=L,{hitRadiusPoint:Tg,hitPoint:Rg}=B,as={},hs={},Li=Yi.prototype;Li.hit=function(e,t=0){this.updateLayout(),Fh(hs,e,t);const i=this.__world;return!!(t?Tg(i,hs):Rg(i,hs))&&(this.isBranch?S.getSelector(this).hitPoint(Object.assign({},hs),t,{target:this}):this.__hitWorld(hs))},Li.__hitWorld=function(e,t){const i=this.__;if(!i.hitSelf)return!1;const s=this.__world,r=this.__layout,n=s.width<10&&s.height<10;if(i.hitRadius&&(Fh(as,e,i.hitRadius),e=as),Eg(e,s,as),i.hitBox||n){if(B.hitRadiusPoint(r.boxBounds,as))return!0;if(n)return!1}return!r.hitCanvasChanged&&this.__hitCanvas||(this.__updateHitCanvas(),r.boundsChanged||(r.hitCanvasChanged=!1)),this.__hit(as,t)},Li.__hitFill=function(e){const t=this.__hitCanvas;return t&&t.hitFill(e,this.__.windingRule)},Li.__hitStroke=function(e,t){const i=this.__hitCanvas;return i&&i.hitStroke(e,t)},Li.__hitPixel=function(e){const t=this.__hitCanvas;return t&&t.hitPixel(e,this.__layout.renderBounds,t.hitScale)},Li.__drawHitPath=function(e){e&&this.__drawRenderPath(e)};const Cg=new li,Ih=m.prototype;Ih.__updateHitCanvas=function(){this.__box&&this.__box.__updateHitCanvas();const{hitCanvasManager:e}=this.leafer||this.parent&&this.parent.leafer||{};if(!e)return;const t=this.__,i=(t.__isAlphaPixelFill||t.__isCanvas)&&t.hitFill==="pixel",s=t.__isAlphaPixelStroke&&t.hitStroke==="pixel",r=i||s;this.__hitCanvas||(this.__hitCanvas=r?e.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):e.getPathType(this));const n=this.__hitCanvas;if(r){const{renderBounds:o}=this.__layout,a=S.image.hitCanvasSize,h=n.hitScale=oi.set(0,0,a,a).getFitMatrix(o).a,{x:d,y:u,width:l,height:c}=oi.set(o).scale(h);n.resize({width:l,height:c,pixelRatio:1}),n.clear(),Qt.patternLocked=!0,this.__renderShape(n,{matrix:Cg.setWith(this.__world).scaleWith(1/h).invertWith().translate(-d,-u),ignoreFill:!i,ignoreStroke:!s}),Qt.patternLocked=!1,n.resetTransform(),t.__isHitPixel=!0}else t.__isHitPixel&&(t.__isHitPixel=!1);this.__drawHitPath(n),n.setStrokeOptions(t)},Ih.__hit=function(e,t){if(this.__box&&this.__box.__hit(e))return!0;const i=this.__;if(i.__isHitPixel&&this.__hitPixel(e))return!0;const{hitFill:s}=i,r=(i.fill||i.__isCanvas)&&(s==="path"||s==="pixel"&&!(i.__isAlphaPixelFill||i.__isCanvas))||s==="all"||t;if(r&&this.__hitFill(e))return!0;const{hitStroke:n,__maxStrokeWidth:o}=i,a=i.stroke&&(n==="path"||n==="pixel"&&!i.__isAlphaPixelStroke)||n==="all";if(!r&&!a)return!1;const h=2*e.radiusX;let d=h;if(a)switch(i.strokeAlign){case"inside":if(d+=2*o,!r&&this.__hitFill(e)&&this.__hitStroke(e,d))return!0;d=h;break;case"center":d+=o;break;case"outside":if(d+=2*o,!r){if(!this.__hitFill(e)&&this.__hitStroke(e,d))return!0;d=h}}return!!d&&this.__hitStroke(e,d)};const Wh=m.prototype,Nh=hi.prototype,zh=Bt.prototype;Nh.__updateHitCanvas=zh.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill==="pixel"||this.hitStroke==="all"?Wh.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)},Nh.__hitFill=zh.__hitFill=function(e){return this.__hitCanvas?Wh.__hitFill.call(this,e):B.hitRadiusPoint(this.__layout.boxBounds,e)},U.prototype.__drawHitPath=function(e){const{__lineHeight:t,fontSize:i,__baseLine:s,__letterSpacing:r,__textDrawData:n}=this.__;e.beginPath(),r<0?this.__drawPathByBox(e):n.rows.forEach(o=>e.rect(o.x,o.y-s,o.width,t<i?i:t))},se.prototype.pick=function(e,t){return t||(t=Od),this.updateLayout(),S.getSelector(this).getByPoint(e,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this}))};const $n=rd.prototype;$n.hitFill=function(e,t){return t?this.context.isPointInPath(e.x,e.y,t):this.context.isPointInPath(e.x,e.y)},$n.hitStroke=function(e,t){return this.strokeWidth=t,this.context.isPointInStroke(e.x,e.y)},$n.hitPixel=function(e,t,i=1){let{x:s,y:r,radiusX:n,radiusY:o}=e;t&&(s-=t.x,r-=t.y),oi.set(s-n,r-o,2*n,2*o).scale(i).ceil();const{data:a}=this.context.getImageData(oi.x,oi.y,oi.width||1,oi.height||1);for(let h=0,d=a.length;h<d;h+=4)if(a[h+3]>0)return!0;return a[3]>0};var Yh;(function(e){e[e.none=1]="none",e[e.free=2]="free",e[e.mirrorAngle=3]="mirrorAngle",e[e.mirror=4]="mirror"})(Yh||(Yh={}));const Xh=et.get("LeaferCanvas");let Bd=class extends rd{set zIndex(t){const{style:i}=this.view;i.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:i,parentView:s}=this;if(i&&s){const r=s.children[t];r?(this.setAbsolute(r),s.insertBefore(i,r)):s.appendChild(r)}}init(){const{config:t}=this,i=t.view||t.canvas;i?this.__createViewFrom(i):this.__createView();const{style:s}=this.view;if(s.display||(s.display="block"),this.parentView=this.view.parentElement,this.parentView){const r=this.parentView.style;r.webkitUserSelect=r.userSelect="none",this.view.classList.add("leafer-canvas-view")}S.syncDomFont&&!this.parentView&&(s.display="none",document.body&&document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return this.view.style.pointerEvents!=="none"}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let i=J(t)?document.getElementById(t):t;if(i)if(i instanceof HTMLCanvasElement)this.view=i;else{let s=i;if(i===window||i===document){const n=document.createElement("div"),{style:o}=n;o.position="absolute",o.top=o.bottom=o.left=o.right="0px",document.body.appendChild(n),s=n}this.__createView();const r=this.view;s.hasChildNodes()&&(this.setAbsolute(r),s.style.position||(s.style.position="relative")),s.appendChild(r)}else Xh.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:i}=t;i.position="absolute",i.top=i.left="0px"}updateViewSize(){const{width:t,height:i,pixelRatio:s}=this,{style:r}=this.view;r.width=t+"px",r.height=i+"px",this.unreal||(this.view.width=Math.ceil(t*s),this.view.height=Math.ceil(i*s))}updateClientBounds(){this.view.parentElement&&(this.clientBounds=this.view.getBoundingClientRect())}startAutoLayout(t,i){if(this.resizeListener=i,t){if(this.autoBounds=t,this.resizeObserver)return;try{this.resizeObserver=new ResizeObserver(r=>{this.updateClientBounds();for(const n of r)this.checkAutoBounds(n.contentRect)});const s=this.parentView;s?(this.resizeObserver.observe(s),this.checkAutoBounds(s.getBoundingClientRect())):(this.checkAutoBounds(this.view),Xh.warn("no parent"))}catch{this.imitateResizeObserver()}this.stopListenPixelRatio()}else this.listenPixelRatio(),this.unreal&&this.updateViewSize()}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),S.requestRender(this.imitateResizeObserver.bind(this)))}listenPixelRatio(){this.windowListener||window.addEventListener("resize",this.windowListener=()=>{const t=S.devicePixelRatio;if(!this.config.pixelRatio&&this.pixelRatio!==t){const{width:i,height:s}=this;this.emitResize({width:i,height:s,pixelRatio:t})}})}stopListenPixelRatio(){this.windowListener&&(window.removeEventListener("resize",this.windowListener),this.windowListener=null)}checkAutoBounds(t){const i=this.view,{x:s,y:r,width:n,height:o}=this.autoBounds.getBoundsFrom(t),a={width:n,height:o,pixelRatio:this.config.pixelRatio?this.pixelRatio:S.devicePixelRatio};if(!this.isSameSize(a)){const{style:h}=i;h.marginLeft=s+"px",h.marginTop=r+"px",this.emitResize(a)}}stopAutoLayout(){this.autoLayout=!1,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeListener=this.resizeObserver=null}emitResize(t){const i={};Z.copyAttrs(i,this,ie),this.resize(t),this.resizeListener&&!P(this.width)&&this.resizeListener(new Xe(t,i))}unrealCanvas(){if(!this.unreal&&this.parentView){let t=this.view;t&&t.remove(),t=this.view=document.createElement("div"),this.parentView.appendChild(this.view),t.classList.add("leafer-app-view"),this.unreal=!0}}destroy(){const{view:t}=this;t&&(this.stopAutoLayout(),this.stopListenPixelRatio(),t.parentElement&&t.remove(),super.destroy())}};za(CanvasRenderingContext2D.prototype),za(Path2D.prototype);const{mineType:Fn,fileType:Lg}=Ss;function Og(e,t){S.origin={createCanvas(i,s){const r=document.createElement("canvas");return r.width=i,r.height=s,r},canvasToDataURL:(i,s,r)=>{const n=Fn(s),o=i.toDataURL(n,r);return n==="image/bmp"?o.replace("image/png;","image/bmp;"):o},canvasToBolb:(i,s,r)=>new Promise(n=>i.toBlob(n,Fn(s),r)),canvasSaveAs:(i,s,r)=>{const n=i.toDataURL(Fn(Lg(s)),r);return S.origin.download(n,s)},download:(i,s)=>new Promise(r=>{let n=document.createElement("a");n.href=i,n.download=s,document.body.appendChild(n),n.click(),document.body.removeChild(n),r()}),loadImage:i=>new Promise((s,r)=>{const n=new S.origin.Image,{crossOrigin:o}=S.image;o&&(n.setAttribute("crossOrigin",o),n.crossOrigin=o),n.onload=()=>{s(n)},n.onerror=a=>{r(a)},n.src=S.image.getRealURL(i)}),Image,PointerEvent,DragEvent},S.event={stopDefault(i){i.preventDefault()},stopNow(i){i.stopImmediatePropagation()},stop(i){i.stopPropagation()}},S.canvas=at.canvas(),S.conicGradientSupport=!!S.canvas.context.createConicGradient}Object.assign(at,{canvas:(e,t)=>new Bd(e,t),image:e=>new pd(e)}),S.name="web",S.isMobile="ontouchstart"in window,S.requestRender=function(e){window.requestAnimationFrame(e)},pi(S,"devicePixelRatio",{get:()=>devicePixelRatio});const{userAgent:sr}=navigator;sr.indexOf("Firefox")>-1?(S.conicGradientRotate90=!0,S.intWheelDeltaY=!0,S.syncDomFont=!0):(/iPhone|iPad|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent))&&(S.fullImageShadow=!0),sr.indexOf("Windows")>-1?(S.os="Windows",S.intWheelDeltaY=!0):sr.indexOf("Mac")>-1?S.os="Mac":sr.indexOf("Linux")>-1&&(S.os="Linux");class Ag{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove&&this.config.usePartLayout){const t=new ht;return this.__updatedList.list.forEach(i=>{i.leafer&&t.add(i)}),t}return this.__updatedList}constructor(t,i){this.totalTimes=0,this.config={},this.__updatedList=new ht,this.target=t,i&&(this.config=Z.default(i,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(K.REQUEST)}__onAttrChange(t){this.config.usePartLayout&&this.__updatedList.add(t.target),this.update()}__onChildEvent(t){this.config.usePartLayout&&(t.type===_t.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent))),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:i}=t;for(let s=0,r=i.length;s<r;s++)this.__pushChild(i[s])}__onRquestData(){this.target.emitEvent(new ze(ze.DATA,{updatedList:this.updatedList})),this.__updatedList=new ht,this.totalTimes++,this.changed=this.hasVisible=this.hasRemove=this.hasAdd=!1}__listenEvents(){this.__eventIds=[this.target.on_([[Pe.CHANGE,this.__onAttrChange,this],[[_t.ADD,_t.REMOVE],this.__onChildEvent,this],[ze.REQUEST,this.__onRquestData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.__updatedList=null)}}const{updateAllMatrix:Dg,updateBounds:jh,updateChange:Mg}=yt,{pushAllChildBranch:$g,pushAllParent:Uh}=ji,{worldBounds:Hh}=jr;class Vh{constructor(t){this.updatedBounds=new ft,this.beforeBounds=new ft,this.afterBounds=new ft,Q(t)&&(t=new ht(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Hh)}setAfter(){this.afterBounds.setListWithFn(this.updatedList.list,Hh),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:Fg,updateAllChange:Ig}=yt,In=et.get("Layouter");class Mr{constructor(t,i){this.totalTimes=0,this.config={usePartLayout:!0},this.__levelList=new Bp,this.target=t,i&&(this.config=Z.default(i,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(this.layouting||!this.running)return;const{target:t}=this;this.times=0;try{t.emit(rt.START),this.layoutOnce(),t.emitEvent(new rt(rt.END,this.layoutedBlocks,this.times))}catch(i){In.error(i)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){return this.layouting?In.warn("layouting"):this.times>3?In.warn("layout max times"):(this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(ze.REQUEST),this.totalTimes>1&&this.config.usePartLayout?this.partLayout():this.fullLayout(),this.layouting=!1,void(this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())))}partLayout(){var t;if(!(!((t=this.__updatedList)===null||t===void 0)&&t.length))return;const i=re.start("PartLayout"),{target:s,__updatedList:r}=this,{BEFORE:n,LAYOUT:o,AFTER:a}=rt,h=this.getBlocks(r);h.forEach(d=>d.setBefore()),s.emitEvent(new rt(n,h,this.times)),this.extraBlock=null,r.sort(),(function(d,u){let l;d.list.forEach(c=>{l=c.__layout,u.without(c)&&!l.proxyZoom&&(l.matrixChanged?(Dg(c,!0),u.add(c),c.isBranch&&$g(c,u),Uh(c,u)):l.boundsChanged&&(u.add(c),c.isBranch&&(c.__tempNumber=0),Uh(c,u)))})})(r,this.__levelList),(function(d){let u,l,c;d.sort(!0),d.levels.forEach(_=>{u=d.levelMap[_];for(let g=0,y=u.length;g<y;g++){if(l=u[g],l.isBranch&&l.__tempNumber){c=l.children;for(let f=0,w=c.length;f<w;f++)c[f].isBranch||jh(c[f])}jh(l)}})})(this.__levelList),(function(d){d.list.forEach(Mg)})(r),this.extraBlock&&h.push(this.extraBlock),h.forEach(d=>d.setAfter()),s.emitEvent(new rt(o,h,this.times)),s.emitEvent(new rt(a,h,this.times)),this.addBlocks(h),this.__levelList.reset(),this.__updatedList=null,re.end(i)}fullLayout(){const t=re.start("FullLayout"),{target:i}=this,{BEFORE:s,LAYOUT:r,AFTER:n}=rt,o=this.getBlocks(new ht(i));i.emitEvent(new rt(s,o,this.times)),Mr.fullLayout(i),o.forEach(a=>{a.setAfter()}),i.emitEvent(new rt(r,o,this.times)),i.emitEvent(new rt(n,o,this.times)),this.addBlocks(o),re.end(t)}static fullLayout(t){Fg(t,!0),t.isBranch?ji.updateBounds(t):yt.updateBounds(t),Ig(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:i,beforeBounds:s}=this.extraBlock||(this.extraBlock=new Vh([]));i.length?s.add(t.__world):s.set(t.__world),i.add(t)}}createBlock(t){return new Vh(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){this.__eventIds=[this.target.on_([[rt.REQUEST,this.layout,this],[rt.AGAIN,this.layoutAgain,this],[ze.DATA,this.__onReceiveWatchData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const Oi=et.get("Renderer");class Hr{get needFill(){return!(this.canvas.allowBackgroundColor||!this.config.fill)}constructor(t,i,s){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:120},this.frames=[],this.target=t,this.canvas=i,s&&(this.config=Z.default(s,this.config)),this.__listenEvents()}start(){this.running=!0,this.update(!1)}stop(){this.running=!1}update(t=!0){this.changed||(this.changed=t),this.requestTime||this.__requestRender()}requestLayout(){this.target.emit(rt.REQUEST)}checkRender(){if(this.running){const{target:t}=this;t.isApp&&(t.emit(K.CHILD_START,t),t.children.forEach(i=>{i.renderer.FPS=this.FPS,i.renderer.checkRender()}),t.emit(K.CHILD_END,t)),this.changed&&this.canvas.view&&this.render(),this.target.emit(K.NEXT)}}render(t){if(!this.running||!this.canvas.view)return this.update();const{target:i}=this;this.times=0,this.totalBounds=new ft,Oi.log(i.innerName,"--->");try{this.emitRender(K.START),this.renderOnce(t),this.emitRender(K.END,this.totalBounds),Qt.clearRecycled()}catch(s){this.rendering=!1,Oi.error(s)}Oi.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return Oi.warn("rendering");if(this.times>3)return Oi.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new ft,this.renderOptions={},t)this.emitRender(K.BEFORE),t();else{if(this.requestLayout(),this.ignore)return void(this.ignore=this.rendering=!1);this.emitRender(K.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(K.RENDER,this.renderBounds,this.renderOptions),this.emitRender(K.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:i}=this;i&&(this.mergeBlocks(),i.forEach(s=>{t.bounds.hit(s)&&!s.isEmpty()&&this.clipRender(s)}))}clipRender(t){const i=re.start("PartRender"),{canvas:s}=this,r=t.getIntersect(s.bounds),n=new ft(r);s.save(),r.spread(Hr.clipSpread).ceil(),s.clearWorld(r),s.clipWorld(r),this.__render(r,n),s.restore(),re.end(i)}fullRender(){const t=re.start("FullRender"),{canvas:i}=this;i.save(),i.clear(),this.__render(i.bounds),i.restore(),re.end(t)}__render(t,i){const{canvas:s,target:r}=this,n=t.includes(r.__world),o=n?{includes:n}:{bounds:t,includes:n};this.needFill&&s.fillWorld(t,this.config.fill),et.showRepaint&&et.drawRepaint(s,t),this.config.useCellRender&&(o.cellList=this.getCellList()),S.render(r,s,o),this.renderBounds=i=i||t,this.renderOptions=o,this.totalBounds.isEmpty()?this.totalBounds=i:this.totalBounds.add(i),s.updateRender(i)}getCellList(){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const i=new ft;i.setList(t),t.length=0,t.push(i)}}__requestRender(){const t=this.target;if(this.requestTime||!t)return;if(t.parentApp)return t.parentApp.requestRender(!1);this.requestTime=this.frameTime||Date.now();const i=()=>{const s=1e3/((this.frameTime=Date.now())-this.requestTime),{maxFPS:r}=this.config;if(r&&s>r)return S.requestRender(i);const{frames:n}=this;n.length>30&&n.shift(),n.push(s),this.FPS=Math.round(n.reduce((o,a)=>o+a,0)/n.length),this.requestTime=0,this.checkRender()};S.requestRender(i)}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:i,height:s}=t.old;if(!new ft(0,0,i,s).includes(this.target.__world)||this.needFill||!t.samePixelRatio)return this.addBlock(this.canvas.bounds),void this.target.forceUpdate("surface")}this.addBlock(new ft(0,0,1,1)),this.update()}}__onLayoutEnd(t){t.data&&t.data.map(i=>{let s;i.updatedList&&i.updatedList.list.some(r=>(s=!r.__world.width||!r.__world.height,s&&(r.isLeafer||Oi.tip(r.innerName,": empty"),s=!r.isBranch||r.isBranchLeaf),s)),this.addBlock(s?this.canvas.bounds:i.updatedBounds)})}emitRender(t,i,s){this.target.emitEvent(new K(t,this.times,i,s))}__listenEvents(){this.__eventIds=[this.target.on_([[K.REQUEST,this.update,this],[rt.END,this.__onLayoutEnd,this],[K.AGAIN,this.renderAgain,this],[Xe.RESIZE,this.__onResize,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.config={},this.target=this.canvas=null)}}Hr.clipSpread=10;const Wg={},{copyRadiusPoint:Ng}=L,{hitRadiusPoint:zg}=B;class Yg{constructor(t,i){this.target=t,this.selector=i}getByPoint(t,i,s){i||(i=0),s||(s={});const r=s.through||!1,n=s.ignoreHittable||!1,o=s.target||this.target;this.exclude=s.exclude||null,this.point={x:t.x,y:t.y,radiusX:i,radiusY:i},this.findList=new ht(s.findList),s.findList||this.hitBranch(o.isBranchLeaf?{children:[o]}:o);const{list:a}=this.findList,h=this.getBestMatchLeaf(a,s.bottomList,n,!!s.findList),d=n?this.getPath(h):this.getHitablePath(h);return this.clear(),r?{path:d,target:h,throughPath:a.length?this.getThroughPath(a):d}:{path:d,target:h}}hitPoint(t,i,s){return!!this.getByPoint(t,i,s).target}getBestMatchLeaf(t,i,s,r){const n=this.findList=new ht;if(t.length){let o;const{x:a,y:h}=this.point,d={x:a,y:h,radiusX:0,radiusY:0};for(let u=0,l=t.length;u<l;u++)if(o=t[u],(s||yt.worldHittable(o))&&(this.hitChild(o,d),n.length)){if(o.isBranchLeaf&&t.some(c=>c!==o&&yt.hasParent(c,o))){n.reset();break}return n.list[0]}}if(i){for(let o=0,a=i.length;o<a;o++)if(this.hitChild(i[o].target,this.point,i[o].proxy),n.length)return n.list[0]}return r?null:s?t[0]:t.find(o=>yt.worldHittable(o))}getPath(t){const i=new ht,s=[],{target:r}=this;for(;t&&(t.syncEventer&&s.push(t.syncEventer),i.add(t),(t=t.parent)!==r););return s.length&&s.forEach(n=>{for(;n&&(n.__.hittable&&i.add(n),(n=n.parent)!==r););}),r&&i.add(r),i}getHitablePath(t){const i=this.getPath(t&&t.hittable?t:null);let s,r=new ht;for(let n=i.list.length-1;n>-1&&(s=i.list[n],s.__.hittable)&&(r.addAt(s,0),s.__.hitChildren&&(!s.isLeafer||s.mode!=="draw"));n--);return r}getThroughPath(t){const i=new ht,s=[];for(let a=t.length-1;a>-1;a--)s.push(this.getPath(t[a]));let r,n,o;for(let a=0,h=s.length;a<h;a++){r=s[a],n=s[a+1];for(let d=0,u=r.length;d<u&&(o=r.list[d],!n||!n.has(o));d++)i.add(o)}return i}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,i){let s,r,n;const{point:o}=this;for(let a=t.length-1;a>-1;a--)if(s=t[a],n=s.__,n.visible&&(!i||n.mask))if(r=zg(s.__world,n.hitRadius?Ng(Wg,o,n.hitRadius):o),s.isBranch){if(r||s.__ignoreHitWorld){if(s.isBranchLeaf&&n.__clipAfterFill&&!s.__hitWorld(o,!0))continue;s.topChildren&&this.eachFind(s.topChildren,!1),this.eachFind(s.children,s.__onlyHitMask),s.isBranchLeaf&&this.hitChild(s,o)}}else r&&this.hitChild(s,o)}hitChild(t,i,s){if((!this.exclude||!this.exclude.has(t))&&t.__hitWorld(i)){const{parent:r}=t;if(r&&r.__hasMask&&!t.__.mask){let n,o=[];const{children:a}=r;for(let h=0,d=a.length;h<d;h++)if(n=a[h],n.__.mask&&o.push(n),n===t){if(o&&!o.every(u=>u.__hitWorld(i)))return;break}}this.findList.add(s||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}class Xg{constructor(t,i){this.config={},i&&(this.config=Z.default(i,this.config)),this.picker=new Yg(this.target=t,this),this.finder=at.finder&&at.finder()}getByPoint(t,i,s){const{target:r,picker:n}=this;return S.backgrounder&&r&&r.updateLayout(),n.getByPoint(t,i,s)}hitPoint(t,i,s){return this.picker.hitPoint(t,i,s)}getBy(t,i,s,r){return this.finder?this.finder.getBy(t,i,s,r):vt.need("find")}destroy(){this.picker.destroy(),this.finder&&this.finder.destroy()}}Object.assign(at,{watcher:(e,t)=>new Ag(e,t),layouter:(e,t)=>new Mr(e,t),renderer:(e,t,i)=>new Hr(e,t,i),selector:(e,t)=>new Xg(e,t)}),S.layout=Mr.fullLayout,S.render=function(e,t,i){const s=Object.assign(Object.assign({},i),{topRendering:!0});i.topList=new ht,e.__render(t,i),i.topList.length&&i.topList.forEach(r=>r.__render(t,s))};const It={convert(e,t){const i=ae.getBase(e),{x:s,y:r}=t,n=Object.assign(Object.assign({},i),{x:s,y:r,width:e.width,height:e.height,pointerType:e.pointerType,pressure:e.pressure});return n.pointerType==="pen"&&(n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist),n},convertMouse(e,t){const i=ae.getBase(e),{x:s,y:r}=t;return Object.assign(Object.assign({},i),{x:s,y:r,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(e,t){const i=It.getTouch(e),s=ae.getBase(e),{x:r,y:n}=t;return Object.assign(Object.assign({},s),{x:r,y:n,width:1,height:1,pointerType:"touch",multiTouch:e.touches.length>1,pressure:i.force})},getTouch:e=>e.targetTouches[0]||e.changedTouches[0]},qh={convert(e){const t=ae.getBase(e);return Object.assign(Object.assign({},t),{code:e.code,key:e.key})}},{pathCanDrag:jg}=ae;class Ug extends Bg{get notPointer(){const{p:t}=this;return t.type!=="pointer"||t.touch||this.useMultiTouch}get notTouch(){const{p:t}=this;return t.type==="mouse"||this.usePointer}get notMouse(){return this.usePointer||this.useTouch}__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,pointerleave:this.onPointerLeave,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:i,windowEvents:s}=this;for(let r in i)i[r]=i[r].bind(this),t.addEventListener(r,i[r]);for(let r in s)s[r]=s[r].bind(this),window.addEventListener(r,s[r])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:i}=this;for(let s in t)this.view.removeEventListener(s,t[s]),this.viewEvents={};for(let s in i)window.removeEventListener(s,i[s]),this.windowEvents={}}getTouches(t){const i=[];for(let s=0,r=t.length;s<r;s++)i.push(t[s]);return i}preventDefaultPointer(t){const{pointer:i}=this.config;i.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:i}=this.config;i.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(qh.convert(t))}onKeyUp(t){this.keyUp(qh.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(It.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),this.notPointer||(this.usePointer||(this.usePointer=!0),this.pointerDown(It.convert(t,this.getLocal(t))))}onPointerMove(t,i){if(this.notPointer||this.preventWindowPointer(t))return;this.usePointer||(this.usePointer=!0);const s=It.convert(t,this.getLocal(t,!0));i?this.pointerHover(s):this.pointerMove(s)}onPointerLeave(t){this.onPointerMove(t,!0)}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),this.notPointer||this.preventWindowPointer(t)||this.pointerUp(It.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),this.notMouse||this.pointerDown(It.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.notMouse||this.preventWindowPointer(t)||this.pointerMove(It.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),this.notMouse||this.preventWindowPointer(t)||this.pointerUp(It.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.notMouse||this.pointerCancel()}onTouchStart(t){const i=It.getTouch(t),s=this.getLocal(i,!0),{preventDefault:r}=this.config.touch;(r===!0||r==="auto"&&jg(this.findPath(s)))&&t.preventDefault(),this.multiTouchStart(t),this.notTouch||(this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0,this.pointerDown(It.convertTouch(t,s)))}onTouchMove(t){if(this.multiTouchMove(t),this.notTouch||this.preventWindowPointer(t))return;const i=It.getTouch(t);this.pointerMove(It.convertTouch(t,this.getLocal(i)))}onTouchEnd(t){if(this.multiTouchEnd(),this.notTouch||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);const i=It.getTouch(t);this.pointerUp(It.convertTouch(t,this.getLocal(i)))}onTouchCancel(){this.notTouch||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const i=this.getTouches(t.touches),s=this.getKeepTouchList(this.touches,i);s.length>1&&(this.multiTouch(ae.getBase(t),s),this.touches=i)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,i){let s;const r=[];return t.forEach(n=>{s=i.find(o=>o.identifier===n.identifier),s&&r.push({from:this.getLocal(n),to:this.getLocal(s)})}),r}getLocalTouchs(t){return t.map(i=>this.getLocal(i))}onWheel(t){this.preventDefaultWheel(t),this.wheel(Object.assign(Object.assign(Object.assign({},ae.getBase(t)),this.getLocal(t)),{deltaX:t.deltaX,deltaY:t.deltaY}))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const i=ae.getBase(t);Object.assign(i,this.getLocal(t));const s=t.scale/this.lastGestureScale,r=(t.rotation-this.lastGestureRotation)/Math.PI*180*(wt.within(this.config.wheel.rotateSpeed,0,1)/4+.1);this.zoom(Object.assign(Object.assign({},i),{scale:s*s})),this.rotate(Object.assign(Object.assign({},i),{rotation:r})),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const i=[];this.eachCursor(t,i),W(i[i.length-1])&&i.push("default"),this.canvas.view.style.cursor=i.map(s=>W(s)?`url(${s.url}) ${s.x||0} ${s.y||0}`:s).join(",")}eachCursor(t,i,s=0){if(s++,Q(t))t.forEach(r=>this.eachCursor(r,i,s));else{const r=J(t)&&kd.get(t);r&&s<2?this.eachCursor(r,i,s):i.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function ls(e,t,i){e.__.__font?F.fillText(e,t,i):e.__.windingRule?t.fill(e.__.windingRule):t.fill()}function rr(e,t,i,s,r){const n=i.__;W(e)?F.drawStrokesStyle(e,t,!1,i,s,r):(s.setStroke(e,n.__strokeWidth*t,n),s.stroke()),n.__useArrow&&F.strokeArrow(e,i,s,r)}function Eo(e,t,i,s,r){const n=i.__;W(e)?F.drawStrokesStyle(e,t,!0,i,s,r):(s.setStroke(e,n.__strokeWidth*t,n),F.drawTextStroke(i,s,r))}function Gh(e,t,i,s,r){const n=s.getSameCanvas(!0,!0);n.font=i.__.__font,Eo(e,2,i,n,r),n.blendMode=t==="outside"?"destination-out":"destination-in",F.fillText(i,n,r),n.blendMode="normal",yt.copyCanvasByWorld(i,s,n),n.recycle(i.__nowWorld)}const{getSpread:Hg,copyAndSpread:Vg,toOuterOf:qg,getOuterOf:Kh,getByMove:Gg,move:Kg,getIntersectData:Qg}=B,Qh={};let To;const{stintSet:ds}=Z,{hasTransparent:Zg}=Et;function Jg(e,t,i){if(!W(t)||t.visible===!1||t.opacity===0)return;let s;const{boxBounds:r}=i.__layout;switch(t.type){case"image":if(!t.url)return;s=xt.image(i,e,t,r,!To||!To[t.url]);break;case"linear":s=Cr.linearGradient(t,r);break;case"radial":s=Cr.radialGradient(t,r);break;case"angular":s=Cr.conicGradient(t,r);break;case"solid":const{type:n,color:o,opacity:a}=t;s={type:n,style:Et.string(o,a)};break;default:P(t.r)||(s={type:"solid",style:Et.string(t)})}if(s&&(s.originPaint=t,J(s.style)&&Zg(s.style)&&(s.isTransparent=!0),t.style)){if(t.style.strokeWidth===0)return;s.strokeStyle=t.style}return s}const tf={compute:function(e,t){const i=t.__,s=[];let r,n,o,a=i.__input[e];Q(a)||(a=[a]),To=xt.recycleImage(e,i);for(let h,d=0,u=a.length;d<u;d++)(h=Jg(e,a[d],t))&&(s.push(h),h.strokeStyle&&(o||(o=1),h.strokeStyle.strokeWidth&&(o=Math.max(o,h.strokeStyle.strokeWidth))));i["_"+e]=s.length?s:void 0,s.length?(s.every(h=>h.isTransparent)&&(s.some(h=>h.image)&&(r=!0),n=!0),e==="fill"?(ds(i,"__isAlphaPixelFill",r),ds(i,"__isTransparentFill",n)):(ds(i,"__isAlphaPixelStroke",r),ds(i,"__isTransparentStroke",n),ds(i,"__hasMultiStrokeStyle",o))):i.__removePaint(e,!1)},fill:function(e,t,i,s){i.fillStyle=e,ls(t,i,s)},fills:function(e,t,i,s){let r,n,o;for(let a=0,h=e.length;a<h;a++){if(r=e[a],n=r.originPaint,r.image){if(o?o++:o=1,xt.checkImage(r,!t.__.__font,t,i,s))continue;if(!r.style){o===1&&r.image.isPlacehold&&t.drawImagePlaceholder(r,i,s);continue}}if(i.fillStyle=r.style,r.transform||n.scaleFixed){if(i.save(),r.transform&&i.transform(r.transform),n.scaleFixed){const{scaleX:d,scaleY:u}=t.getRenderScaleData(!0);(n.scaleFixed===!0||n.scaleFixed==="zoom-in"&&d>1&&u>1)&&i.scale(1/d,1/u)}n.blendMode&&(i.blendMode=n.blendMode),ls(t,i,s),i.restore()}else n.blendMode?(i.saveBlendMode(n.blendMode),ls(t,i,s),i.restoreBlendMode()):ls(t,i,s)}},fillPathOrText:ls,fillText:function(e,t,i){const s=e.__,{rows:r,decorationY:n}=s.__textDrawData;let o;s.__isPlacehold&&s.placeholderColor&&(t.fillStyle=s.placeholderColor);for(let a=0,h=r.length;a<h;a++)o=r[a],o.text?t.fillText(o.text,o.x,o.y):o.data&&o.data.forEach(d=>{t.fillText(d.char,d.x,o.y)});if(n){const{decorationColor:a,decorationHeight:h}=s.__textDrawData;a&&(t.fillStyle=a),r.forEach(d=>n.forEach(u=>t.fillRect(d.x,d.y+u,d.width,h)))}},stroke:function(e,t,i,s){const r=t.__;if(r.__strokeWidth)if(r.__font)F.strokeText(e,t,i,s);else switch(r.strokeAlign){case"center":rr(e,1,t,i,s);break;case"inside":(function(n,o,a,h){a.save(),a.clipUI(o),rr(n,2,o,a,h),a.restore()})(e,t,i,s);break;case"outside":(function(n,o,a,h){const d=o.__;if(d.__fillAfterStroke)rr(n,2,o,a,h);else{const{renderBounds:u}=o.__layout,l=a.getSameCanvas(!0,!0);o.__drawRenderPath(l),rr(n,2,o,l,h),l.clipUI(d),l.clearWorld(u),yt.copyCanvasByWorld(o,a,l),l.recycle(o.__nowWorld)}})(e,t,i,s)}},strokes:function(e,t,i,s){F.stroke(e,t,i,s)},strokeText:function(e,t,i,s){switch(t.__.strokeAlign){case"center":Eo(e,1,t,i,s);break;case"inside":Gh(e,"inside",t,i,s);break;case"outside":t.__.__fillAfterStroke?Eo(e,2,t,i,s):Gh(e,"outside",t,i,s)}},drawTextStroke:function(e,t,i){let s,r=e.__.__textDrawData;const{rows:n,decorationY:o}=r;for(let a=0,h=n.length;a<h;a++)s=n[a],s.text?t.strokeText(s.text,s.x,s.y):s.data&&s.data.forEach(d=>{t.strokeText(d.char,d.x,s.y)});if(o){const{decorationHeight:a}=r;n.forEach(h=>o.forEach(d=>t.strokeRect(h.x,h.y+d,h.width,a)))}},drawStrokesStyle:function(e,t,i,s,r,n){let o;const a=s.__,{__hasMultiStrokeStyle:h}=a;h||r.setStroke(void 0,a.__strokeWidth*t,a);for(let d=0,u=e.length;d<u;d++)if(o=e[d],(!o.image||!xt.checkImage(o,!1,s,r,n))&&o.style){if(h){const{strokeStyle:l}=o;l?r.setStroke(o.style,a.__getRealStrokeWidth(l)*t,a,l):r.setStroke(o.style,a.__strokeWidth*t,a)}else r.strokeStyle=o.style;o.originPaint.blendMode?(r.saveBlendMode(o.originPaint.blendMode),i?F.drawTextStroke(s,r,n):r.stroke(),r.restoreBlendMode()):i?F.drawTextStroke(s,r,n):r.stroke()}},shape:function(e,t,i){const s=t.getSameCanvas(),r=t.bounds,n=e.__nowWorld,o=e.__layout,a=e.__nowWorldShapeBounds||(e.__nowWorldShapeBounds={});let h,d,u,l,c,_;qg(o.strokeSpread?(Vg(Qh,o.boxBounds,o.strokeSpread),Qh):o.boxBounds,n,a);let{scaleX:g,scaleY:y}=e.getRenderScaleData(!0);if(r.includes(a))_=s,h=c=a,d=n;else{let f;if(S.fullImageShadow)f=a;else{const b=o.renderShapeSpread?Hg(r,Nr.swapAndScale(o.renderShapeSpread,g,y)):r;f=Qg(b,a)}l=r.getFitMatrix(f);let{a:w,d:v}=l;l.a<1&&(_=t.getSameCanvas(),e.__renderShape(_,i),g*=w,y*=v),c=Kh(a,l),h=Gg(c,-l.e,-l.f),d=Kh(n,l),Kg(d,-l.e,-l.f);const x=i.matrix;x?(u=new li(l),u.multiply(x),w*=x.scaleX,v*=x.scaleY):u=l,u.withScale(w,v),i=Object.assign(Object.assign({},i),{matrix:u})}return e.__renderShape(s,i),{canvas:s,matrix:u,fitMatrix:l,bounds:h,renderBounds:d,worldCanvas:_,shapeBounds:c,scaleX:g,scaleY:y}}};let us,ef=new ft;const{isSame:sf}=B;function Zh(e,t,i,s,r,n){if(t==="fill"&&!e.__.__naturalWidth){const o=e.__;if(o.__naturalWidth=s.width/o.pixelRatio,o.__naturalHeight=s.height/o.pixelRatio,o.__autoSide)return e.forceUpdate("width"),e.__proxyData&&(e.setProxyAttr("width",o.width),e.setProxyAttr("height",o.height)),!1}return r.data||xt.createData(r,s,i,n),!0}function Jh(e,t){Uo(e,oe.LOAD,t)}function tl(e,t){Uo(e,oe.LOADED,t)}function el(e,t,i){t.error=i,e.forceUpdate("surface"),Uo(e,oe.ERROR,t)}function Uo(e,t,i){e.hasEvent(t)&&e.emitEvent(new oe(t,i))}function Wn(e,t){const{leafer:i}=e;i&&i.viewReady&&(i.renderer.ignore=t)}const{get:rf,translate:nf}=C,of=new ft,Nn={},St={};function il(e,t,i,s){const r=J(e)||s?(s?i-s*t:i%t)/((s||Math.floor(i/t))-1):e;return e==="auto"&&r<0?0:r}let cs={},zn=Ql();const{get:nr,set:af,rotateOfOuter:sl,translate:ni,scaleOfOuter:Yn,multiplyParent:hf,scale:Ro,rotate:Pd,skew:lf}=C;function rl(e,t,i,s,r,n,o,a){o&&Pd(e,o),a&&lf(e,a.x,a.y),r&&Ro(e,r,n),ni(e,t.x+i,t.y+s)}function df(e,t,i,s){return new(i||(i=Promise))(function(r,n){function o(d){try{h(s.next(d))}catch(u){n(u)}}function a(d){try{h(s.throw(d))}catch(u){n(u)}}function h(d){var u;d.done?r(d.value):(u=d.value,u instanceof i?u:new i(function(l){l(u)})).then(o,a)}h((s=s.apply(e,[])).next())})}const{get:uf,scale:cf,copy:_f}=C,{getFloorScale:nl}=wt,{abs:ol}=Math,pf={image:function(e,t,i,s,r){let n,o;const a=Qt.get(i);return us&&i===us.paint&&sf(s,us.boxBounds)?n=us.leafPaint:(n={type:i.type,image:a},a.hasAlphaPixel&&(n.isTransparent=!0),us=a.use>1?{leafPaint:n,paint:i,boxBounds:ef.set(s)}:null),(r||a.loading)&&(o={image:a,attrName:t,attrValue:i}),a.ready?(Zh(e,t,i,a,n,s),r&&(Jh(e,o),tl(e,o))):a.error?r&&el(e,o,a.error):(r&&(Wn(e,!0),Jh(e,o)),n.loadId=a.load(()=>{Wn(e,!1),e.destroyed||(Zh(e,t,i,a,n,s)&&(a.hasAlphaPixel&&(e.__layout.hitCanvasChanged=!0),e.forceUpdate("surface")),tl(e,o)),n.loadId=void 0},h=>{Wn(e,!1),el(e,o,h),n.loadId=void 0},i.lod&&a.getThumbSize(i.lod)),e.placeholderColor&&(e.placeholderDelay?setTimeout(()=>{a.ready||(a.isPlacehold=!0,e.forceUpdate("surface"))},e.placeholderDelay):a.isPlacehold=!0)),n},checkImage:function(e,t,i,s,r){const{scaleX:n,scaleY:o}=xt.getImageRenderScaleData(e,i,s,r),{image:a,data:h,originPaint:d}=e,{exporting:u}=r;return!(!h||e.patternId===n+"-"+o&&!u)&&(t&&(h.repeat?t=!1:d.changeful||S.name==="miniapp"&&Xe.isResizing(i)||u||(t=S.image.isLarge(a,n,o)||a.width*n>8096||a.height*o>8096)),t?(i.__.__isFastShadow&&(s.fillStyle=e.style||"#000",s.fill()),xt.drawImage(e,n,o,i,s,r),!0):(!e.style||d.sync||u?xt.createPattern(e,i,s,r):xt.createPatternTask(e,i,s,r),!1))},drawImage:function(e,t,i,s,r,n){const{data:o,image:a}=e,{blendMode:h}=e.originPaint,{opacity:d,transform:u}=o,l=a.getFull(o.filters),c=s.__;let _,{width:g,height:y}=a;(_=u&&!u.onlyScale||c.path||c.cornerRadius)||d||h?(r.save(),_&&r.clipUI(s),h&&(r.blendMode=h),d&&(r.opacity*=d),u&&r.transform(u),r.drawImage(l,0,0,g,y),r.restore()):(o.scaleX&&(g*=o.scaleX,y*=o.scaleY),r.drawImage(l,0,0,g,y))},getImageRenderScaleData:function(e,t,i,s){const r=t.getRenderScaleData(!0,e.originPaint.scaleFixed),{data:n}=e;if(i){const{pixelRatio:o}=i;r.scaleX*=o,r.scaleY*=o}return n&&n.scaleX&&(r.scaleX*=Math.abs(n.scaleX),r.scaleY*=Math.abs(n.scaleY)),r},recycleImage:function(e,t){const i=t["_"+e];if(Q(i)){let s,r,n,o,a;for(let h=0,d=i.length;h<d;h++)s=i[h],r=s.image,a=r&&r.url,a&&(n||(n={}),n[a]=!0,Qt.recyclePaint(s),r.loading&&(o||(o=t.__input&&t.__input[e]||[],Q(o)||(o=[o])),r.unload(i[h].loadId,!o.some(u=>u.url===a))));return n}return null},createPatternTask:function(e,t,i,s){e.patternTask||(e.patternTask=Qt.patternTasker.add(()=>df(this,void 0,void 0,function*(){xt.createPattern(e,t,i,s),t.forceUpdate("surface")}),0,()=>(e.patternTask=null,i.bounds.hit(t.__nowWorld))))},createPattern:function(e,t,i,s){let{scaleX:r,scaleY:n}=xt.getImageRenderScaleData(e,t,i,s),o=r+"-"+n;if(e.patternId!==o&&!t.destroyed&&(!S.image.isLarge(e.image,r,n)||e.data.repeat)){const{image:a,data:h}=e,{transform:d,gap:u}=h,l=xt.getPatternFixScale(e,r,n);let c,_,g,{width:y,height:f}=a;l&&(r*=l,n*=l),y*=r,f*=n,u&&(_=u.x*r/ol(h.scaleX||1),g=u.y*n/ol(h.scaleY||1)),(d||r!==1||n!==1)&&(r*=nl(y+(_||0)),n*=nl(f+(g||0)),c=uf(),d&&_f(c,d),cf(c,1/r,1/n));const w=a.getCanvas(y,f,h.opacity,h.filters,_,g,t.leafer&&t.leafer.config.smooth),v=a.getPattern(w,h.repeat||S.origin.noRepeat||"no-repeat",c,e);e.style=v,e.patternId=o}},getPatternFixScale:function(e,t,i){const{image:s}=e;let r,n=S.image.maxPatternSize,o=s.width*s.height;return s.isSVG?t>1&&(r=Math.ceil(t)/t):n>o&&(n=o),(o*=t*i)>n&&(r=Math.sqrt(n/o)),r},createData:function(e,t,i,s){e.data=xt.getPatternData(i,s,t)},getPatternData:function(e,t,i){e.padding&&(t=of.set(t).shrink(e.padding)),e.mode==="strench"&&(e.mode="stretch");const{width:s,height:r}=i,{opacity:n,mode:o,align:a,offset:h,scale:d,size:u,rotation:l,skew:c,clipSize:_,repeat:g,gap:y,filters:f}=e,w=t.width===s&&t.height===r,v={mode:o},x=a!=="center"&&(l||0)%180==90;let b,k;switch(B.set(St,0,0,x?r:s,x?s:r),o&&o!=="cover"&&o!=="fit"?((d||u)&&(wt.getScaleData(d,u,i,Nn),b=Nn.scaleX,k=Nn.scaleY),(a||y||g)&&(b&&B.scale(St,b,k,!0),a&&Jl.toPoint(a,St,t,St,!0,!0))):w&&!l||(b=k=B.getFitScale(t,St,o!=="fit"),B.put(t,i,a,b,!1,St),B.scale(St,b,k,!0)),h&&L.move(St,h),o){case"stretch":w?b&&(b=k=void 0):(b=t.width/s,k=t.height/r,xt.stretchMode(v,t,b,k));break;case"normal":case"clip":if(St.x||St.y||b||_||l||c){let A,M;_&&(A=t.width/_.width,M=t.height/_.height),xt.clipMode(v,t,St.x,St.y,b,k,l,c,A,M),A&&(b=b?b*A:A,k=k?k*M:M)}break;case"repeat":(!w||b||l||c)&&xt.repeatMode(v,t,s,r,St.x,St.y,b,k,l,c,a,e.freeTransform),g||(v.repeat="repeat");const O=W(g);(y||O)&&(v.gap=(function(A,M,tt,mt,z){let D,H;return W(A)?(D=A.x,H=A.y):D=H=A,{x:il(D,tt,z.width,M&&M.x),y:il(H,mt,z.height,M&&M.y)}})(y,O&&g,St.width,St.height,t));break;default:b&&xt.fillOrFitMode(v,t,St.x,St.y,b,k,l)}return v.transform||(t.x||t.y)&&nf(v.transform=rf(),t.x,t.y),b&&(v.scaleX=b,v.scaleY=k),n&&n<1&&(v.opacity=n),f&&(v.filters=f),g&&(v.repeat=J(g)?g==="x"?"repeat-x":"repeat-y":"repeat"),v},stretchMode:function(e,t,i,s){const r=nr(),{x:n,y:o}=t;n||o?ni(r,n,o):r.onlyScale=!0,Ro(r,i,s),e.transform=r},fillOrFitMode:function(e,t,i,s,r,n,o){const a=nr();ni(a,t.x+i,t.y+s),Ro(a,r,n),o&&sl(a,{x:t.x+t.width/2,y:t.y+t.height/2},o),e.transform=a},clipMode:function(e,t,i,s,r,n,o,a,h,d){const u=nr();rl(u,t,i,s,r,n,o,a),h&&(o||a?(af(zn),Yn(zn,t,h,d),hf(u,zn)):Yn(u,t,h,d)),e.transform=u},repeatMode:function(e,t,i,s,r,n,o,a,h,d,u,l){const c=nr();if(l)rl(c,t,r,n,o,a,h,d);else{if(h)if(u==="center")sl(c,{x:i/2,y:s/2},h);else switch(Pd(c,h),h){case 90:ni(c,s,0);break;case 180:ni(c,i,s);break;case 270:ni(c,0,i)}cs.x=t.x+r,cs.y=t.y+n,ni(c,cs.x,cs.y),o&&Yn(c,cs,o,a)}e.transform=c}},{toPoint:al}=ci,{hasTransparent:gf}=Et,Xn={},jn={};function Un(e,t,i,s){if(i){let r,n,o,a;for(let h=0,d=i.length;h<d;h++)r=i[h],J(r)?(o=h/(d-1),n=Et.string(r,s)):(o=r.offset,n=Et.string(r.color,s)),t.addColorStop(o,n),!a&&gf(n)&&(a=!0);a&&(e.isTransparent=!0)}}const{getAngle:ff,getDistance:yf}=L,{get:mf,rotateOfOuter:hl,scaleOfOuter:ll}=C,{toPoint:dl}=ci,Ze={},Hn={};function Vn(e,t,i,s,r){let n;const{width:o,height:a}=e;if(o!==a||s){const h=ff(t,i);n=mf(),r?(ll(n,t,o/a*(s||1),1),hl(n,t,h+90)):(ll(n,t,1,o/a*(s||1)),hl(n,t,h))}return n}const{getDistance:vf}=L,{toPoint:ul}=ci,xe={},qn={},wf={linearGradient:function(e,t){let{from:i,to:s,type:r,opacity:n}=e;al(i||"top",t,Xn),al(s||"bottom",t,jn);const o=S.canvas.createLinearGradient(Xn.x,Xn.y,jn.x,jn.y),a={type:r,style:o};return Un(a,o,e.stops,n),a},radialGradient:function(e,t){let{from:i,to:s,type:r,opacity:n,stretch:o}=e;dl(i||"center",t,Ze),dl(s||"bottom",t,Hn);const a=S.canvas.createRadialGradient(Ze.x,Ze.y,0,Ze.x,Ze.y,yf(Ze,Hn)),h={type:r,style:a};Un(h,a,e.stops,n);const d=Vn(t,Ze,Hn,o,!0);return d&&(h.transform=d),h},conicGradient:function(e,t){let{from:i,to:s,type:r,opacity:n,stretch:o}=e;ul(i||"center",t,xe),ul(s||"bottom",t,qn);const a=S.conicGradientSupport?S.canvas.createConicGradient(0,xe.x,xe.y):S.canvas.createRadialGradient(xe.x,xe.y,0,xe.x,xe.y,vf(xe,qn)),h={type:r,style:a};Un(h,a,e.stops,n);const d=Vn(t,xe,qn,o||1,S.conicGradientRotate90);return d&&(h.transform=d),h},getTransform:Vn},{copy:xf,move:bf,toOffsetOutBounds:Sf}=B,{max:or,abs:kf}=Math,Gn={},cl=new li,_s={};function Ed(e,t){let i,s,r,n,o=0,a=0,h=0,d=0;return t.forEach(u=>{i=u.x||0,s=u.y||0,n=1.5*(u.blur||0),r=kf(u.spread||0),o=or(o,r+n-s),a=or(a,r+n+i),h=or(h,r+n+s),d=or(d,r+n-i)}),o===a&&a===h&&h===d?o:[o,a,h,d]}function _l(e,t,i){const{shapeBounds:s}=i;let r,n;S.fullImageShadow?(xf(Gn,e.bounds),bf(Gn,t.x-s.x,t.y-s.y),r=e.bounds,n=Gn):(r=s,n=t),e.copyWorld(i.canvas,r,n)}const{toOffsetOutBounds:Bf}=B,ps={},Pf=Ed,Ef={shadow:function(e,t,i){let s,r;const{__nowWorld:n}=e,{shadow:o}=e.__,{worldCanvas:a,bounds:h,renderBounds:d,shapeBounds:u,scaleX:l,scaleY:c}=i,_=t.getSameCanvas(),g=o.length-1;Sf(h,_s,d),o.forEach((y,f)=>{let w=1;if(y.scaleFixed){const v=Math.abs(n.scaleX);v>1&&(w=1/v)}_.setWorldShadow(_s.offsetX+(y.x||0)*l*w,_s.offsetY+(y.y||0)*c*w,(y.blur||0)*l*w,Et.string(y.color)),r=Ye.getShadowTransform(e,_,i,y,_s,w),r&&_.setTransform(r),_l(_,_s,i),r&&_.resetTransform(),s=d,y.box&&(_.restore(),_.save(),a&&(_.copyWorld(_,d,n,"copy"),s=n),a?_.copyWorld(a,n,n,"destination-out"):_.copyWorld(i.canvas,u,h,"destination-out")),yt.copyCanvasByWorld(e,t,_,s,y.blendMode),g&&f<g&&_.clearWorld(s)}),_.recycle(s)},innerShadow:function(e,t,i){let s,r;const{__nowWorld:n}=e,{innerShadow:o}=e.__,{worldCanvas:a,bounds:h,renderBounds:d,shapeBounds:u,scaleX:l,scaleY:c}=i,_=t.getSameCanvas(),g=o.length-1;Bf(h,ps,d),o.forEach((y,f)=>{let w=1;if(y.scaleFixed){const v=Math.abs(n.scaleX);v>1&&(w=1/v)}_.save(),_.setWorldShadow(ps.offsetX+(y.x||0)*l*w,ps.offsetY+(y.y||0)*c*w,(y.blur||0)*l*w),r=Ye.getShadowTransform(e,_,i,y,ps,w,!0),r&&_.setTransform(r),_l(_,ps,i),_.restore(),a?(_.copyWorld(_,d,n,"copy"),_.copyWorld(a,n,n,"source-out"),s=n):(_.copyWorld(i.canvas,u,h,"source-out"),s=d),_.fillWorld(s,Et.string(y.color),"source-in"),yt.copyCanvasByWorld(e,t,_,s,y.blendMode),g&&f<g&&_.clearWorld(s)}),_.recycle(s)},blur:function(e,t,i){const{blur:s}=e.__;i.setWorldBlur(s*e.__nowWorld.a),i.copyWorldToInner(t,e.__nowWorld,e.__layout.renderBounds),i.filter="none"},backgroundBlur:function(e,t,i){},getShadowRenderSpread:Ed,getShadowTransform:function(e,t,i,s,r,n,o){if(s.spread){const a=2*s.spread*n*(o?-1:1),{width:h,height:d}=e.__layout.strokeBounds;return cl.set().scaleOfOuter({x:(r.x+r.width/2)*t.pixelRatio,y:(r.y+r.height/2)*t.pixelRatio},1+a/h,1+a/d),cl}},isTransformShadow(e){},getInnerShadowSpread:Pf},{excludeRenderBounds:pl}=jr;let Co;function ar(e,t,i,s,r,n,o,a){switch(t){case"grayscale":Co||(Co=!0,r.useGrayscaleAlpha(e.__nowWorld));case"alpha":(function(h,d,u,l,c,_){const g=h.__nowWorld;u.resetTransform(),u.opacity=1,u.useMask(l,g),_&&l.recycle(g),gl(h,d,u,1,c,_)})(e,i,s,r,o,a);break;case"opacity-path":gl(e,i,s,n,o,a);break;case"path":a&&i.restore()}}function Kn(e){return e.getSameCanvas(!1,!0)}function gl(e,t,i,s,r,n){const o=e.__nowWorld;t.resetTransform(),t.opacity=s,t.copyWorld(i,o,void 0,r),n?i.recycle(o):i.clearWorld(o)}se.prototype.__renderMask=function(e,t){let i,s,r,n,o,a;const{children:h}=this;for(let d=0,u=h.length;d<u;d++){if(i=h[d],a=i.__.mask,a){o&&(ar(this,o,e,r,s,n,void 0,!0),s=r=null),a!=="clipping"&&a!=="clipping-path"||pl(i,t)||i.__render(e,t),n=i.__.opacity,Co=!1,a==="path"||a==="clipping-path"?(n<1?(o="opacity-path",r||(r=Kn(e))):(o="path",e.save()),i.__clip(r||e,t)):(o=a==="grayscale"?"grayscale":"alpha",s||(s=Kn(e)),r||(r=Kn(e)),i.__render(s,t));continue}const l=n===1&&i.__.__blendMode;l&&ar(this,o,e,r,s,n,void 0,!1),pl(i,t)||i.__render(r||e,t),l&&ar(this,o,e,r,s,n,l,!1)}ar(this,o,e,r,s,n,void 0,!0)};const Td=`>)]}%!?,.:;'"`,Tf=Td+"_#~&*+\\=|",Rf=new RegExp([[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]].map(([e,t])=>`[\\u${e.toString(16)}-\\u${t.toString(16)}]`).join("|"));function Cs(e){const t={};return e.split("").forEach(i=>t[i]=!0),t}const Cf=Cs("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz"),Lf=Cs(`{[(<'"`),Of=Cs(Td),Af=Cs(Tf),Df=Cs("- ");var $r;(function(e){e[e.Letter=0]="Letter",e[e.Single=1]="Single",e[e.Before=2]="Before",e[e.After=3]="After",e[e.Symbol=4]="Symbol",e[e.Break=5]="Break"})($r||($r={}));const{Letter:fl,Single:Mf,Before:$f,After:Ff,Symbol:If,Break:Wf}=$r;function Nf(e){return Cf[e]?fl:Df[e]?Wf:Lf[e]?$f:Of[e]?Ff:Af[e]?If:Rf.test(e)?Mf:fl}const zf={trimRight(e){const{words:t}=e;let i,s=0,r=t.length;for(let n=r-1;n>-1&&(i=t[n].data[0],i.char===" ");n--)s++,e.width-=i.width;s&&t.splice(r-s,s)}};function Yf(e,t,i){switch(t){case"title":return i?e.toUpperCase():e;case"upper":return e.toUpperCase();case"lower":return e.toLowerCase();default:return e}}const{trimRight:Xf}=zf,{Letter:Qn,Single:gs,Before:yl,After:Zn,Symbol:jf,Break:ml}=$r;let Bs,ue,At,Wt,Jn,Zt,be,Ps,Xi,Gt,Fe,to,fs,Ii,Es,Or,Lo,$i=[];function eo(e,t){Xi&&!Ps&&(Ps=Xi),Bs.data.push({char:e,width:t}),At+=t}function Je(){Wt+=At,Bs.width=At,ue.words.push(Bs),Bs={data:[]},At=0}function ys(){Ii&&(Es.paraNumber++,ue.paraStart=!0,Ii=!1),Xi&&(ue.startCharSize=Ps,ue.endCharSize=Xi,Ps=0),ue.width=Wt,Or.width?Xf(ue):Lo&&Rd(),$i.push(ue),ue={words:[]},Wt=0}function Rd(){Wt>(Es.maxWidth||0)&&(Es.maxWidth=Wt)}const{top:hr,right:vl,bottom:wl,left:lr}=_o;function dr(e,t,i){const{bounds:s,rows:r}=e;s[t]+=i;for(let n=0;n<r.length;n++)r[n][t]+=i}const Uf={getDrawData:function(e,t){J(e)||(e=String(e));let i=0,s=0,r=t.__getInput("width")||0,n=t.__getInput("height")||0;const{__padding:o}=t;o&&(r?(i=o[lr],r-=o[vl]+o[lr],!r&&(r=.01)):t.autoSizeAlign||(i=o[lr]),n?(s=o[hr],n-=o[hr]+o[wl],!n&&(n=.01)):t.autoSizeAlign||(s=o[hr]));const a={bounds:{x:i,y:s,width:r,height:n},rows:[],paraNumber:0,font:S.canvas.font=t.__font};return(function(h,d,u){Es=h,$i=h.rows,Or=h.bounds,Lo=!Or.width&&!u.autoSizeAlign;const{__letterSpacing:l,paraIndent:c,textCase:_}=u,{canvas:g}=S,{width:y}=Or;if(u.__isCharMode){const f=u.textWrap!=="none",w=u.textWrap==="break";Ii=!0,Fe=null,Ps=be=Xi=At=Wt=0,Bs={data:[]},ue={words:[]},l&&(d=[...d]);for(let v=0,x=d.length;v<x;v++)Zt=d[v],Zt===`
`?(At&&Je(),ue.paraEnd=!0,ys(),Ii=!0):(Gt=Nf(Zt),Gt===Qn&&_!=="none"&&(Zt=Yf(Zt,_,!At)),be=g.measureText(Zt).width,l&&(l<0&&(Xi=be),be+=l),to=Gt===gs&&(Fe===gs||Fe===Qn)||Fe===gs&&Gt!==Zn,fs=!(Gt!==yl&&Gt!==gs||Fe!==jf&&Fe!==Zn),Jn=Ii&&c?y-c:y,f&&y&&Wt+At+be>Jn&&(w?(At&&Je(),Wt&&ys()):(fs||(fs=Gt===Qn&&Fe==Zn),(to||fs||Gt===ml||Gt===yl||Gt===gs||At+be>Jn)&&At&&Je(),Wt&&ys())),Zt===" "&&Ii!==!0&&Wt+At===0||(Gt===ml?(Zt===" "&&At&&Je(),eo(Zt,be),Je()):((to||fs)&&At&&Je(),eo(Zt,be))),Fe=Gt);At&&Je(),Wt&&ys(),$i.length>0&&($i[$i.length-1].paraEnd=!0)}else d.split(`
`).forEach(f=>{Es.paraNumber++,Wt=g.measureText(f).width,$i.push({x:c||0,text:f,width:Wt,paraStart:!0}),Lo&&Rd()})})(a,e,t),o&&(function(h,d,u,l,c){if(!l&&u.autoSizeAlign)switch(u.textAlign){case"left":dr(d,"x",h[lr]);break;case"right":dr(d,"x",-h[vl])}if(!c&&u.autoSizeAlign)switch(u.verticalAlign){case"top":dr(d,"y",h[hr]);break;case"bottom":dr(d,"y",-h[wl])}})(o,a,t,r,n),(function(h,d){const{rows:u,bounds:l}=h,c=u.length,{__lineHeight:_,__baseLine:g,__letterSpacing:y,__clipText:f,textAlign:w,verticalAlign:v,paraSpacing:x,autoSizeAlign:b}=d;let{x:k,y:O,width:A,height:M}=l,tt=_*c+(x?x*(h.paraNumber-1):0),mt=g;if(f&&tt>M)tt=Math.max(M,_),c>1&&(h.overflow=c);else if(M||b)switch(v){case"middle":O+=(M-tt)/2;break;case"bottom":O+=M-tt}mt+=O;let z,D,H,bt=A||b?A:h.maxWidth;for(let ut=0,Ct=c;ut<Ct;ut++){if(z=u[ut],z.x=k,z.width<A||z.width>A&&!f)switch(w){case"center":z.x+=(bt-z.width)/2;break;case"right":z.x+=bt-z.width}z.paraStart&&x&&ut>0&&(mt+=x),z.y=mt,mt+=_,h.overflow>ut&&mt>tt&&(z.isOverflow=!0,h.overflow=ut+1),D=z.x,H=z.width,y<0&&(z.width<0?(H=-z.width+d.fontSize+y,D-=H,H+=d.fontSize):H-=y),D<l.x&&(l.x=D),H>l.width&&(l.width=H),f&&A&&A<H&&(z.isOverflow=!0,h.overflow||(h.overflow=u.length))}l.y=O,l.height=tt})(a,t),t.__isCharMode&&(function(h,d,u){const{rows:l}=h,{textAlign:c,paraIndent:_,letterSpacing:g}=d,y=u&&c.includes("both"),f=y||u&&c.includes("justify"),w=f&&c.includes("letter");let v,x,b,k,O,A,M,tt,mt,z;l.forEach(D=>{D.words&&(O=_&&D.paraStart?_:0,tt=D.words.length,f&&(z=!D.paraEnd||y,x=u-D.width-O,w?k=x/(D.words.reduce((H,bt)=>H+bt.data.length,0)-1):b=tt>1?x/(tt-1):0),A=g||D.isOverflow||w?0:b?1:2,D.isOverflow&&!g&&(D.textMode=!0),A===2?(D.x+=O,(function(H){H.text="",H.words.forEach(bt=>{bt.data.forEach(ut=>{H.text+=ut.char})})})(D)):(D.x+=O,v=D.x,D.data=[],D.words.forEach((H,bt)=>{A===1?(M={char:"",x:v},v=(function(ut,Ct,je){return ut.forEach(Oe=>{je.char+=Oe.char,Ct+=Oe.width}),Ct})(H.data,v,M),(D.isOverflow||M.char!==" ")&&D.data.push(M)):v=(function(ut,Ct,je,Oe,fi){return ut.forEach(Ue=>{(Oe||Ue.char!==" ")&&(Ue.x=Ct,je.push(Ue)),Ct+=Ue.width,fi&&(Ct+=fi)}),Ct})(H.data,v,D.data,D.isOverflow,z&&k),z&&(mt=bt===tt-1,b?mt||(v+=b,D.width+=b):k&&(D.width+=k*(H.data.length-(mt?1:0))))})),D.words=null)})})(a,t,r),a.overflow&&(function(h,d,u,l){if(!l)return;const{rows:c,overflow:_}=h;let{textOverflow:g}=d;if(c.splice(_),g&&g!=="show"){let y,f;g==="hide"?g="":g==="ellipsis"&&(g="...");const w=g?S.canvas.measureText(g).width:0,v=u+l-w;(d.textWrap==="none"?c:[c[_-1]]).forEach(x=>{if(x.isOverflow&&x.data){let b=x.data.length-1;for(let k=b;k>-1&&(y=x.data[k],f=y.x+y.width,!(k===b&&f<v));k--){if(f<v&&y.char!==" "||!k){x.data.splice(k+1),x.width-=y.width;break}x.width-=y.width}x.width+=w,x.data.push({char:g,x:f}),x.textMode&&(function(k){k.text="",k.data.forEach(O=>{k.text+=O.char}),k.data=null})(x)}})}})(a,t,i,r),t.textDecoration!=="none"&&(function(h,d){let u,l=0;const{fontSize:c,textDecoration:_}=d;switch(h.decorationHeight=c/11,W(_)?(u=_.type,_.color&&(h.decorationColor=Et.string(_.color)),_.offset&&(l=Math.min(.3*c,Math.max(_.offset,.15*-c)))):u=_,u){case"under":h.decorationY=[.15*c+l];break;case"delete":h.decorationY=[.35*-c];break;case"under-delete":h.decorationY=[.15*c+l,.35*-c]}})(a,t),a}},Hf={string:function(e,t){if(!e)return"#000";const i=I(t)&&t<1;if(J(e)){if(!i||!Et.object)return e;e=Et.object(e)}let s=P(e.a)?1:e.a;i&&(s*=t);const r=e.r+","+e.g+","+e.b;return s===1?"rgb("+r+")":"rgba("+r+","+s+")"}};Object.assign(vd,Uf),Object.assign(Et,Hf),Object.assign(F,tf),Object.assign(xt,pf),Object.assign(Cr,wf),Object.assign(Ye,Ef),Object.assign(at,{interaction:(e,t,i,s)=>new Ug(e,t,i,s),hitCanvas:(e,t)=>new Bd(e,t),hitCanvasManager:()=>new Pg}),Og();function Ie(e,t,i,s){var r,n=arguments.length,o=n<3?t:s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}let Vf=class extends Le{get __drawAfterFill(){return!0}setRobot(t){this._robot=t,this.__leaf.__updateRobot()}setAction(t){this._action=t,this.__leaf.__updateAction()}},Se=class extends m{get __tag(){return"Robot"}get nowFrame(){return this.robotFrames&&this.robotFrames[this.now]}constructor(t){super(t)}play(){this.running=!0}pause(){this.running=!1}stop(){this.pause()}__updateRobot(){const{robot:t}=this;if(this.robotFrames=[],!t)return;let i=0;Q(t)?t.forEach(s=>this.__loadRobot(s,i,i+=s.total||1)):this.__loadRobot(t,0,t.total)}__updateAction(){const t=this.actions[this.action];if(this.stop(),this.__timer&&clearTimeout(this.__timer),!P(t)){if(I(t))this.now=t;else if(W(t)){const i=Q(t),s=i?t:t.keyframes;this.__action=i?void 0:t;const{length:r}=s;if(r>1){const n=this.now=s[0],o=s[s.length-1];this.play(),this.__runAction(n,o)}else r&&(this.now=s[0])}}}__loadRobot(t,i,s){for(let n=i;n<s;n++)this.robotFrames.push(void 0);const r=Qt.get(t);r.ready?this.__createFrames(r,t,i,s):r.load(()=>this.__createFrames(r,t,i,s))}__createFrames(t,i,s,r){const{offset:n,size:o,total:a}=i,{width:h,height:d}=o&&(I(o)?{width:o,height:o}:o)||(a>1?this:t);let u=n?n.x:0,l=n?n.y:0;for(let c=s;c<r;c++)this.robotFrames[c]={view:t.view,x:u,y:l,width:h,height:d},u+h>=t.width?(u=0,l+=d):u+=h;this.__updateRobotBounds(),this.forceRender(),this.emitEvent(new oe(oe.LOADED,{image:t}))}__runAction(t,i){let{FPS:s,loop:r,__action:n}=this;n&&(n.FPS&&(s=n.FPS),P(n.loop)||(r=n.loop)),this.__timer=setTimeout(()=>{if(this.running){if(this.now===i){if(!r)return this.stop();this.now=t}else this.now++;this.__updateRobotBounds()}this.__runAction(t,i)},1e3/s)}__updateRobotBounds(){const{nowFrame:t}=this;if(t){const i=this.__,s=t.width/i.pixelRatio,r=t.height/i.pixelRatio;i.width===s&&i.height===r||this.forceUpdate("width"),i.__naturalWidth=s,i.__naturalHeight=r}}__drawContent(t,i){const{nowFrame:s}=this,{width:r,height:n}=this.__;s&&t.drawImage(s.view,s.x,s.y,s.width,s.height,0,0,r,n)}destroy(){this.robotFrames&&(this.robotFrames=null),super.destroy()}};Ie([Tt(Vf)],Se.prototype,"__",void 0),Ie([$()],Se.prototype,"robot",void 0),Ie([dt()],Se.prototype,"actions",void 0),Ie([dt("")],Se.prototype,"action",void 0),Ie([Be(0)],Se.prototype,"now",void 0),Ie([dt(12)],Se.prototype,"FPS",void 0),Ie([dt(!0)],Se.prototype,"loop",void 0),Se=Ie([Rt()],Se),vt.add("robot");function io(e,t){return it(e,i=>({set(s){this.__setAttr(i,s),this.leaferIsReady?t?N.setStyleName(this,t,s):N.set(this,s):this.__layout.stateStyleChanged=!0}}))}function ti(e){return it(e,t=>({set(i){this.__setAttr(t,i),this.__layout.stateStyleChanged=!0}}))}function Vr(e,t){if(t&&t!==!0)return t;if(!e.button){let{parent:i}=e;for(let s=0;s<2;s++)if(i){if(i.button)return i;i=i.parent}}return null}function Cd(e,t){W(t)||(t=void 0),Ho(e,t,"in")}function Ld(e,t){const{normalStyle:i}=e;W(t)||(t=void 0),i&&(t||(t=i),Ho(e,t,"out"))}const xl={};function Ho(e,t,i){const{normalStyle:s}=e;t||(t=xl),t.scale&&(wt.assignScale(t,t.scale),delete t.scale),t!==xl&&N.canAnimate||(i=null);let r=!!i&&(function(a,h,d){let u=a==="in"?"transition":"transitionOut";return a==="out"&&Pt(d[u])&&Pt(h[u])&&(u="transition"),Pt(h[u])?d[u]:h[u]})(i,t,e);const n=r?(function(a,h){const d=bl(h,a),u=a.animate();return u&&bl(d,a,u.fromStyle),d})(e,t):void 0;N.canAnimate&&Oo(e)&&e.killAnimate("transition"),s&&e.set(s,"temp");const o=Oo(e);if(o){const{animation:a}=o;if(a){const h=e.animate(a,void 0,"animation",!0);Object.assign(o,h.endingStyle),i!=="in"||t.animation!==a?h.kill():r=!1,delete o.animation}e.normalStyle=Ao(o,e),e.set(o,"temp")}else e.normalStyle=void 0;if(r){const a=Ao(n,e);e.set(n,"temp"),e.animate([n,a],r,"transition",!0)}e.__layout.stateStyleChanged=!1}function Oo(e){let t;const i={},s=Vr(e),r=s?e.state||s.state:e.state,n=r&&e.states[r];n&&N.isState(r,e,s)&&(t=ei(i,n));const o=i.selectedStyle||e.selectedStyle;o&&N.isSelected(e,s)&&(t=ei(i,o));const a=i.placeholderStyle||e.placeholderStyle;if(a&&N.isPlacehold(e,s)&&(t=ei(i,a)),N.isDisabled(e,s)){const h=i.disabledStyle||e.disabledStyle;h&&(t=ei(i,h))}else{const h=i.focusStyle||e.focusStyle;h&&N.isFocus(e,s)&&(t=ei(i,h));const d=i.hoverStyle||e.hoverStyle;d&&N.isHover(e,s)&&(t=ei(i,d));const u=i.pressStyle||e.pressStyle;u&&N.isPress(e,s)&&(t=ei(i,u))}return t?i:void 0}function Ao(e,t,i,s){const r=i?e:{},n=i||e;for(let o in n)s&&N.animateExcludes[o]||(r[o]=t[o]);return r}function bl(e,t,i){return Ao(e,t,i,!0)}function ei(e,t){return Object.assign(e,t),!0}function Fr(e,t){const i=e[t];i&&Cd(e,i),e.button&&Vo(e.children,t)}function Do(e,t,i){i||(i=e.states[t]),Cd(e,i),e.button&&Vo(e.children,null,t)}function Vo(e,t,i){if(!e)return;let s,r;for(let n=0,o=e.length;n<o;n++){if(s=e[n],t){switch(r=!0,t){case"hoverStyle":N.isHover(s)&&(r=!1);break;case"pressStyle":N.isPress(s)&&(r=!1);break;case"focusStyle":N.isFocus(s)&&(r=!1)}r&&Fr(s,t)}else P(i)||Do(s,i);s.isBranch&&Vo(s.children,t,i)}}function Ir(e,t){const i=e[t];i&&Ld(e,i),e.button&&qo(e.children,t)}function Mo(e,t,i){Ld(e,i),e.button&&qo(e.children,null,t)}function qo(e,t,i){if(!e)return;let s;for(let r=0,n=e.length;r<n;r++)s=e[r],t?Ir(s,t):P(i)||Mo(s,i),s.isBranch&&qo(s.children,t,i)}function ur(e,t,i){let s;const r=t.leafer?t.leafer.interaction:null;if(r&&(s=r[e](t),!s&&i)){const n=Vr(t,i);n&&(s=r[e](n))}return s}function Sl(e,t,i){let s=t[e];if(!s&&i){const r=Vr(t,i);r&&(s=r[e])}return s}vt.add("state"),N.animateExcludes={animation:1,animationOut:1,transition:1,transitionOut:1,states:1,state:1,placeholder:1,normalStyle:1,hoverStyle:1,pressStyle:1,focusStyle:1,selectedStyle:1,disabledStyle:1,placeholderStyle:1},N.isState=function(e,t,i){return(function(s,r,n){let o=r.states[s];if(!o&&n){const a=Vr(r,n);a&&(o=a.states[s])}return!!o})(e,t,i)},N.isSelected=function(e,t){return Sl("selected",e,t)},N.isDisabled=function(e,t){return Sl("disabled",e,t)},N.isFocus=function(e,t){return ur("isFocus",e,t)},N.isHover=function(e,t){return ur("isHover",e,t)},N.isPress=function(e,t){return ur("isPress",e,t)},N.isPlacehold=function(e,t){return e.__.__isPlacehold},N.isDrag=function(e,t){return ur("isDrag",e,t)},N.setStyleName=function(e,t,i){i?Do(e,t,e[t]):Mo(e,t,e[t])},N.set=function(e,t){const i=e.states[t];i?Do(e,t,i):Mo(e,t,i)},N.getStyle=Oo,N.updateStyle=Ho,N.updateEventStyle=function(e,t){switch(t){case R.ENTER:Fr(e,"hoverStyle");break;case R.LEAVE:Ir(e,"hoverStyle");break;case R.DOWN:Fr(e,"pressStyle");break;case R.UP:Ir(e,"pressStyle")}};const so=m.prototype;m.addAttr("selected",!1,io,"selectedStyle"),m.addAttr("disabled",!1,io,"disabledStyle"),m.addAttr("states",{},ti),m.addAttr("state","",io),m.addAttr("normalStyle",void 0,dt),m.addAttr("hoverStyle",void 0,ti),m.addAttr("pressStyle",void 0,ti),m.addAttr("focusStyle",void 0,ti),m.addAttr("selectedStyle",void 0,ti),m.addAttr("disabledStyle",void 0,ti),m.addAttr("placeholderStyle",void 0,ti),m.addAttr("button",!1,dt),so.set=function(e,t){e&&(t?t==="temp"?(this.lockNormalStyle=!0,Object.assign(this,e),this.lockNormalStyle=!1):this.animate(e,t):Object.assign(this,e))},so.focus=function(e=!0){this.waitLeafer(()=>{let{focusData:t}=this.app.interaction;e?(t&&t.focus(!1),t=this):t=null,this.app.interaction.focusData=t,e?Fr(this,"focusStyle"):Ir(this,"focusStyle")})},so.updateState=function(){N.updateStyle(this,void 0,"in")};const kl=U.prototype,ro="text";pi(kl,ro,Object.assign(Object.assign({},No(kl,ro)),{set(e){const t=this,i=t.text;t.__setAttr(ro,e)&&(gi(t),t.placeholderStyle&&t.placeholder&&(i===""||e==="")&&(t.__layout.stateStyleChanged=!0))}}));const qf={transparent:"FFF0",aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"0FF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"0",blanchedalmond:"FFEBCD",blue:"00F",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"0FF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9",darkgreen:"006400",darkgrey:"A9",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"69",dimgrey:"69",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"F0F",gainsboro:"DC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"80",green:"008000",greenyellow:"ADFF2F",grey:"80",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3",lightgreen:"90EE90",lightgrey:"D3",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"789",lightslategrey:"789",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370DB",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"D87093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",rebeccapurple:"639",red:"F00",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"F",whitesmoke:"F5",yellow:"FF0",yellowgreen:"9ACD32"},Bl=/^rgb\((\d+),\s*(\d+),\s*(\d+)/i,Pl=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d*\.?\d+)/i,El=/^hsl\((\d+),\s*(\d+)%\s*,\s*(\d+)%/i,Tl=/^hsla\((\d+),\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d*\.?\d+)/i,ct=parseInt,We=parseFloat,{round:no}=Math;let oo={},ao=0;function Rl(e){let t,i,s,r=1;switch(e.length){case 9:t=ct(e.slice(1,3),16),i=ct(e.slice(3,5),16),s=ct(e.slice(5,7),16),r=ct(e.slice(7,9),16)/255;break;case 7:t=ct(e.slice(1,3),16),i=ct(e.slice(3,5),16),s=ct(e.slice(5,7),16);break;case 5:t=ct(e[1]+e[1],16),i=ct(e[2]+e[2],16),s=ct(e[3]+e[3],16),r=ct(e[4]+e[4],16)/255;break;case 4:t=ct(e[1]+e[1],16),i=ct(e[2]+e[2],16),s=ct(e[3]+e[3],16);break;case 3:t=i=s=ct(e[1]+e[2],16);break;case 2:t=i=s=ct(e[1]+e[1],16)}return{r:t,g:i,b:s,a:r}}const Gf=1/6,Kf=.5,Cl=2/3,Ll=1/3;function ho(e,t,i){return i<0?i++:i>1&&i--,i<Gf?e+6*(t-e)*i:i<Kf?t:i<Cl?e+(t-e)*(Cl-i)*6:e}function Ol(e,t,i,s=1){let r,n,o;if(e/=360,i/=100,(t/=100)===0)r=n=o=i;else{let a=i<.5?i*(1+t):i+t-i*t,h=2*i-a;r=ho(h,a,e+Ll),n=ho(h,a,e),o=ho(h,a,e-Ll)}return{r:no(255*r),g:no(255*n),b:no(255*o),a:s}}vt.add("color"),Et.object=function(e,t){let i,s=!P(t)&&t<1;if(J(e)){const r=oo[e];if(r)i=Object.assign({},r);else{switch(e[0]){case"#":i=Rl(e);break;case"R":case"r":e[4]==="("&&Pl.test(e)?i=(function(n){const o=Pl.exec(n);return{r:ct(o[1]),g:ct(o[2]),b:ct(o[3]),a:We(o[4])}})(e):e[3]==="("&&Bl.test(e)&&(i=(function(n){const o=Bl.exec(n);return{r:ct(o[1]),g:ct(o[2]),b:ct(o[3]),a:1}})(e));break;case"H":case"h":e[4]==="("&&Tl.test(e)?i=(function(n){const o=Tl.exec(n);return Ol(We(o[1]),We(o[2]),We(o[3]),We(o[4]))})(e):e[3]==="("&&El.test(e)&&(i=(function(n){const o=El.exec(n);return Ol(We(o[1]),We(o[2]),We(o[3]),1)})(e))}if(!i){const n=qf[e.toLowerCase()];n&&(i=Rl("#"+n))}i&&(ao++,ao>1e4&&(oo={},ao=0),oo[e]=Object.assign({},i))}}else W(e)&&(P(e.a)&&(e.a=1),s&&(e=Object.assign({},e)),i=e);return i||(i={r:255,g:255,b:255,a:1}),s&&(i.a*=t),i};function Ot(e,t,i,s){var r,n=arguments.length,o=n<3?t:s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o}const{cos:Al,sin:ms,pow:Lt,sqrt:cr,abs:Qf,ceil:Zf,floor:Jf,round:ty,PI:Ar}=Math,_r=5*Ar,pr=1.70158,gr=2.5949095,fr=7.5625,Ai=2.75;function yr(e){return t=>Lt(t,e)}function mr(e){return t=>1-Lt(1-t,e)}function vr(e){return t=>t<.5?.5*Lt(2*t,e):1-.5*Lt(2-2*t,e)}function wr(e){return e<1/Ai?fr*e*e:e<2/Ai?fr*(e-=1.5/Ai)*e+.75:e<2.5/Ai?fr*(e-=2.25/Ai)*e+.9375:fr*(e-=2.625/Ai)*e+.984375}function vs(e,t,i,s){const r={};return n=>{const o=~~(1e4*n),a=r[o];if(a)return a;let h,d,u,l=n;for(let c=0;c<8&&(h=1-l,u=Dl(l,e,i)-n,d=3*h*h*e+6*h*l*(i-e)+3*l*l*(1-i),!(Qf(d)<1e-6));c++)l-=u/d;return r[o]=Dl(l,t,s)}}function Dl(e,t,i){const s=1-e;return 3*s*s*e*t+3*s*e*e*i+e*e*e}const Wr={get(e){const{list:t}=Wr;return J(e)?t[e||"ease"]:W(e)?t[e.name].apply(t,Q(e.value)?e.value:[e.value]):t.ease},register(e,t){Wr.list[e]=t},list:{linear:e=>e,ease:vs(.25,.1,.25,1),"ease-in":vs(.42,0,1,1),"ease-out":vs(0,0,.58,1),"ease-in-out":vs(.42,0,.58,1),"sine-in":e=>1-Al(e*Ar*.5),"sine-out":e=>ms(e*Ar*.5),"sine-in-out":e=>.5*(1-Al(e*Ar)),"quad-in":yr(2),"quad-out":mr(2),"quad-in-out":vr(2),"cubic-in":yr(3),"cubic-out":mr(3),"cubic-in-out":vr(3),"quart-in":yr(4),"quart-out":mr(4),"quart-in-out":vr(4),"quint-in":yr(5),"quint-out":mr(5),"quint-in-out":vr(5),"expo-in":e=>e?Lt(2,10*e-10):0,"expo-out":e=>e===1?1:1-Lt(2,10*-e),"expo-in-out":e=>e===0||e===1?e:e<.5?.5*Lt(2,2*e*10-10):.5*(2-Lt(2,10-2*e*10)),"circ-in":e=>1-cr(1-Lt(e,2)),"circ-out":e=>cr(1-Lt(e-1,2)),"circ-in-out":e=>e<.5?.5*(1-cr(1-Lt(2*e,2))):.5*(cr(1-Lt(2-2*e,2))+1),"back-in":e=>((pr+1)*e-pr)*e*e,"back-out":e=>(e-=1)*e*((pr+1)*e+pr)+1,"back-in-out":e=>e<.5?(e*=2)*e*((gr+1)*e-gr)*.5:.5*((e=2*e-2)*e*((gr+1)*e+gr)+2),"elastic-in":e=>e===0||e===1?e:-Lt(2,10*(e-1))*ms((e-1.1)*_r),"elastic-out":e=>e===0||e===1?e:Lt(2,-10*e)*ms((e-.1)*_r)+1,"elastic-in-out":e=>e===0||e===1?e:e<.5?-Lt(2,10*((e*=2)-1))*ms((e-1.1)*_r)*.5:Lt(2,10*(1-(e*=2)))*ms((e-1.1)*_r)*.5+1,"bounce-in":e=>1-wr(1-e),"bounce-out":wr,"bounce-in-out":e=>e<.5?.5*(1-wr(1-2*e)):.5*(1+wr(2*e-1)),"cubic-bezier":vs,steps:function(e,t="floor"){return i=>(t==="floor"?Jf(i*e):t==="ceil"?Zf(i*e):ty(i*e))/e}}};function Yt(e){return(t,i)=>{Object.defineProperty(t,i,{get(){const s=this.config&&this.config[i];return s===void 0?e:s},set(s){this.config||(this.config={}),this.config[i]=s}})}}class gt{}gt.CREATED="created",gt.PLAY="play",gt.PAUSE="pause",gt.STOP="stop",gt.SEEK="seek",gt.UPDATE="update",gt.COMPLETED="completed";let kt=class extends md{get endingStyle(){return this.realEnding==="from"?this.fromStyle:this.toStyle}get started(){return!!this.requestAnimateTime}get completed(){return this.time>=this.duration&&!this.started}get frame(){return this.frames[this.nowIndex]}get frameTotalTime(){return this.frame.totalTime||this.frame.duration||0}get nowReverse(){return(this.mainReverse?1:0)+(this.frameReverse?1:0)==1}get realEnding(){let e;const{ending:t,reverse:i,swing:s,loop:r}=this;return t==="from"?e=0:t==="to"?e=1:(e=i?0:1,s&&r&&I(r)&&(e+=r-1)),e%2?"to":"from"}constructor(e,t,i,s){super(),this.nowIndex=0,this.playedTotalTime=0,t&&(t.keyframes?(i=t,t=t.keyframes):t.style&&(i=t,t=t.style)),this.init(e,t,i,s)}init(e,t,i,s){switch(this.target=e,(s||this.isTemp)&&(this.isTemp=s),typeof i){case"number":this.config={duration:i};break;case"string":this.config={easing:i};break;case"object":this.config=i,i.event&&(this.event=i.event)}this.keyframes=Q(t)?t:t?[t]:[];const{easing:r,attrs:n}=this;this.easingFn=Wr.get(r),(n||this.attrsMap)&&(this.attrsMap=n?n.reduce((o,a)=>(o[a]=!0,o),{}):void 0),this.frames=[],this.create(),this.autoplay&&this.frames.length&&(this.timer=setTimeout(()=>{this.timer=0,this.play()},0))}emitType(e){this.emit(e,this),this.parent&&this.parent.onChildEvent(e,this)}play(){this.destroyed||(this.running=!0,this.started?this.timer||this.startRequestAnimate():(this.clearTimer(),this.start()),this.emitType(gt.PLAY))}pause(){this.destroyed||(this.running=!1,this.clearTimer(),this.emitType(gt.PAUSE))}stop(){this.destroyed||(this.complete(),this.emitType(gt.STOP))}seek(e,t){if(this.destroyed)return;const{delay:i}=this;let s;W(e)&&(e=ui.number(e,this.duration+(t?i:0))),t&&(e-=i),e&&(e/=this.speed),e<0&&(s=-e,e=0),(!this.started||e<this.time||!e)&&this.start(!0),this.time=e,s||this.animate(0,!0),this.clearTimer(()=>{s?this.timer=setTimeout(()=>{this.timer=0,this.begin()},1e3*s):this.startRequestAnimate()}),this.emitType(gt.SEEK)}kill(e=!0,t){this.killStyle=t,this.destroy(e)}create(){const{target:e,frames:t,keyframes:i,config:s}=this,{length:r}=i,n=!(r>1)||this.join;let o,a,h,d,u,l=0,c=0;r>1&&(this.fromStyle={},this.toStyle={});for(let _=0;_<r;_++){if(a=i[_],d=a.style||a,o||(o=n?e:d),h={style:d,beforeStyle:{}},u=1,a.style){const{duration:g,autoDuration:y,delay:f,autoDelay:w,easing:v,swing:x,loop:b}=a;x&&(h.swing=I(x)?x:2,u=2*h.swing-1),b&&(h.loop=u=I(b)?b:2),g?(h.duration=g,l+=g*u,f&&(h.totalTime=g+f)):y&&(h.autoDuration=y,c+=y*u),f?(h.delay=f,l+=f*u):w&&(h.autoDelay=w,c+=w*u),v&&(h.easingFn=Wr.get(v))}if(!h.autoDuration&&P(h.duration)&&(r>1?_>0||n?c+=u:h.duration=0:h.duration=this.duration),r>1)this.setBefore(h,d,o);else{for(let g in d)h.beforeStyle[g]=e[g];this.fromStyle=h.beforeStyle,this.toStyle=h.style}o=d,t.push(h)}c?((this.duration<=l||!s||!s.duration)&&this.changeDuration(l+.2*c),this.allocateTime((this.duration-l)/c)):l&&this.changeDuration(l),this.emitType(gt.CREATED)}changeDuration(e){const{config:t}=this;this.config=t?Object.assign(Object.assign({},t),{duration:e}):{duration:e}}setBefore(e,t,i){const{fromStyle:s,toStyle:r,target:n}=this;for(let o in t)P(s[o])&&(s[o]=r[o]=t===i?i[o]:n[o]),e.beforeStyle[o]=P(i[o])?r[o]:i[o],r[o]=t[o]}allocateTime(e){let t,{frames:i}=this,{length:s}=i;for(let r=0;r<s;r++)t=i[r],P(t.duration)&&(t.duration=t.autoDuration?e*t.autoDuration:e),t.totalTime||(t.autoDelay&&(t.delay=t.autoDelay*e),t.delay&&(t.totalTime=t.duration+t.delay))}startRequestAnimate(){this.requestAnimateTime=Date.now(),this.requestAnimatePageTime=0,this.waitRequestRender||this.requestAnimate()}requestAnimate(){this.waitRequestRender=!0,S.requestRender(this.animate.bind(this))}animate(e,t){if(!t){if(this.waitRequestRender=!1,!this.running)return;let r;r=e&&this.requestAnimatePageTime?e-this.requestAnimatePageTime:Date.now()-this.requestAnimateTime,this.time+=r/1e3,this.requestAnimatePageTime=e,this.requestAnimateTime=Date.now()}const{duration:i}=this,s=this.time*this.speed;if(s<i){for(;s-this.playedTotalTime>this.frameTotalTime;)this.transition(1),this.mainReverse?this.reverseNextFrame():this.nextFrame();const r=this.nowReverse?0:this.frame.delay||0,n=s-this.playedTotalTime-r,o=this.frame.duration;if(n>o)this.transition(1);else if(n>=0){const a=o?n/o:1;this.transition(this.frame.easingFn?this.frame.easingFn(a):this.easingFn(a))}}else this.end();if(!t)if(s<i)this.requestAnimate();else{const{loop:r,loopDelay:n,swing:o}=this;if((r!==!1||o)&&(this.looped?this.looped++:this.looped=1,this.needLoop(this.looped,r,o)))return o&&(this.mainReverse=!this.mainReverse),void(n?this.timer=setTimeout(()=>{this.timer=0,this.begin()},n/this.speed*1e3):this.begin());this.complete()}}start(e){this.requestAnimateTime=1;const{reverse:t,jump:i}=this;if((t||this.mainReverse)&&(this.mainReverse=t),this.looped&&(this.looped=0),e)this.begin(!0);else{const{delay:s}=this;s?(i&&this.begin(!0),this.timer=setTimeout(()=>{this.timer=0,this.begin()},s/this.speed*1e3)):this.begin()}}begin(e){this.playedTotalTime=this.time=0,this.mainReverse?this.setTo():this.setFrom(),e||this.startRequestAnimate()}end(){this.mainReverse?this.setFrom():this.setTo()}complete(){this.requestAnimateTime=0,this.running=!1;const{endingStyle:e,killStyle:t}=this,i=t?{}:e;if(t)for(let s in e)s in t||(i[s]=e[s]);this.setStyle(i),this.clearTimer(),this.emitType(gt.COMPLETED)}setFrom(){this.nowIndex=0,this.setStyle(this.fromStyle)}setTo(){this.nowIndex=this.frames.length-1,this.setStyle(this.toStyle)}nextFrame(){if(this.needLoopFrame())return this.increaseTime();this.nowIndex+1>=this.frames.length||(this.increaseTime(),this.nowIndex++)}reverseNextFrame(){if(this.needLoopFrame())return this.increaseTime();this.nowIndex-1<0||(this.increaseTime(),this.nowIndex--)}transition(e){const{style:t,beforeStyle:i}=this.frame,s=this.nowReverse?t:i,r=this.nowReverse?i:t;if(e===0)this.setStyle(s);else if(e===1)this.setStyle(r);else{const{attrsMap:n,target:o}=this;let{betweenStyle:a}=this.frame;a||(a=this.frame.betweenStyle={}),ne.setBetweenStyle(a,s,r,t,e,o,n),this.setStyle(a)}this.emitType(gt.UPDATE)}setStyle(e){const{target:t}=this;t&&e&&(this.style=e,t.__?t.set(e,!!this.isTemp&&"temp"):Object.assign(t,e))}increaseTime(){this.playedTotalTime+=this.frameTotalTime}needLoop(e,t,i){return!(this.needStopLoop(e,t)||this.needStopLoop(e,i,!0))}needStopLoop(e,t,i){return I(t)&&(!t||e>=(i?2*t-1:t))}needLoopFrame(){const{loop:e,swing:t}=this.frame;if(e||t){if(this.frameLooped?this.frameLooped++:this.frameLooped=1,t&&(this.frameReverse=!this.frameReverse),this.needLoop(this.frameLooped,e,t))return!0;this.frameLooped=this.frameReverse=void 0}return!1}clearTimer(e){this.timer&&(clearTimeout(this.timer),this.timer=0,e&&e())}destroy(e){this.destroyed||(super.destroy(),e&&!this.completed?this.stop():this.pause(),this.target=this.parent=this.config=this.frames=this.fromStyle=this.toStyle=this.style=this.killStyle=null,this.destroyed=!0)}};Ot([Yt("ease")],kt.prototype,"easing",void 0),Ot([Yt(0)],kt.prototype,"delay",void 0),Ot([Yt(.2)],kt.prototype,"duration",void 0),Ot([Yt("auto")],kt.prototype,"ending",void 0),Ot([Yt(!1)],kt.prototype,"reverse",void 0),Ot([Yt(!1)],kt.prototype,"swing",void 0),Ot([Yt(!1)],kt.prototype,"loop",void 0),Ot([Yt(0)],kt.prototype,"loopDelay",void 0),Ot([Yt(1)],kt.prototype,"speed",void 0),Ot([Yt(!0)],kt.prototype,"autoplay",void 0),Ot([Yt()],kt.prototype,"join",void 0),Ot([Yt()],kt.prototype,"jump",void 0),Ot([Yt()],kt.prototype,"attrs",void 0),kt=Ot([jt(Yo)],kt);let Wi=class extends kt{get completed(){return this.list.every(t=>t.completed)}get endingStyle(){return this._endingStyle}constructor(t,i,s){super(t,null),this.list=[],this.updateList(i,s)}updateList(t,i){this.fromStyle={},this.toStyle={},this._endingStyle={},t||(t=this.list.filter(s=>{const{completed:r}=s;return r&&s.destroy(),!r})),this.list=t.map(s=>{const r=s.target?s:new kt(this.target,s,i);return r.parent=this,Object.assign(this.fromStyle,r.fromStyle),Object.assign(this.toStyle,r.toStyle),Object.assign(this._endingStyle,r.endingStyle),r})}play(){this.each(t=>t.play()),this.emitType(gt.PLAY)}pause(){this.each(t=>t.pause()),this.emitType(gt.PAUSE)}stop(){this.each(t=>t.stop()),this.emitType(gt.STOP)}seek(t,i){this.each(s=>s.seek(t,i)),this.emitType(gt.SEEK)}kill(t,i){this.each(s=>s.kill(t,i)),this.destroy()}onChildEvent(t,i){switch(t){case gt.COMPLETED:this.completed&&this.emitType(t);break;case gt.UPDATE:this.emitType(t)}}each(t){this.list.forEach(t)}destroy(t){const{list:i}=this;i.length&&(this.each(s=>s.destroy(t)),i.length=0)}};Wi=Ot([jt(Yo)],Wi);const{round:ey}=Math,{fourNumber:Ml}=wt,iy={fill:Fl,stroke:Fl,cornerRadius:(e,t,i)=>I(e)&&I(t)?Nt(e,t,i):(e=Ml(e),t=Ml(t),e.map((s,r)=>Nt(s,t[r],i))),text(e,t,i){if(J(e)&&J(t)){const s=e.length,r=t.length,n=Nt(s,r,i,1);return s<r?t.substring(0,n):e.substring(0,n)}return I(e)||I(t)?wt.float(Nt(e,t,i),Math.max($l(e),$l(t))):t},boxStyle(e,t,i,s){e||(e={}),t||(t={});const r=Object.assign(Object.assign({},e),t);return ne.setBetweenStyle(r,e,t,r,i,s),r},shadow:Il,innerShadow:Il},sy={value:function(e,t,i){const s=I(e),r=I(t);return s&&r?e+(t-e)*i:r||s?Nt(e,t,i):e},number:Nt,color:Go,setBetweenStyle:function(e,t,i,s,r,n,o){let a,h,d;const{list:u,value:l}=ne;for(let c in s)o&&!o[c]||(a=t[c],h=i[c],d=u[c]||l,a!==h&&(e[c]=d(a,h,r,n)))}};function $l(e){const t=String(e).split(".")[1];return t?t.length:0}function Nt(e,t,i,s){e||(e=0),t||(t=0);const r=e+(t-e)*i;return s?ey(r):r}function Go(e,t,i){e=Et.object(e),t=Et.object(t);const s=Nt(e.r,t.r,i,1)+","+Nt(e.g,t.g,i,1)+","+Nt(e.b,t.b,i,1),r=Nt(e.a,t.a,i);return r===1?"rgb("+s+")":"rgba("+s+","+r+")"}function Fl(e,t,i){return J(e)&&J(t)?Go(e,t,i):t}function Il(e,t,i){return Q(e)||Q(t)?t:(t=t||{},{x:Nt((e=e||{}).x,t.x,i),y:Nt(e.y,t.y,i),blur:Nt(e.blur,t.blur,i),spread:Nt(e.spread,t.spread,i),color:Go(e.color||"#FFFFFF00",t.color||"#FFFFFF00",i),visible:t.visible,blendMode:t.blendMode,box:t.box||e.box})}vt.add("animate","color"),N.canAnimate=!0,Object.assign(ne.list,iy),Object.assign(ne,sy);const xr=m.prototype;m.addAttr("animation",void 0,function(e){return it(e,t=>({set(i){this.__setAttr(t,i),this.leafer&&(this.killAnimate("animation"),i&&this.animate(i,void 0,"animation"))}}))}),m.addAttr("animationOut",void 0,dt),m.addAttr("transition",!0,dt),m.addAttr("transitionOut",void 0,dt),xr.set=function(e,t){e&&(t?t==="temp"?(this.lockNormalStyle=!0,Object.assign(this,e),this.lockNormalStyle=!1):this.animate(e,t):Object.assign(this,e))},xr.animate=function(e,t,i,s){if(P(e))return this.__animate;let r=Q(e)&&!t&&i?new Wi(this,e,s):new kt(this,e,t,s);this.killAnimate(i,r.toStyle);const n=this.__animate;return n&&(r instanceof Wi?r.list.unshift(n):r=new Wi(this,[n,r])),this.__animate=r},xr.killAnimate=function(e,t){const i=this.__animate;if(i){let s=!1;if(t&&!i.completed){i instanceof Wi&&i.updateList();const{toStyle:r}=i;for(let n in t)if(n in r){s=!0;break}}else s=!0;s&&(i.kill(!0,t),this.__animate=null)}},xr.__runAnimation=function(e,t){this.animate(e==="in"?this.animation:this.animationOut,void 0,"animation"),t&&this.__animate.on(gt.COMPLETED,t)};const lo=[.1488743389,.4333953941,.6794095682,.8650633666,.9739065285],ry=[.2955242247,.2692667193,.2190863625,.1494513491,.0666713443],{sqrt:Wl}=Math,{getDerivative:Di}=Te,Fi={getDistance(e,t,i,s,r,n,o,a,h=1){let d,u,l,c,_,g,y=0,f=h/2;for(let w=0;w<lo.length;w++)d=f*(1+lo[w]),u=f*(1-lo[w]),l=Di(d,e,i,r,o),c=Di(d,t,s,n,a),_=Di(u,e,i,r,o),g=Di(u,t,s,n,a),y+=ry[w]*(Wl(l*l+c*c)+Wl(_*_+g*g));return y*f},getRotation(e,t,i,s,r,n,o,a,h){const d=Di(e,t,s,n,a),u=Di(e,i,r,o,h);return Math.atan2(u,d)/G},getT(e,t,i,s,r,n,o,a,h,d,u=1){let l=0,c=1,_=e/t,g=u/t/3;if(_>=1)return 1;if(_<=0)return 0;for(;c-l>g;)ny(i,s,r,n,o,a,h,d,_)<e?l=_:c=_,_=(l+c)/2;return _},cut(e,t,i,s,r,n,o,a,h,d){const u=1-t,l=u*i+t*r,c=u*s+t*n,_=u*r+t*o,g=u*n+t*a,y=u*l+t*_,f=u*c+t*g,w=u*y+t*(u*_+t*(u*o+t*h)),v=u*f+t*(u*g+t*(u*a+t*d));e.push(Ut.C,l,c,y,f,w,v)}},{getDistance:ny}=Fi,{M:br,L:ws,C:Sr,Z:kr}=Ut,{float:Nl}=wt,xs={},ii={},Ts={transform(e,t){let i,s=0;const r=e.length;for(;s<r;)switch(i=e[s],i){case br:case ws:Ts.transformPoints(e,t,s,1),s+=3;break;case Sr:Ts.transformPoints(e,t,s,3),s+=7;break;case kr:s+=1}},transformPoints(e,t,i,s){for(let r=i+1,n=r+2*s;r<n;r+=2)xs.x=e[r],xs.y=e[r+1],C.toOuterPoint(t,xs),e[r]=xs.x,e[r+1]=xs.y},getMotionPathData(e){let t,i,s,r,n=0,o=[],a=0,h=0,d=0;const u=e.length;for(;a<u;){switch(r=e[a],r){case br:case ws:i=e[a+1],s=e[a+2],t=r===ws&&a>0?L.getDistanceFrom(h,d,i,s):0,h=i,d=s,a+=3;break;case Sr:i=e[a+5],s=e[a+6],t=Fi.getDistance(h,d,e[a+1],e[a+2],e[a+3],e[a+4],i,s),h=i,d=s,a+=7;break;case kr:a+=1;default:t=0}o.push(t),n+=t}return{total:n,segments:o,data:e}},getDistancePoint(e,t,i){const{segments:s,data:r}=e;t=ui.number(t,e.total);let n,o,a,h,d,u,l,c,_,g=0,y={},f=0,w=0,v=0,x=0;const b=r.length;for(;f<b;){switch(h=r[f],h){case br:case ws:if(o=r[f+1],a=r[f+2],n=s[w],g+n>=t||!e.total)return f||(v=o,x=a),ii.x=v,ii.y=x,y.x=o,y.y=a,L.getDistancePoint(ii,y,t-g,!0),y.rotation=L.getAngle(ii,y),y;v=o,x=a,f+=3;break;case Sr:if(o=r[f+5],a=r[f+6],n=s[w],g+n>=t)return d=r[f+1],u=r[f+2],l=r[f+3],c=r[f+4],_=Fi.getT(t-g,n,v,x,d,u,l,c,o,a,i),Te.getPointAndSet(_,v,x,d,u,l,c,o,a,y),y.rotation=Fi.getRotation(_,v,x,d,u,l,c,o,a),y;v=o,x=a,f+=7;break;case kr:f+=1;default:n=0}w++,g+=n}return y},getDistancePath(e,t,i){const{segments:s,data:r}=e,n=[];t=ui.number(t,e.total);let o,a,h,d,u,l,c,_,g,y,f=0,w={},v=0,x=0,b=0,k=0;const O=r.length;for(;v<O;){switch(u=r[v],u){case br:case ws:if(h=r[v+1],d=r[v+2],o=s[x],f+o>t||!e.total)return v||(b=h,k=d),ii.x=b,ii.y=k,w.x=h,w.y=d,a=Nl(t-f),a&&(L.getDistancePoint(ii,w,a,!0),n.push(u,w.x,w.y)),n;b=h,k=d,v+=3,n.push(u,b,k);break;case Sr:if(l=r[v+1],c=r[v+2],_=r[v+3],g=r[v+4],h=r[v+5],d=r[v+6],o=s[x],f+o>t)return a=Nl(t-f),a&&(y=Fi.getT(a,o,b,k,l,c,_,g,h,d,i),Fi.cut(n,y,b,k,l,c,_,g,h,d)),n;b=h,k=d,v+=7,n.push(u,l,c,_,g,h,d);break;case kr:v+=1,n.push(u);default:o=0}x++,f+=o}return n}};function Br(e){return it(e,t=>({set(i){this.__setAttr(t,i),this.__hasMotionPath=this.motionPath||!Pt(this.motion),this.__layout.matrixChanged||this.__layout.matrixChange()}}))}vt.add("motion-path"),ne.register("motion",function(e,t,i,s){return W(e)&&(e=ui.number(e,s.getMotionTotal())),W(t)&&(t=ui.number(t,s.getMotionTotal())),ne.number(e||0,t||0,i)}),ne.register("motionRotation",function(e,t,i){return ne.number(e,t,i)});const Pr=m.prototype,{updateMatrix:oy,updateAllMatrix:ay}=yt,{updateBounds:hy}=ji;function zl(e){const{motion:t,leaferIsCreated:i}=e;if(!Pt(t)){if(i&&(e.leafer.created=!1),e.motionPath){const s=$o(e);s.total&&(e.__.__pathForRender=Ts.getDistancePath(s,t,e.motionPrecision))}else e.set(e.getMotionPoint(t)),e.__hasAutoLayout||(e.isBranch?(ay(e),hy(e,e)):oy(e));i&&(e.leafer.created=!0)}}function Yl(e){const{parent:t}=e;if(!e.motionPath&&t){const{children:i}=t;for(let s=0;s<i.length;s++)if(i[s].motionPath)return i[s]}return e}function $o(e){const t=e.__;return t.__pathForMotion?t.__pathForMotion:t.__pathForMotion=Ts.getMotionPathData(e.getPath(!0,!0))}m.addAttr("motionPath",void 0,Br),m.addAttr("motionPrecision",1,Br),m.addAttr("motion",void 0,Br),m.addAttr("motionRotation",!0,Br),Pr.getMotionPathData=function(){return $o(Yl(this))},Pr.getMotionPoint=function(e){const t=Yl(this),i=$o(t);if(!i.total)return{};const s=Ts.getDistancePoint(i,e,t.motionPrecision);C.toOuterPoint(t.localTransform,s);const{motionRotation:r}=this;return r===!1?delete s.rotation:I(r)&&(s.rotation+=r),s},Pr.getMotionTotal=function(){return this.getMotionPathData().total},Pr.__updateMotionPath=function(){const e=this.__;if(this.__layout.resized&&e.__pathForMotion&&(e.__pathForMotion=void 0),this.motionPath){let t;const{children:i}=this.parent;for(let s=0;s<i.length;s++)t=i[s],Pt(t.motion)||t.__layout.matrixChanged||(t!==this&&t.__extraUpdate(),zl(t))}else zl(this)};const{Yes:ly,NoAndSkip:dy,YesAndSkip:uy}=uo,Xl={},jl={},Ul={};class cy{constructor(t){this.innerIdMap={},this.idMap={},this.methods={id:(i,s)=>i.id===s?(this.target&&(this.idMap[s]=i),1):0,innerId:(i,s)=>i.innerId===s?(this.target&&(this.innerIdMap[s]=i),1):0,className:(i,s)=>i.className===s?1:0,tag:(i,s)=>i.__tag===s?1:0,tags:(i,s)=>s[i.__tag]?1:0},(this.target=t)&&this.__listenEvents()}getBy(t,i,s,r){switch(typeof t){case"number":const n=this.getByInnerId(t,i);return s?n:n?[n]:[];case"string":switch(t[0]){case"#":Xl.id=t.substring(1),t=Xl;break;case".":jl.className=t.substring(1),t=jl;break;default:Ul.tag=t,t=Ul}case"object":if(P(t.id)){if(t.tag){const{tag:o}=t,a=Q(o);return this.getByMethod(a?this.methods.tags:this.methods.tag,i,s,a?Z.toMap(o):o)}return this.getByMethod(this.methods.className,i,s,t.className)}{const o=this.getById(t.id,i);return s?o:o?[o]:[]}case"function":return this.getByMethod(t,i,s,r)}}getByInnerId(t,i){return this.innerIdMap[t]||(this.eachFind(this.toChildren(i),this.methods.innerId,null,t),this.findLeaf)}getById(t,i){const s=this.idMap[t];return s&&yt.hasParent(s,i||this.target)?s:(this.eachFind(this.toChildren(i),this.methods.id,null,t),this.findLeaf)}getByClassName(t,i){return this.getByMethod(this.methods.className,i,!1,t)}getByTag(t,i){return this.getByMethod(this.methods.tag,i,!1,t)}getByMethod(t,i,s,r){const n=s?null:[];return this.eachFind(this.toChildren(i),t,n,r),n||this.findLeaf}eachFind(t,i,s,r){let n,o;for(let a=0,h=t.length;a<h;a++){if(n=t[a],o=i(n,r),typeof o=="boolean"&&(o=o?1:0),o===ly||o===uy){if(!s)return void(this.findLeaf=n);s.push(n)}n.isBranch&&o<dy&&this.eachFind(n.children,i,s,r)}}toChildren(t){return this.findLeaf=null,[t||this.target]}__onRemoveChild(t){const{id:i,innerId:s}=t.child;this.idMap[i]&&delete this.idMap[i],this.innerIdMap[s]&&delete this.innerIdMap[s]}__checkIdChange(t){if(t.attrName==="id"){const i=t.oldValue;this.idMap[i]&&delete this.idMap[i]}}__listenEvents(){this.__eventIds=[this.target.on_(_t.REMOVE,this.__onRemoveChild,this),this.target.on_(Pe.CHANGE,this.__checkIdChange,this)]}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}destroy(){const{__eventIds:t}=this;t&&t.length&&(this.__removeListenEvents(),this.innerIdMap={},this.idMap={}),this.findLeaf=null}}const Hl=m.prototype;function Vl(e){return e.leafer?e.leafer.selector:S.selector||(S.selector=at.selector())}Hl.find=function(e,t){return Vl(this).getBy(e,this,!1,t)},Hl.findOne=function(e,t){return Vl(this).getBy(e,this,!0,t)},vt.add("find"),at.finder=function(e){return new cy(e)};var ql;(function(e){e[e.none=1]="none",e[e.free=2]="free",e[e.mirrorAngle=3]="mirrorAngle",e[e.mirror=4]="mirror"})(ql||(ql={}));export{ai as $,Ei as F,gt as K,Ti as M,Xe as Q,Ni as W,U as _,m as c,Ne as f,se as g,bs as h,S as m,Kt as p,tr as t,hi as w};
//# sourceMappingURL=leafer-BCB2pN9R.js.map
