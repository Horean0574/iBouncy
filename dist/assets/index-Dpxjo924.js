import{w as L,_ as x,m as k,$ as Y,M as j,g as M,h as H,W as m,F as R,K as V,f as G,Q as K,p as C}from"./leafer-DG9LaDwU.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();class W{#t="init";measured=0;refreshRateBucket=new Map;constructor(t={}){this.ENV=t,this.gameOver=this.gameOver.bind(this)}get bw(){return document.body.clientWidth}get bh(){return document.body.clientHeight}state(t){this.#t=t}at(...t){for(let s of t)if(this.#t===s)return!0;return!1}async initializeAll(){await Promise.all([g.init(),w.init()])}renderAll(){U.render(),l.render(),a.render(),y.render(),g.render(),E.render()}measureRefreshRate(t){if(this.measured>=20)return;const s=Math.round(60/t),e=this.refreshRateBucket.get(s);if(e===void 0?this.refreshRateBucket.set(s,1):this.refreshRateBucket.set(s,e+1),++this.measured>=20){let n=0,r=0;for(let[h,f]of this.refreshRateBucket.entries())f>=n&&(n=f,r=h);this.refreshRateBucket.clear(),i.ENV.refreshRate=r,i.ENV.fixedStep=1e3/r,i.ENV.actUnitInterval=(1e3/r).toFixed(1),i.state("init2")}}async fontInitializer(t,s){const e=new FontFace(t,`url(${s}.woff2)`);try{await e.load(),document.fonts.add(e),d.forceRender()}catch{const n=new FontFace(t,`url(${s}.woff)`);try{await n.load(),document.fonts.add(n),d.forceRender()}catch(r){console.error(r)}}}reset(){I.cull(),w.cull(),y.reset(),g.reset(),l.reset(),a.reset()}pause(){this.at("paused","prepared","over")||this.#t.startsWith("init")||(this.state("paused"),u.pauseAll())}resume(){this.at("playing","prepared","over")||this.#t.startsWith("init")||(this.state("playing"),T(performance.now()),u.resumeAll())}gameOver(t=!1){return this.at("over")||(this.state("over"),y.stop(),I.render(),t?w.win():w.fail()),!0}loadingFadeOut(){z.animate([{opacity:0}],{duration:300,fill:"both"})}}class q{collisionStat=0;accelerateCD=50;prevAccelerateTime;borderDetect(t,{bounce:s=!1,paddings:e=[0,0,0,0],callbacks:n=[null,null,null,null]}={}){const r=s?-1:0;t.x<e[3]?n[3]?.()===void 0&&(t.x=e[3],t.vx*=r):t.ox>i.bw-e[1]&&n[1]?.()===void 0&&(t.ox=i.bw-e[1],t.vx*=r),t.y<e[0]?n[0]?.()===void 0&&(t.y=e[0],t.vy*=r):t.oy>i.bh-e[2]&&n[2]?.()===void 0&&(t.oy=i.bh-e[2],t.vy*=r)}collisionDetect(){if(!this.#t())return this.collisionStat=0,!1;if(this.collisionStat)return!1;let t=!1;return a.cx>=l.x&&a.cx<=l.ox&&(this.collisionStat=1,t=!0,a.vy*=-this.tempAccelerate("y"),p(a.cy-l.y)<=p(a.cy-l.oy)?a.oy=l.y:a.y=l.oy),a.cy>=l.y&&a.cy<=l.oy&&(this.collisionStat=1,t=!0,a.vx*=-this.tempAccelerate("x"),p(a.cx-l.x)<=p(a.cx-l.ox)?a.ox=l.x:a.x=l.ox),t?!0:this.handleCornerCollisions()}handleCornerCollisions(){return a.cx<l.x&&a.cy<l.y?this.cornerCollision(!1,!1):a.cx>l.ox&&a.cy<l.y?this.cornerCollision(!0,!1):a.cx>l.ox&&a.cy>l.oy?this.cornerCollision(!0,!0):a.cx<l.x&&a.cy>l.oy?this.cornerCollision(!1,!0):!1}cornerCollision(t,s){const[e,n]=t?["ox","x"]:["x","ox"],[r,h]=s?["oy","y"]:["y","oy"],f=a.w/2,P=a.cx-l[e],D=a.cy-l[r];return P**2+D**2<=f**2?(this.collisionStat=1,p(D)>=p(P)?(a[h]=l[r],a.vy*=-this.tempAccelerate("y")):(a[n]=l[e],a.vx*=-this.tempAccelerate("x")),!0):!1}tempAccelerate(t){if(t!=="x"&&t!=="y")return 0;const s=performance.now();if(this.prevAccelerateTime===void 0)this.prevAccelerateTime=s;else{if(s-this.prevAccelerateTime<this.accelerateCD)return 1;this.prevAccelerateTime=s}const e="v"+t,n=t==="x"?1.5:1.2,r=t==="x"?.6:.25,h=n-Math.sign(a[e])*l[e]*r/l[e+"Max"],f=Math.pow(h,1/6);return u.newInterval(function(){a[e]/=f},16.7,{delay:200,executeTimes:6}),h}#t(){return!(a.ox<l.x||a.x>l.ox||a.oy<l.y||a.y>l.oy)}}class X{constructor(){this.elements=new Map,this.head=0,this.tail=0}push(t){this.elements.set(this.tail,t),++this.tail}pop(){if(this.isEmpty)return null;const t=this.elements.get(this.head);return this.elements.delete(this.head),++this.head,t}front(){return this.elements.get(this.head)}clear(){this.elements.clear(),this.head=this.tail=0}get length(){return this.tail-this.head}get isEmpty(){return this.length===0}}class ${#t=new Map;#s=new Set;#e=new Map;#a=new Set;#n;#r=new X;#h=0;#c=0;#l=NaN;#d=0;#i={minInterval:16.7,autoHandleFPS:!1,FPSHandleInterval:33.3,FPSUpdateInterval:300};constructor(t={}){this.#i={...this.#i,...t},this.#i.autoHandleFPS&&this.initFPSHandler()}get MIN_INTERVAL(){return this.#i.minInterval}set MIN_INTERVAL(t){this.#i.minInterval=t}timeDetect(t){this.#f(t),this.#m(t)}#f(t){for(let s of this.#t.keys()){const e=this.#t.get(s);if(e.terminate){this.#s.add(s);continue}e.paused||t-e.start>=e.duration&&(this.#s.add(s),e.callback())}for(let s of this.#s)this.#t.delete(s);this.#s.clear()}#m(t){for(let s of this.#e.keys()){const e=this.#e.get(s);if(e.terminate){this.#a.add(s);continue}if(!e.paused&&!(t<e.start)&&(e.options.recFramesCnt&&++e.data.framesCnt,e.options.recElapsedTime&&(e.data.elapsed=t-e.start),t-e.step>=e.duration)){if(++e.data.cnt,e.callback(e.data),e.data.cnt>=e.options.executeTimes){this.#a.add(s);continue}e.step+=e.duration}}for(let s of this.#a)this.#e.delete(s);this.#a.clear()}newTimeout(t,s=this.#i.minInterval){s=Math.max(s,this.#i.minInterval);const e=Symbol("Timeout"),n=performance.now();let r={callback:t,start:n,pause:n,duration:s,paused:!1,terminate:!1};return this.#t.set(e,r),e}cancelTimeout(t){this.#t.get(t).terminate=!0}newInterval(t,s=this.#i.minInterval,e={}){e=Object.assign({delay:0,executeTimes:1/0,recFramesCnt:!1,recElapsedTime:!1},e),s=Math.max(s,this.#i.minInterval);const n=Symbol("Interval"),r=performance.now();let h={callback:t,start:r+e.delay,step:r+e.delay,pause:r+e.delay,duration:s,paused:!1,terminate:!1,options:e,data:{cnt:0,framesCnt:0,elapsed:0}};return this.#e.set(n,h),n}cancelInterval(t){this.#e.get(t).terminate=!0}pause(t){const s=this.#u(t);if(s==="Timeout"){const e=this.#t.get(t);if(e.paused)return;e.paused=!0,e.pause=performance.now()}else if(s==="Interval"){const e=this.#e.get(t);if(e.paused)return;e.paused=!0,e.pause=performance.now()}}resume(t){const s=this.#u(t);if(s==="Timeout"){const e=this.#t.get(t);if(!e.paused)return;e.paused=!1,e.start+=performance.now()-e.pause}else if(s==="Interval"){const e=this.#e.get(t);if(!e.paused)return;e.paused=!1,e.step+=performance.now()-e.pause}}pauseAll(){for(let t of this.#t.keys())this.pause(t);for(let t of this.#e.keys())this.pause(t)}resumeAll(){for(let t of this.#t.keys())this.resume(t);for(let t of this.#e.keys())this.resume(t)}#u(t){const s=t.toString();return s.substring(7,s.length-1)}initFPSHandler(){this.#o()||(this.#n=this.newInterval(t=>{for(this.#r.push([t.elapsed,t.framesCnt]);t.elapsed-this.#r.front()[0]>1e3;)this.#r.pop();this.#h=t.framesCnt,this.#c=t.elapsed},this.#i.FPSHandleInterval,{recFramesCnt:!0,recElapsedTime:!0}))}destroyFPSHandler(){this.#o()&&(this.cancelInterval(this.#n),this.#n=null,this.#r.clear())}#o(){return this.#n!==void 0&&this.#n!==null}#y(){const t=this.#h-this.#r.front()[1],s=1e3/(this.#c-this.#r.front()[0]);return(t*s).toFixed(1)}get FPS(){if(!this.#o()||this.#r.isEmpty)return this.#l=NaN;const t=performance.now();return t-this.#d<this.#i.FPSUpdateInterval?this.#l:(this.#d=t,this.#l=this.#y())}}class c{#t;constructor(t,s=0){this.el=t,this.el.zIndex=this.#t=s}get w(){return this.el.width}set w(t){this.el.width=t}get h(){return this.el.height}set h(t){this.el.height=t}get cx(){return this.el.x+this.el.width/2}set cx(t){this.el.x=t-this.el.width/2}get cy(){return this.el.y+this.el.height/2}set cy(t){this.el.y=t-this.el.height/2}get x(){return this.el.x}set x(t){this.el.x=t}get ox(){return this.el.x+this.el.width}set ox(t){this.el.x=t-this.el.width}get y(){return this.el.y}set y(t){this.el.y=t}get oy(){return this.el.y+this.el.height}set oy(t){this.el.y=t-this.el.height}destroy(){this.el.destroy()}render(t=void 0){Number.isInteger(t)?this.el.zIndex=t:this.el.zIndex=this.#t,d.add(this.el)}cull(){this.el.remove()}show(){this.el.visible=!0}hide(){this.el.visible=!1}toggle(){this.el.visible=!this.el.visible}}class Z extends c{#t={fill:"#666",opacity:.6,fadeInDuration:.8};constructor(){super(new L({x:0,y:0,width:i.bw,height:i.bh,fill:"#666",opacity:0,animationOut:{style:{opacity:0},duration:.5,join:!0}}),990),this.el.fill=this.#t.fill,this.el.animation={style:{opacity:this.#t.opacity},duration:this.#t.fadeInDuration,join:!0}}relocate(t){this.w=t.width,this.h=t.height}render(t=void 0,s=void 0,e=void 0,n=void 0){t===void 0?this.el.fill=this.#t.fill:this.el.fill=t,s===void 0?this.el.opacity=0:this.el.opacity=s,e===void 0?this.el.animation.style.opacity=this.#t.opacity:this.el.animation.style.opacity=e,n===void 0?this.el.animation.duration=this.#t.fadeInDuration:this.el.animation.duration=n,d.add(this.el)}}class N extends c{constructor(t,s=0){t.around="center",super(t,s)}get cx(){return this.el.x}set cx(t){this.el.x=t}get cy(){return this.el.y}set cy(t){this.el.y=t}get x(){return this.el.x-this.el.width/2}set x(t){this.el.x=t+this.el.width/2}get y(){return this.el.y-this.el.height/2}set y(t){this.el.y=t+this.el.height/2}get ox(){return this.el.x+this.el.width/2}set ox(t){this.el.x=t-this.el.width/2}get oy(){return this.el.y+this.el.height/2}set oy(t){this.el.y=t-this.el.height/2}}class _ extends N{constructor(){super(new x({x:i.bw/2,y:i.bh/3,text:"",fontSize:128,fontFamily:"HYBeiBingYang-W",scale:.5,opacity:.6,animation:{style:{scale:1,opacity:1},duration:.4,join:!0},animationOut:{style:{scale:.4,opacity:.2},duration:.3,join:!0}}),991),this.init=this.init.bind(this)}relocate(t){this.cx=t.width/2,this.cy=t.height/2-64}init(){return Promise.all([this.#t(),this.#s()])}async#t(){await i.fontInitializer("HYBeiBingYang-W","./assets/fonts/HYBeiBingYang-W")}async#s(){await Promise.all([this.#e("./assets/img/GL.jpg","leafer://GL.jpg"),this.#e("./assets/img/DL.jpg","leafer://DL.jpg")])}async#e(t,s){let e=await k.origin.loadImage(t);Y.setImage(s,e)}win(){this.el.text=" You Win! ",this.#a("leafer://GL.jpg"),this.#n("#FFEF00"),this.render()}fail(){this.el.text=" FAIL ",this.#a("leafer://DL.jpg"),this.#n("#474746"),this.render()}#a(t){this.el.fill={type:"image",url:t,offset:{y:-50}}}#n(t){this.el.shadow={x:0,y:0,blur:25,color:t}}}class Q extends c{constructor(){super(new x({x:12,y:i.bh-24,fontSize:12,fill:"#777",text:"FPS: --"}))}relocate(t){t.height!==t.old.height&&(this.y=t.height-24)}assign(t){isNaN(t)&&(t="--"),this.el.text="FPS: "+t}}class J extends c{constructor(){super(new j({points:[0,i.bh,0,0,i.bw,0,i.bw,i.bh,i.bw-i.ENV.paddingSide,i.bh,i.bw-i.ENV.paddingSide,i.ENV.paddingTop,i.ENV.paddingSide,i.ENV.paddingTop,i.ENV.paddingSide,i.bh],fill:"#E85B5B87"}))}relocate(t){this.el.points=[0,t.height,0,0,t.width,0,t.width,t.height,t.width-i.ENV.paddingSide,t.height,t.width-i.ENV.paddingSide,i.ENV.paddingTop,i.ENV.paddingSide,i.ENV.paddingTop,i.ENV.paddingSide,t.height]}}class F extends c{alarm;remaining=i.ENV.timeLimit;animatingFlag=!1;constructor(){super(new M({x:15,y:15})),this.Icon=new c(new H({path:"M511.488 0C228.864 0 0 229.376 0 512s228.864 512 511.488 512C794.624 1024 1024 794.624 1024 512s-229.376-512-512.512-512z m21.76 556.416V219.52H438.912v392.32h1.472l243.84 140.8 47.296-81.728-198.144-114.432zM512 921.6A409.472 409.472 0 0 1 102.4 512c0-226.304 183.296-409.6 409.6-409.6 226.304 0 409.6 183.296 409.6 409.6 0 226.304-183.296 409.6-409.6 409.6z",x:0,y:0,scale:.015625,fill:"#262626"})),this.IconG=new c(new M({x:0,y:0,width:16,height:16,origin:"center",children:[this.Icon.el]})),this.Text=new c(new x({x:20,y:0,fontSize:16,lineHeight:16,text:"3:00",fill:"#262626"})),this.el.add([this.IconG.el,this.Text.el])}reset(){this.remaining=i.ENV.timeLimit,this.animatingFlag=!1,this.Text.el.text=F.toMSString(i.ENV.timeLimit),this.Text.el.fontWeight="normal",this.Text.el.fill=this.Icon.el.fill="#262626"}start(){this.alarm=u.newInterval(this.#t.bind(this),1e3)}stop(){u.cancelInterval(this.alarm),this.animatingFlag&&(this.animatingFlag=!1,this.IconG.el.killAnimate())}static toMS(t){return[v(t/60),t%60]}static toMSString(t){const s=t%60;return`${v(t/60)}:${s<10?"0"+s:s}`}#t(){--this.remaining<0||(this.Text.el.text=F.toMSString(this.remaining),!this.animatingFlag&&this.remaining<=15&&(this.animatingFlag=!0,this.IconG.el.animate([{style:{rotation:35,y:0},duration:.1},{style:{rotation:-35,y:-3},duration:.1},{style:{rotation:25,y:-3},duration:.1},{style:{rotation:-25,y:0},duration:.1}],{loop:!0,loopDelay:.6,join:!0}),this.Icon.el.fill=this.Text.el.fill="#44C2F1",this.Text.el.fontWeight="bold"),this.remaining<=0&&i.gameOver(!0))}}class b extends c{v=0;constructor(){super(new M({x:i.bw/2-120,y:0})),this.Panel=new c(new H({path:`m -120 0
  h 10
  a 20 15 0 0 1 20 15
  v 35
  a 15 18 0 0 0 15 18
  h 150
  a 15 18 0 0 0 15 -18
  v -35
  a 20 15 0 0 1 20 -15
  h 10
  Z`,x:120,y:0,fill:"#777A"})),this.Integer=new c(new x({x:-i.bw,y:7,fontSize:40,fill:"#FFF",text:"-",fontFamily:"HYDiSiKe-U"})),this.Decimal=new c(new x({x:-i.bw,y:15,fontSize:32,fill:"#DDD",text:"--",fontFamily:"HYDiSiKe-U"})),this.el.add([this.Panel.el,this.Integer.el,this.Decimal.el]),this.init=this.init.bind(this)}reset(){this.assign(0)}relocate(t){t.width!==t.old.width&&(this.cx=t.width/2,this.#e())}async init(){await this.#t()}async#t(){await i.fontInitializer("HYDiSiKe-U","./assets/fonts/HYDiSiKe-U"),this.#e()}assign(t){return this.v=Math.round(t*10),this.#e(),b.stringify(this.v)}delta(t){const s=this.v;return this.v+=Math.round(t*10),this.#e(),b.stringify(this.v-s)}tip(t){const[s,e,n]=this.#s(),r=new N(new x({x:a.cx+s,y:a.oy,text:"+"+t,fill:"#FFEF00",stroke:"#33333333",fontSize:20,fontFamily:"HYDiSiKe-U",opacity:.9,shadow:{x:1,y:1,blur:10,color:"gray"},animation:{keyframes:[{style:{opacity:.9,fontSize:24},duration:.3},{style:{opacity:0,fontSize:25},duration:.4}],join:!0}}));r.render(),r.el.animate([{offsetX:e}],{duration:.45,easing:"sine-out",join:!0}),r.el.animate([{style:{offsetY:-12},duration:.12,easing:"quad-out"},{style:{offsetY:n},duration:.28,easing:"quad-in-out"}],{join:!0}),u.newTimeout(function(){r.destroy()},600)}#s(){const t=.7*a.vx*600/i.ENV.actUnitInterval;let s=Math.random()>=.5?1:-1,e=(10+Math.random()*20)*s,n=(40+Math.random()*20)*s,r=(Math.random()-.4)*24;const h=e+n+t;return(a.cx+h<=i.ENV.paddingSide||a.cx+h>=i.bw-i.ENV.paddingSide)&&(e*=-1,n*=-1),[e+t/2,n+t/2,r]}#e(){this.Integer.el.text=v(this.v/10),this.Decimal.el.text="."+this.v%10,this.Integer.x=(240-this.Integer.w-this.Decimal.w)/2,this.Decimal.x=this.Integer.ox}static stringify(t){return`${v(t/10)}.${t%10}`}}class tt extends c{vxMax;vyMax;vx;vy;availZone=[80,40,0,40];constructor(){super(new L({width:120,height:25,fill:"#32CD79"}))}reset(){this.vxMax=6,this.vyMax=2.8,this.vx=0,this.vy=0,this.cx=i.bw/2,this.y=i.bh-140}frameLoop(t){this.vx=this.vy=0,(m.isHold("KeyW")||m.isHold("ArrowUp"))&&(this.vy-=this.vyMax*t),(m.isHold("KeyS")||m.isHold("ArrowDown"))&&(this.vy+=this.vyMax*t),(m.isHold("KeyA")||m.isHold("ArrowLeft"))&&(this.vx-=this.vxMax*t),(m.isHold("KeyD")||m.isHold("ArrowRight"))&&(this.vx+=this.vxMax*t),this.x+=this.vx,this.y+=this.vy,A.borderDetect(l,{paddings:this.availZone})}}class et{length=8;dotRadius=5.5;loopIdx=0;dotIdx=-1;dots=new Map;activeAnimations=new Map;framesInterval=5;constructor(){for(let t=0;t<this.length;++t)this.dots.set(t,new N(new R({x:-100,y:-100,width:this.dotRadius*2,height:this.dotRadius*2,fill:"#FF4500BA",visible:!1})))}render(){for(let t of this.dots.values())d.add(t.el)}prepare(){i.ENV.actUnitInterval>=25?this.framesInterval=st(94/i.ENV.actUnitInterval):this.framesInterval=v(94/i.ENV.actUnitInterval)}frameLoop(t){if(this.loopIdx=(this.loopIdx+1)%this.framesInterval,this.loopIdx===0){const s=this.dotIdx=(this.dotIdx+1)%this.length,e=this.dots.get(s);if(e.w=e.h=this.dotRadius*2,e.el.opacity=1,e.cx=a.cx,e.cy=a.cy,e.el.visible=!0,this.activeAnimations.has(s)){const r=this.activeAnimations.get(s);r.off(V.COMPLETED),d.killAnimate(r),this.activeAnimations.delete(s)}const n=e.el.animate([{opacity:1,width:this.dotRadius*2,height:this.dotRadius*2},{opacity:.3,width:5,height:5}],{duration:i.ENV.stdUnitInterval*this.framesInterval*this.length/t/1e3,easing:"linear"});n.on(V.COMPLETED,()=>{this.activeAnimations.delete(s),e.el.visible=!1,e.w=e.h=this.dotRadius*2,e.el.opacity=1}),this.activeAnimations.set(s,n)}}}class it extends c{vx;ax;ay;timeDivisor=1;constructor(){super(new R({width:20,height:20,fill:"#20A8D7"})),this.trailing=new et}reset(){this.vx=(Math.random()*2.7+.8)*(Math.random()>.5?1:-1),this.vy=3.5,this.ax=127e-6,this.ay=143e-6,this.cx=i.bw/2,this.cy=i.bh/4}render(){this.trailing.render(),d.add(this.el)}prepare(){this.trailing.prepare()}frameLoop(t){y.remaining>=70&&y.remaining<160&&(this.vx*=(1+this.ax)**t,this.vy*=(1+this.ay)**t,this.ax*=.99987,this.ay*=.99987),this.x+=this.vx*t,this.y+=this.vy*t,A.borderDetect(this,{bounce:!0,paddings:[0,0,-this.h*3,0],callbacks:[null,null,i.gameOver,null]}),this.trailing.frameLoop(this.timeDivisor)}}const p=Math.abs,st=Math.ceil,v=Math.floor;let B;function T(o){B=o}const z=document.querySelector("#loading"),d=new G({view:document.querySelector("canvas"),fill:"#EFF"}),i=new W({refreshRate:60,actUnitInterval:16.7,stdUnitInterval:16.7,fixedStep:16.7,maxStepPerFrame:10,paddingTop:80,paddingSide:40,timeLimit:180}),A=new q,u=new $({minInterval:0,autoHandleFPS:!0}),I=new Z,w=new _,E=new Q,U=new J,y=new F,g=new b,l=new tt,a=new it;z.addEventListener("dragstart",o=>o.preventDefault());let S=0;I.render("#FFF",1,.7,.4);nt();i.renderAll();requestAnimationFrame(at);u.newInterval(()=>E.assign(u.FPS),400);i.initializeAll().then(()=>i.state("init1")).catch(o=>console.error(`Initialization failed...
`,o));function nt(){y.reset(),l.reset(),a.reset()}function at(o){T(o),O(o)}function O(o){const t=o-B;T(o),u.timeDetect(o),i.at("init1")?i.measureRefreshRate(t/i.ENV.stdUnitInterval):i.at("init2")?(a.prepare(),i.state("almost-prepared")):i.at("almost-prepared")&&(i.state("prepared"),I.cull(),i.loadingFadeOut());let s=1;if(i.at("playing"))for(S+=Math.min(t,3e3),a.timeDivisor=Math.min(v(S/i.ENV.fixedStep),i.ENV.maxStepPerFrame);S>=i.ENV.fixedStep&&s<=i.ENV.maxStepPerFrame;){S-=i.ENV.fixedStep,++s;const e=i.ENV.fixedStep/i.ENV.stdUnitInterval;if(a.frameLoop(e),l.frameLoop(e),A.collisionDetect()&&a.vy<0){const n=Math.sqrt(a.vx**2+a.vy**2),r=Math.log2(n)+1/Math.cos(Math.PI/20*n),h=p(l.cx-a.cx),f=Math.cos(Math.PI/l.w*2*h)+.5;g.tip(g.delta(.7*r+.3*f))}}requestAnimationFrame(O)}document.addEventListener("visibilitychange",function(){document.hidden?i.pause():i.resume()});d.on(K.RESIZE,function(o){I.relocate(o),w.relocate(o),E.relocate(o),U.relocate(o),g.relocate(o)});d.on(C.HOLD,function(o){o.code==="Semicolon"&&E.toggle()});d.on(C.UP,function(o){o.code==="Space"&&(i.at("prepared")?(i.state("playing"),y.start()):i.at("over")&&(i.reset(),i.state("playing"),y.start()))});
//# sourceMappingURL=index-Dpxjo924.js.map
