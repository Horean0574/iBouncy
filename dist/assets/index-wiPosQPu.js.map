{"version":3,"file":"index-wiPosQPu.js","sources":["../../src/core/UIExtensions.js","../../src/core/processor.js","../../src/core/interaction.js","../../src/utils/Queue.js","../../src/utils/EmbeddedTimer.js","../../src/elements/E_Mask.js","../../src/elements/E_Menu.js","../../src/elements/E_Settlement.js","../../src/elements/E_FPS.js","../../src/elements/E_ForbiddenZone.js","../../src/elements/E_Timing.js","../../src/elements/E_Scoring.js","../../src/elements/E_Tablet.js","../../src/elements_extensions/X_BallTrailing.js","../../src/elements/E_Ball.js","../../src/core/instances.js","../../src/app.js"],"sourcesContent":["import { UI } from \"leafer-game\";\r\nimport { leafer } from \"./instances\";\r\n\r\nexport default function extendUI() {\r\n    const extensions = {\r\n        w: {\r\n            get() {\r\n                return this.width;\r\n            },\r\n            set(v) {\r\n                this.width = v;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        h: {\r\n            get() {\r\n                return this.height;\r\n            },\r\n            set(v) {\r\n                this.height = v;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        ox: {\r\n            get() {\r\n                return this.x + this.width;\r\n            },\r\n            set(v) {\r\n                this.x = v - this.width;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        oy: {\r\n            get() {\r\n                return this.y + this.height;\r\n            },\r\n            set(v) {\r\n                this.y = v - this.height;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        cx: {\r\n            get() {\r\n                return this.x + this.width / 2;\r\n            },\r\n            set(v) {\r\n                this.x = v - this.width / 2;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        cy: {\r\n            get() {\r\n                return this.y + this.height / 2;\r\n            },\r\n            set(v) {\r\n                this.y = v - this.height / 2;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        lx: { // use in center positioning, the same effect as \"x\" in top-left positioning\r\n            get() {\r\n                return this.x - this.width / 2;\r\n            },\r\n            set(v) {\r\n                this.x = v + this.width / 2;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        rx: { // use in center positioning, the same effect as \"ox\" in top-left positioning\r\n            get() {\r\n                return this.x + this.width / 2;\r\n            },\r\n            set(v) {\r\n                this.x = v - this.width / 2;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        ty: { // use in center positioning, the same effect as \"y\" in top-left positioning\r\n            get() {\r\n                return this.y - this.height / 2;\r\n            },\r\n            set(v) {\r\n                this.y = v + this.height / 2;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        by: { // use in center positioning, the same effect as \"oy\" in top-left positioning\r\n            get() {\r\n                return this.y + this.height / 2;\r\n            },\r\n            set(v) {\r\n                this.y = v - this.height / 2;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        },\r\n        render_: {\r\n            value: function () {\r\n                leafer.add(this);\r\n            },\r\n            writable: true,\r\n            enumerable: false,\r\n            configurable: true,\r\n        },\r\n        cull_: {\r\n            value: function () {\r\n                leafer.remove(this);\r\n            },\r\n            writable: true,\r\n            enumerable: false,\r\n            configurable: true,\r\n        },\r\n        show_: {\r\n            value: function () {\r\n                this.visible = true;\r\n            },\r\n            writable: true,\r\n            enumerable: false,\r\n            configurable: true,\r\n        },\r\n        hide_: {\r\n            value: function () {\r\n                this.visible = false;\r\n            },\r\n            writable: true,\r\n            enumerable: false,\r\n            configurable: true,\r\n        },\r\n        toggle_: {\r\n            value: function () {\r\n                this.visible = !this.visible;\r\n            },\r\n            writable: true,\r\n            enumerable: false,\r\n            configurable: true,\r\n        },\r\n    };\r\n    Object.defineProperties(UI.prototype, extensions);\r\n}\r\n","import {\r\n    setPrevTimeStamp,\r\n    loading,\r\n    Ball,\r\n    ForbiddenZone,\r\n    FPS,\r\n    GP,\r\n    leafer,\r\n    Mask,\r\n    Menu,\r\n    Scoring,\r\n    Settlement,\r\n    Tablet,\r\n    timer,\r\n    Timing,\r\n} from \"./instances\";\r\nimport { Platform, Resource } from \"leafer-game\";\r\n\r\nexport default class Processor {\r\n    #SM = \"init\"; // state machine\r\n    measured = 0;\r\n    refreshRateBucket = new Map();\r\n\r\n    constructor(ENV = {}) {\r\n        this.ENV = ENV;\r\n        this.gameOver = this.gameOver.bind(this);\r\n    }\r\n\r\n    get bw() {\r\n        return document.body.clientWidth;\r\n    }\r\n\r\n    get bh() {\r\n        return document.body.clientHeight;\r\n    }\r\n\r\n    state(newState) {\r\n        this.#SM = newState;\r\n    }\r\n\r\n    at(...states) {\r\n        for (let s of states) if (this.#SM === s) return true;\r\n        return false;\r\n    }\r\n\r\n    async initializeAll() {\r\n        await Promise.all([\r\n            Menu.init(),\r\n            Scoring.init_(),\r\n            Settlement.init(),\r\n        ]);\r\n    }\r\n\r\n    renderAll() {\r\n        ForbiddenZone.render_();\r\n        Tablet.render_();\r\n        Ball.render_();\r\n        Timing.render_();\r\n        Scoring.render_();\r\n        FPS.render_();\r\n    }\r\n\r\n    measureRefreshRate(prog) {\r\n        if (this.measured >= 20) return;\r\n        const rrKey = Math.round(60 / prog);\r\n        const curValue = this.refreshRateBucket.get(rrKey);\r\n        if (curValue === undefined) {\r\n            this.refreshRateBucket.set(rrKey, 1);\r\n        } else {\r\n            this.refreshRateBucket.set(rrKey, curValue + 1);\r\n        }\r\n        if (++this.measured >= 20) {\r\n            let maxV = 0;\r\n            let k4maxV = 0;\r\n            for (let [k, v] of this.refreshRateBucket.entries()) {\r\n                if (v >= maxV) {\r\n                    maxV = v;\r\n                    k4maxV = k;\r\n                }\r\n            }\r\n            this.refreshRateBucket.clear();\r\n            GP.ENV.refreshRate = k4maxV;\r\n            GP.ENV.fixedStep = 1000 / k4maxV;\r\n            GP.ENV.actUnitInterval = (1000 / k4maxV).toFixed(1);\r\n            GP.state(\"init2\");\r\n        }\r\n    }\r\n\r\n    async fontInitializer(name, src) {\r\n        const font = new FontFace(name, `url(${src}.woff2)`);\r\n        try {\r\n            await font.load();\r\n            document.fonts.add(font);\r\n            leafer.forceRender();\r\n        } catch {\r\n            const font2 = new FontFace(name, `url(${src}.woff)`);\r\n            try {\r\n                await font2.load();\r\n                document.fonts.add(font2);\r\n                leafer.forceRender();\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n    }\r\n\r\n    async ImageInitializer(name, src) {\r\n        let img = await Platform.origin.loadImage(src);\r\n        Resource.setImage(`leafer://${name}`, img);\r\n    }\r\n\r\n    reset() {\r\n        Mask.cull_();\r\n        Settlement.cull_();\r\n        Timing.reset_();\r\n        Scoring.reset_();\r\n        Tablet.reset_();\r\n        Ball.reset_();\r\n    }\r\n\r\n    start() {\r\n        Mask.cull_();\r\n        Menu.cull_();\r\n    }\r\n\r\n    pause() {\r\n        if (this.at(\"paused\", \"prepared\", \"over\") || this.#SM.startsWith(\"init\")) return;\r\n        this.state(\"paused\");\r\n        timer.pauseAll();\r\n    }\r\n\r\n    resume() {\r\n        if (this.at(\"playing\", \"prepared\", \"over\") || this.#SM.startsWith(\"init\")) return;\r\n        this.state(\"playing\");\r\n        setPrevTimeStamp(performance.now());\r\n        timer.resumeAll();\r\n    }\r\n\r\n    gameOver(win = false) {\r\n        if (this.at(\"over\")) return true;\r\n        this.state(\"over\");\r\n        Timing.stop_();\r\n        Mask.render_();\r\n        if (win) Settlement.win();\r\n        else Settlement.fail();\r\n        return true;\r\n    }\r\n\r\n    loadingFadeOut() {\r\n        loading.animate([\r\n            { opacity: 0 },\r\n        ], {\r\n            duration: 300,\r\n            fill: \"both\",\r\n        });\r\n    }\r\n}\r\n","import { Ball, GP, Tablet, timer } from \"./instances\";\r\n\r\nexport default class Interaction {\r\n    collisionStat = 0;\r\n    accelerateCD = 50;\r\n    prevAccelerateTime;\r\n\r\n    borderDetect(ge, {\r\n        bounce = false,\r\n        paddings = [0, 0, 0, 0], // Top, Right, Bottom, Left\r\n        callbacks = [null, null, null, null],\r\n    } = {}) {\r\n        const bounceRatio = bounce ? -1 : 0;\r\n        if (ge.x < paddings[3]) {\r\n            if (callbacks[3]?.() === void 0) {\r\n                ge.x = paddings[3];\r\n                ge.vx *= bounceRatio;\r\n            }\r\n        } else if (ge.ox > GP.bw - paddings[1]) {\r\n            if (callbacks[1]?.() === void 0) {\r\n                ge.ox = GP.bw - paddings[1];\r\n                ge.vx *= bounceRatio;\r\n            }\r\n        }\r\n        if (ge.y < paddings[0]) {\r\n            if (callbacks[0]?.() === void 0) {\r\n                ge.y = paddings[0];\r\n                ge.vy *= bounceRatio;\r\n            }\r\n        } else if (ge.oy > GP.bh - paddings[2]) {\r\n            if (callbacks[2]?.() === void 0) {\r\n                ge.oy = GP.bh - paddings[2];\r\n                ge.vy *= bounceRatio;\r\n            }\r\n        }\r\n    }\r\n\r\n    collisionDetect() {\r\n        if (!this.#preciselyDetect()) {\r\n            this.collisionStat = 0;\r\n            return false;\r\n        }\r\n        if (this.collisionStat) return false;\r\n        this.collisionStat = 1;\r\n        const overlapX = Math.min(Ball.ox, Tablet.ox) - Math.max(Ball.x, Tablet.x);\r\n        const overlapY = Math.min(Ball.oy, Tablet.oy) - Math.max(Ball.y, Tablet.y);\r\n        const sameXDirection = (Ball.vx ^ Ball.cx - Tablet.cx) > 0;\r\n        const sameYDirection = (Ball.vy ^ Ball.cy - Tablet.cy) > 0;\r\n        if (sameXDirection && sameYDirection) {\r\n            Ball.x += Ball.vx * 1.5;\r\n            Ball.y += Ball.vy * 1.5;\r\n            Ball.vx *= this.tempAccelerate(\"x\");\r\n            Ball.vy *= this.tempAccelerate(\"y\");\r\n        } else if (sameYDirection || (overlapX < overlapY && !sameXDirection)) {\r\n            if (Ball.cx < Tablet.cx) Ball.ox = Tablet.x;\r\n            else Ball.x = Tablet.ox;\r\n            Ball.vx *= -this.tempAccelerate(\"x\");\r\n        } else {\r\n            if (Ball.cy < Tablet.cy) Ball.oy = Tablet.y;\r\n            else Ball.y = Tablet.oy;\r\n            Ball.vy *= -this.tempAccelerate(\"y\");\r\n        }\r\n        return true;\r\n    }\r\n\r\n    tempAccelerate(direction) {\r\n        if (direction !== \"x\" && direction !== \"y\") return 0;\r\n        const now = performance.now();\r\n        if (this.prevAccelerateTime !== void 0 && now - this.prevAccelerateTime < this.accelerateCD) return 1;\r\n        this.prevAccelerateTime = now;\r\n        const vName = \"v\" + direction;\r\n        const ratio1 = direction === \"x\" ? 1.5 : 1.2;\r\n        const ratio2 = direction === \"x\" ? 0.6 : 0.25;\r\n        const vBuff = ratio1 - Math.sign(Ball[vName]) * Tablet[vName] * ratio2 / Tablet[vName + \"Max\"];\r\n        const vUnitNerf = vBuff ** (1 / 6);\r\n        timer.newInterval(() => {\r\n            Ball[vName] /= vUnitNerf;\r\n        }, 16.7, {\r\n            delay: 200,\r\n            executeTimes: 6,\r\n        });\r\n        return vBuff;\r\n    }\r\n\r\n    #preciselyDetect() {\r\n        if (Ball.ox < Tablet.x || Ball.x > Tablet.ox || Ball.oy < Tablet.y || Ball.y > Tablet.oy) return false;\r\n        if ((Ball.cx >= Tablet.x && Ball.cx <= Tablet.ox) || (Ball.cy >= Tablet.y && Ball.cy <= Tablet.oy)) return true;\r\n        const dx = Ball.cx - (Ball.cx < Tablet.cx ? Tablet.x : Tablet.ox);\r\n        const dy = Ball.cy - (Ball.cy < Tablet.cy ? Tablet.y : Tablet.oy);\r\n        return dx * dx + dy * dy <= Ball.w * Ball.w / 4;\r\n    }\r\n}\r\n","export default class Queue {\r\n    constructor() {\r\n        this.elements = new Map();\r\n        this.head = 0;\r\n        this.tail = 0;\r\n    }\r\n\r\n    push(item) {\r\n        this.elements.set(this.tail, item);\r\n        ++this.tail;\r\n    }\r\n\r\n    pop() {\r\n        if (this.isEmpty) return null;\r\n        const item = this.elements.get(this.head);\r\n        this.elements.delete(this.head);\r\n        ++this.head;\r\n        return item;\r\n    }\r\n\r\n    front() {\r\n        return this.elements.get(this.head);\r\n    }\r\n\r\n    clear() {\r\n        this.elements.clear();\r\n        this.head = this.tail = 0;\r\n    }\r\n\r\n    get length() {\r\n        return this.tail - this.head;\r\n    }\r\n\r\n    get isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}\r\n","import Queue from \"./Queue\";\r\n\r\nexport default class EmbeddedTimer {\r\n    #timeoutMap = new Map();\r\n    #timeout2delete = new Set();\r\n    #intervalMap = new Map();\r\n    #interval2delete = new Set();\r\n    #FPSHandlerID;\r\n    #FPSTimeQueue = new Queue();\r\n    #FPSFramesCnt = 0;\r\n    #FPSElapsed = 0;\r\n    #cachedFPS = NaN;\r\n    #lastFPSCalcTime = 0;\r\n\r\n    #config = {\r\n        minInterval: 16.7,\r\n        autoHandleFPS: false,\r\n        FPSHandleInterval: 33.3,\r\n        FPSUpdateInterval: 300,\r\n    };\r\n\r\n    constructor(options = {}) {\r\n        this.#config = { ...this.#config, ...options };\r\n        if (this.#config.autoHandleFPS) this.initFPSHandler();\r\n    }\r\n\r\n    get MIN_INTERVAL() {\r\n        return this.#config.minInterval;\r\n    }\r\n\r\n    set MIN_INTERVAL(v) {\r\n        this.#config.minInterval = v;\r\n    }\r\n\r\n    timeDetect(timeStamp) {\r\n        this.#timeoutFrame(timeStamp);\r\n        this.#intervalFrame(timeStamp);\r\n    }\r\n\r\n    #timeoutFrame(timeStamp) {\r\n        for (let symbol of this.#timeoutMap.keys()) {\r\n            const duty = this.#timeoutMap.get(symbol);\r\n            if (duty.terminate) {\r\n                this.#timeout2delete.add(symbol);\r\n                continue;\r\n            }\r\n            if (duty.paused) continue;\r\n            if (timeStamp - duty.start >= duty.duration) {\r\n                this.#timeout2delete.add(symbol);\r\n                duty.callback();\r\n            }\r\n        }\r\n        for (let symbol of this.#timeout2delete) {\r\n            this.#timeoutMap.delete(symbol);\r\n        }\r\n        this.#timeout2delete.clear();\r\n    }\r\n\r\n    #intervalFrame(timeStamp) {\r\n        for (let symbol of this.#intervalMap.keys()) {\r\n            const duty = this.#intervalMap.get(symbol);\r\n            if (duty.terminate) {\r\n                this.#interval2delete.add(symbol);\r\n                continue;\r\n            }\r\n            if (duty.paused) continue;\r\n            if (timeStamp < duty.start) continue;\r\n            duty.options.recFramesCnt && ++duty.data.framesCnt;\r\n            duty.options.recElapsedTime && (duty.data.elapsed = timeStamp - duty.start);\r\n            if (timeStamp - duty.step >= duty.duration) {\r\n                ++duty.data.cnt;\r\n                duty.callback(duty.data);\r\n                if (duty.data.cnt >= duty.options.executeTimes) {\r\n                    this.#interval2delete.add(symbol);\r\n                    continue;\r\n                }\r\n                duty.step += duty.duration;\r\n            }\r\n        }\r\n        for (let symbol of this.#interval2delete) {\r\n            this.#intervalMap.delete(symbol);\r\n        }\r\n        this.#interval2delete.clear();\r\n    }\r\n\r\n    newTimeout(callback, timeout = this.#config.minInterval) {\r\n        timeout = Math.max(timeout, this.#config.minInterval);\r\n        const symbol = Symbol(\"Timeout\");\r\n        const now = performance.now();\r\n        let toAdd = {\r\n            callback: callback,\r\n            start: now,\r\n            pause: now,\r\n            duration: timeout,\r\n            paused: false,\r\n            terminate: false,\r\n        };\r\n        this.#timeoutMap.set(symbol, toAdd);\r\n        return symbol;\r\n    }\r\n\r\n    cancelTimeout(symbol) {\r\n        this.#timeoutMap.get(symbol).terminate = true;\r\n    }\r\n\r\n    newInterval(callback, interval = this.#config.minInterval, options = {}) {\r\n        options = Object.assign({\r\n            delay: 0,\r\n            executeTimes: Infinity,\r\n            recFramesCnt: false,\r\n            recElapsedTime: false,\r\n        }, options);\r\n        interval = Math.max(interval, this.#config.minInterval);\r\n        const symbol = Symbol(\"Interval\");\r\n        const now = performance.now();\r\n        let toAdd = {\r\n            callback: callback,\r\n            start: now + options.delay,\r\n            step: now + options.delay,\r\n            pause: now + options.delay,\r\n            duration: interval,\r\n            paused: false,\r\n            terminate: false,\r\n            options: options,\r\n            data: {\r\n                cnt: 0,\r\n                framesCnt: 0,\r\n                elapsed: 0,\r\n            },\r\n        };\r\n        this.#intervalMap.set(symbol, toAdd);\r\n        return symbol;\r\n    }\r\n\r\n    cancelInterval(symbol) {\r\n        this.#intervalMap.get(symbol).terminate = true;\r\n    }\r\n\r\n    pause(symbol) {\r\n        const sType = this.#whichType(symbol);\r\n        if (sType === \"Timeout\") {\r\n            const duty = this.#timeoutMap.get(symbol);\r\n            if (duty.paused) return;\r\n            duty.paused = true;\r\n            duty.pause = performance.now();\r\n        } else if (sType === \"Interval\") {\r\n            const duty = this.#intervalMap.get(symbol);\r\n            if (duty.paused) return;\r\n            duty.paused = true;\r\n            duty.pause = performance.now();\r\n        }\r\n    }\r\n\r\n    resume(symbol) {\r\n        const sType = this.#whichType(symbol);\r\n        if (sType === \"Timeout\") {\r\n            const duty = this.#timeoutMap.get(symbol);\r\n            if (!duty.paused) return;\r\n            duty.paused = false;\r\n            duty.start += performance.now() - duty.pause;\r\n        } else if (sType === \"Interval\") {\r\n            const duty = this.#intervalMap.get(symbol);\r\n            if (!duty.paused) return;\r\n            duty.paused = false;\r\n            duty.step += performance.now() - duty.pause;\r\n        }\r\n    }\r\n\r\n    pauseAll() {\r\n        for (let symbol of this.#timeoutMap.keys()) this.pause(symbol);\r\n        for (let symbol of this.#intervalMap.keys()) this.pause(symbol);\r\n    }\r\n\r\n    resumeAll() {\r\n        for (let symbol of this.#timeoutMap.keys()) this.resume(symbol);\r\n        for (let symbol of this.#intervalMap.keys()) this.resume(symbol);\r\n    }\r\n\r\n    #whichType(symbol) {\r\n        const str = symbol.toString();\r\n        return str.substring(7, str.length - 1);\r\n    }\r\n\r\n    initFPSHandler() {\r\n        if (this.#isFPSHandlerRunning()) return;\r\n        this.#FPSHandlerID = this.newInterval((data) => {\r\n            this.#FPSTimeQueue.push([data.elapsed, data.framesCnt]);\r\n            while (data.elapsed - this.#FPSTimeQueue.front()[0] > 1000) {\r\n                this.#FPSTimeQueue.pop();\r\n            }\r\n            this.#FPSFramesCnt = data.framesCnt;\r\n            this.#FPSElapsed = data.elapsed;\r\n        }, this.#config.FPSHandleInterval, {\r\n            recFramesCnt: true,\r\n            recElapsedTime: true,\r\n        });\r\n    }\r\n\r\n    destroyFPSHandler() {\r\n        if (!this.#isFPSHandlerRunning()) return;\r\n        this.cancelInterval(this.#FPSHandlerID);\r\n        this.#FPSHandlerID = null;\r\n        this.#FPSTimeQueue.clear();\r\n    }\r\n\r\n    #isFPSHandlerRunning() {\r\n        return this.#FPSHandlerID !== undefined && this.#FPSHandlerID !== null;\r\n    }\r\n\r\n    #calcFPS() {\r\n        const approxFPS = this.#FPSFramesCnt - this.#FPSTimeQueue.front()[1];\r\n        const adjustRatio = 1000 / (this.#FPSElapsed - this.#FPSTimeQueue.front()[0]);\r\n        return (approxFPS * adjustRatio).toFixed(1);\r\n    }\r\n\r\n    get FPS() {\r\n        if (!this.#isFPSHandlerRunning() || this.#FPSTimeQueue.isEmpty) return this.#cachedFPS = NaN;\r\n        const timeStamp = performance.now();\r\n        if (timeStamp - this.#lastFPSCalcTime < this.#config.FPSUpdateInterval) return this.#cachedFPS;\r\n        this.#lastFPSCalcTime = timeStamp;\r\n        return this.#cachedFPS = this.#calcFPS();\r\n    }\r\n}\r\n","import { Rect } from \"leafer-game\";\r\nimport { GP, leafer } from \"../core/instances\";\r\n\r\nexport default class E_Mask extends Rect {\r\n    #config = {\r\n        fill: \"#666\",\r\n        opacity: 0.6,\r\n        fadeInDuration: 0.8,\r\n    };\r\n\r\n    constructor() {\r\n        super({\r\n            x: 0,\r\n            y: 0,\r\n            width: GP.bw,\r\n            height: GP.bh,\r\n            fill: \"#666\",\r\n            opacity: 0,\r\n            animationOut: {\r\n                style: { opacity: 0 },\r\n                duration: 0.5,\r\n                join: true,\r\n            },\r\n            zIndex: 990,\r\n        });\r\n        this.fill = this.#config.fill;\r\n        this.animation = {\r\n            style: { opacity: this.#config.opacity },\r\n            duration: this.#config.fadeInDuration,\r\n            join: true,\r\n        };\r\n    }\r\n\r\n    relocate_(e) {\r\n        this.w = e.width;\r\n        this.h = e.height;\r\n    }\r\n\r\n    render_(fill = void 0, fromOpacity = void 0, toOpacity = void 0, duration = void 0) {\r\n        if (fill === void 0) this.fill = this.#config.fill;\r\n        else this.fill = fill;\r\n        if (fromOpacity === void 0) this.opacity = 0;\r\n        else this.opacity = fromOpacity;\r\n        if (toOpacity === void 0) this.animation.style.opacity = this.#config.opacity;\r\n        else this.animation.style.opacity = toOpacity;\r\n        if (duration === void 0) this.animation.duration = this.#config.fadeInDuration;\r\n        else this.animation.duration = duration;\r\n        leafer.add(this);\r\n    }\r\n}\r\n","import { AnimateEvent, Group, Image, Text } from \"leafer-game\";\r\nimport { GP, leafer } from \"../core/instances\";\r\n\r\nexport default class E_Menu extends Group {\r\n    constructor() {\r\n        super({\r\n            x: 0,\r\n            y: 0,\r\n            width: GP.bw,\r\n            height: GP.bh,\r\n            animationOut: {\r\n                style: { opacity: 0 },\r\n                duration: 0.5,\r\n                join: true,\r\n            },\r\n            zIndex: 991,\r\n        });\r\n        this.Brand = new Image({\r\n            x: GP.bw / 2,\r\n            y: GP.bh * 2 / 7,\r\n            around: \"center\",\r\n            url: \"leafer://brand.svg\",\r\n            opacity: 0,\r\n            scale: 0,\r\n            offsetY: -300,\r\n            shadow: {\r\n                x: 0,\r\n                y: 0,\r\n                blur: 50,\r\n                color: \"#555\",\r\n            },\r\n        });\r\n        this.Hint1 = new Group({\r\n            x: GP.bw / 2,\r\n            y: GP.bh * 4 / 7 - 12,\r\n            opacity: 0,\r\n            around: \"center\",\r\n        });\r\n        this.HintLeft = new Text({\r\n            x: 0,\r\n            y: 0,\r\n            text: \"按\",\r\n            fill: \"#444\",\r\n            fontSize: 16,\r\n        });\r\n        this.HintSpace = new Text({\r\n            x: this.HintLeft.ox + 3,\r\n            y: 0,\r\n            text: \"空格键\",\r\n            fill: \"#444\",\r\n            fontSize: 16,\r\n            fontWeight: \"bold\",\r\n        });\r\n        this.HintRight = new Text({\r\n            x: this.HintSpace.ox + 3,\r\n            y: 0,\r\n            text: \"开始游戏\",\r\n            fill: \"#444\",\r\n            fontSize: 16,\r\n        });\r\n        this.Hint1.add([this.HintLeft, this.HintSpace, this.HintRight]);\r\n        this.Hint2 = new Group({\r\n            x: GP.bw / 2,\r\n            y: GP.bh * 4 / 7 + 12,\r\n            opacity: 0,\r\n            around: \"center\",\r\n        });\r\n        this.HintOperation = new Text({\r\n            x: 0,\r\n            y: 0,\r\n            text: \"通过 方向键 或 W/A/S/D 来控制平板的移动\",\r\n            fill: \"#777\",\r\n            fontSize: 12,\r\n        });\r\n        this.Hint2.add(this.HintOperation);\r\n        this.add([this.Brand, this.Hint1, this.Hint2]);\r\n    }\r\n\r\n    async init() {\r\n        await this.preloadImage();\r\n    }\r\n\r\n    async preloadImage() {\r\n        await GP.ImageInitializer(\"brand.svg\", \"./assets/svg/brand.svg\");\r\n    }\r\n\r\n    relocate_(e) {\r\n        if (!this.visible) return;\r\n        this.cx = e.width / 2;\r\n        this.Brand.y = e.height * 2 / 7;\r\n        this.Hint1.y = e.height * 4 / 7 - 12;\r\n        this.Hint2.y = e.height * 4 / 7 + 12;\r\n    }\r\n\r\n    render_() {\r\n        leafer.add(this);\r\n        const ani1 = this.Brand.animate([\r\n            { opacity: 0.9, scale: 1.1, offsetY: -5 },\r\n            { opacity: 1, scale: 1, offsetY: 0 },\r\n        ], {\r\n            duration: 0.8,\r\n            join: true,\r\n        });\r\n        this.Hint1.animate([\r\n            { opacity: 1 },\r\n        ], {\r\n            duration: 0.8,\r\n            delay: 0.2,\r\n            join: true,\r\n        });\r\n        this.Hint2.animate([\r\n            { opacity: 1 },\r\n        ], {\r\n            duration: 0.8,\r\n            delay: 0.4,\r\n            join: true,\r\n        });\r\n        ani1.once(AnimateEvent.COMPLETED, () => {\r\n            this.Brand.hoverStyle = {\r\n                shadow: {\r\n                    x: 0,\r\n                    y: 0,\r\n                    blur: 20,\r\n                    color: \"#FFEF00\",\r\n                },\r\n            };\r\n        });\r\n    }\r\n}\r\n","import { Text } from \"leafer-game\";\r\nimport { GP } from \"../core/instances\";\r\n\r\nexport default class E_Settlement extends Text {\r\n    constructor() {\r\n        super({\r\n            x: GP.bw / 2,\r\n            y: GP.bh / 3,\r\n            around: \"center\",\r\n            text: \"\",\r\n            fontSize: 128,\r\n            fontFamily: \"HYBeiBingYang-W\",\r\n            scale: 0.5,\r\n            opacity: 0.6,\r\n            animation: {\r\n                style: { scale: 1, opacity: 1 },\r\n                duration: 0.4,\r\n                join: true,\r\n            },\r\n            animationOut: {\r\n                style: { scale: 0.4, opacity: 0.2 },\r\n                duration: 0.3,\r\n                join: true,\r\n            },\r\n            zIndex: 991,\r\n        });\r\n\r\n        this.init = this.init.bind(this);\r\n    }\r\n\r\n    relocate(e) {\r\n        this.x = e.width / 2;\r\n        this.y = e.height / 2 - 64;\r\n    }\r\n\r\n    async init() {\r\n        await Promise.all([\r\n            this.#loadFont(),\r\n            this.#preloadImage(),\r\n        ]);\r\n    }\r\n\r\n    async #loadFont() {\r\n        await GP.fontInitializer(\"HYBeiBingYang-W\", \"./assets/fonts/HYBeiBingYang-W\");\r\n    }\r\n\r\n    async #preloadImage() {\r\n        await Promise.all([\r\n            GP.ImageInitializer(\"GL.jpg\", \"./assets/img/GL.jpg\"),\r\n            GP.ImageInitializer(\"DL.jpg\", \"./assets/img/DL.jpg\"),\r\n        ]);\r\n    }\r\n\r\n    win() {\r\n        this.text = \" You Win! \";\r\n        this.#setTextFill(\"leafer://GL.jpg\");\r\n        this.#setShadowColor(\"#FFEF00\");\r\n        this.render_();\r\n    }\r\n\r\n    fail() {\r\n        this.text = \" FAIL \";\r\n        this.#setTextFill(\"leafer://DL.jpg\");\r\n        this.#setShadowColor(\"#474746\");\r\n        this.render_();\r\n    }\r\n\r\n    #setTextFill(src) {\r\n        this.fill = {\r\n            type: \"image\",\r\n            url: src,\r\n            offset: { y: -50 },\r\n        };\r\n    }\r\n\r\n    #setShadowColor(color) {\r\n        this.shadow = {\r\n            x: 0,\r\n            y: 0,\r\n            blur: 25,\r\n            color: color,\r\n        };\r\n    }\r\n}\r\n","import { Text } from \"leafer-game\";\r\nimport { GP } from \"../core/instances\";\r\n\r\nexport default class E_FPS extends Text {\r\n    constructor() {\r\n        super({\r\n            x: 12,\r\n            y: GP.bh - 24,\r\n            fontSize: 12,\r\n            fill: \"#777\",\r\n            text: \"FPS: --\",\r\n        });\r\n    }\r\n\r\n    relocate_(e) {\r\n        if (e.height === e.old.height) return;\r\n        this.y = e.height - 24;\r\n    }\r\n\r\n    assign_(fps) {\r\n        if (isNaN(fps)) fps = \"--\";\r\n        this.text = \"FPS: \" + fps;\r\n    }\r\n}\r\n","import { Polygon } from \"leafer-game\";\r\nimport { GP } from \"../core/instances\";\r\n\r\nexport default class E_ForbiddenZone extends Polygon {\r\n    constructor() {\r\n        super({\r\n            points: [\r\n                0, GP.bh,\r\n                0, 0,\r\n                GP.bw, 0,\r\n                GP.bw, GP.bh,\r\n                GP.bw - GP.ENV.paddingSide, GP.bh,\r\n                GP.bw - GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n                GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n                GP.ENV.paddingSide, GP.bh,\r\n            ],\r\n            fill: \"#E85B5B87\",\r\n        });\r\n    }\r\n\r\n    relocate_(e) {\r\n        this.points = [\r\n            0, e.height,\r\n            0, 0,\r\n            e.width, 0,\r\n            e.width, e.height,\r\n            e.width - GP.ENV.paddingSide, e.height,\r\n            e.width - GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n            GP.ENV.paddingSide, GP.ENV.paddingTop,\r\n            GP.ENV.paddingSide, e.height,\r\n        ];\r\n    }\r\n}\r\n","import { Group, Path, Text } from \"leafer-game\";\r\nimport { F, GP, timer } from \"../core/instances\";\r\n\r\nexport default class E_Timing extends Group {\r\n    alarm;\r\n    remaining = GP.ENV.timeLimit;\r\n    animatingFlag = false;\r\n\r\n    constructor() {\r\n        super({\r\n            x: 15,\r\n            y: 15,\r\n        });\r\n        this.Icon = new Path({\r\n            path: \"M511.488 0C228.864 0 0 229.376 0 512s228.864 512 511.488 512C794.624 1024 1024 794.624 1024 512s-229.376-512-512.512-512z m21.76 556.416V219.52H438.912v392.32h1.472l243.84 140.8 47.296-81.728-198.144-114.432zM512 921.6A409.472 409.472 0 0 1 102.4 512c0-226.304 183.296-409.6 409.6-409.6 226.304 0 409.6 183.296 409.6 409.6 0 226.304-183.296 409.6-409.6 409.6z\",\r\n            x: 0,\r\n            y: 0,\r\n            scale: 0.015625, // 16 / 1024\r\n            fill: \"#262626\",\r\n        });\r\n        this.IconG = new Group({\r\n            x: 0,\r\n            y: 0,\r\n            width: 16,\r\n            height: 16,\r\n            origin: \"center\",\r\n            children: [this.Icon],\r\n        });\r\n        this.Text = new Text({\r\n            x: 20,\r\n            y: 0,\r\n            fontSize: 16,\r\n            lineHeight: 16,\r\n            text: \"3:00\",\r\n            fill: \"#262626\",\r\n        });\r\n        this.add([this.IconG, this.Text]);\r\n    }\r\n\r\n    reset_() {\r\n        this.remaining = GP.ENV.timeLimit;\r\n        this.animatingFlag = false;\r\n        this.Text.text = E_Timing.toMSString_(GP.ENV.timeLimit);\r\n        this.Text.fontWeight = \"normal\";\r\n        this.Text.fill = this.Icon.fill = \"#262626\";\r\n    }\r\n\r\n    start_() {\r\n        this.alarm = timer.newInterval(this.#secondLoop.bind(this), 1000);\r\n    }\r\n\r\n    stop_() {\r\n        timer.cancelInterval(this.alarm);\r\n        if (this.animatingFlag) {\r\n            this.animatingFlag = false;\r\n            this.IconG.killAnimate();\r\n        }\r\n    }\r\n\r\n    static toMS_(v) {\r\n        return [F(v / 60), v % 60];\r\n    }\r\n\r\n    static toMSString_(v) {\r\n        const seconds = v % 60;\r\n        return `${F(v / 60)}:${seconds < 10 ? \"0\" + seconds : seconds}`;\r\n    }\r\n\r\n    #secondLoop() {\r\n        if (--this.remaining < 0) return;\r\n        this.Text.text = E_Timing.toMSString_(this.remaining);\r\n        if (!this.animatingFlag && this.remaining <= 15) {\r\n            this.animatingFlag = true;\r\n            this.IconG.animate(\r\n                [\r\n                    { style: { rotation: 35, y: 0 }, duration: 0.1 },\r\n                    { style: { rotation: -35, y: -3 }, duration: 0.1 },\r\n                    { style: { rotation: 25, y: -3 }, duration: 0.1 },\r\n                    { style: { rotation: -25, y: 0 }, duration: 0.1 },\r\n                ],\r\n                {\r\n                    loop: true,\r\n                    loopDelay: 0.6,\r\n                    join: true,\r\n                },\r\n            );\r\n            this.Icon.fill = this.Text.fill = \"#44C2F1\";\r\n            this.Text.fontWeight = \"bold\";\r\n        }\r\n        if (this.remaining <= 0) GP.gameOver(true);\r\n    }\r\n}\r\n","import { Group, Path, Text } from \"leafer-game\";\r\nimport { Ball, F, GP, timer } from \"../core/instances\";\r\n\r\nexport default class E_Scoring extends Group {\r\n    v = 0;\r\n\r\n    constructor() {\r\n        super({\r\n            x: GP.bw / 2 - 120,\r\n            y: 0,\r\n        });\r\n        this.Panel = new Path({\r\n            path: \"m -120 0\\n\" +\r\n                \"  h 10\\n\" +\r\n                \"  a 20 15 0 0 1 20 15\\n\" +\r\n                \"  v 35\\n\" +\r\n                \"  a 15 18 0 0 0 15 18\\n\" +\r\n                \"  h 150\\n\" +\r\n                \"  a 15 18 0 0 0 15 -18\\n\" +\r\n                \"  v -35\\n\" +\r\n                \"  a 20 15 0 0 1 20 -15\\n\" +\r\n                \"  h 10\\n\" +\r\n                \"  Z\",\r\n            x: 120,\r\n            y: 0,\r\n            fill: \"#777A\",\r\n        });\r\n        this.Integer = new Text({\r\n            x: -GP.bw,\r\n            y: 7,\r\n            fontSize: 40,\r\n            fill: \"#FFF\",\r\n            text: \"-\",\r\n            fontFamily: \"HYDiSiKe-U\",\r\n        });\r\n        this.Decimal = new Text({\r\n            x: -GP.bw,\r\n            y: 15,\r\n            fontSize: 32,\r\n            fill: \"#DDD\",\r\n            text: \"--\",\r\n            fontFamily: \"HYDiSiKe-U\",\r\n        });\r\n        this.add([this.Panel, this.Integer, this.Decimal]);\r\n\r\n        this.init_ = this.init_.bind(this);\r\n    }\r\n\r\n    reset_() {\r\n        this.assign_(0);\r\n    }\r\n\r\n    relocate_(e) {\r\n        if (e.width === e.old.width) return;\r\n        this.cx = e.width / 2;\r\n        this.#newScore_();\r\n    }\r\n\r\n    async init_() {\r\n        await this.#loadFont_();\r\n    }\r\n\r\n    async #loadFont_() {\r\n        await GP.fontInitializer(\"HYDiSiKe-U\", \"./assets/fonts/HYDiSiKe-U\");\r\n        this.#newScore_();\r\n    }\r\n\r\n    assign_(score) {\r\n        this.v = Math.round(score * 10);\r\n        this.#newScore_();\r\n        return E_Scoring.stringify_(this.v);\r\n    }\r\n\r\n    delta_(x) {\r\n        const prevV = this.v;\r\n        this.v += Math.round(x * 10);\r\n        this.#newScore_();\r\n        return E_Scoring.stringify_(this.v - prevV);\r\n    }\r\n\r\n    tip_(delta) {\r\n        const [initialOffsetX, transitionX, transitionY] = this.#getTipData_();\r\n        const tip = new Text({\r\n            x: Ball.cx + initialOffsetX,\r\n            y: Ball.oy,\r\n            around: \"center\",\r\n            text: \"+\" + delta,\r\n            fill: \"#FFEF00\",\r\n            stroke: \"#33333333\",\r\n            fontSize: 20,\r\n            fontFamily: \"HYDiSiKe-U\",\r\n            opacity: 0.9,\r\n            shadow: {\r\n                x: 1,\r\n                y: 1,\r\n                blur: 10,\r\n                color: \"gray\",\r\n            },\r\n            animation: {\r\n                keyframes: [\r\n                    { style: { opacity: 0.9, fontSize: 24 }, duration: 0.3 },\r\n                    { style: { opacity: 0, fontSize: 25 }, duration: 0.4 },\r\n                ],\r\n                join: true,\r\n            },\r\n        });\r\n        tip.render_();\r\n        tip.animate([\r\n            { offsetX: transitionX },\r\n        ], {\r\n            duration: 0.45,\r\n            easing: \"sine-out\",\r\n            join: true,\r\n        });\r\n        tip.animate([\r\n            { style: { offsetY: -12 }, duration: 0.12, easing: \"quad-out\" },\r\n            { style: { offsetY: transitionY }, duration: 0.28, easing: \"quad-in-out\" },\r\n        ], {\r\n            join: true,\r\n        });\r\n        timer.newTimeout(function () {\r\n            tip.destroy();\r\n        }, 600);\r\n    }\r\n\r\n    #getTipData_() {\r\n        const ballSpeedAffect = 0.7 * Ball.vx * 600 / GP.ENV.actUnitInterval;\r\n        let direction = Math.random() >= 0.5 ? 1 : -1;\r\n        let initialOffsetX = (10 + Math.random() * 20) * direction;\r\n        let transitionX0 = (40 + Math.random() * 20) * direction;\r\n        let transitionY = (Math.random() - 0.4) * 24;\r\n        const totalTranslationX = initialOffsetX + transitionX0 + ballSpeedAffect;\r\n        if (Ball.cx + totalTranslationX <= GP.ENV.paddingSide) {\r\n            initialOffsetX *= -1;\r\n            transitionX0 *= -1;\r\n        } else if (Ball.cx + totalTranslationX >= GP.bw - GP.ENV.paddingSide) {\r\n            initialOffsetX *= -1;\r\n            transitionX0 *= -1;\r\n        }\r\n        return [initialOffsetX + ballSpeedAffect / 2, transitionX0 + ballSpeedAffect / 2, transitionY];\r\n    }\r\n\r\n    #newScore_() {\r\n        this.Integer.text = F(this.v / 10);\r\n        this.Decimal.text = \".\" + this.v % 10;\r\n        this.Integer.x = (240 - this.Integer.w - this.Decimal.w) / 2;\r\n        this.Decimal.x = this.Integer.ox;\r\n    }\r\n\r\n    static stringify_(v) {\r\n        return `${F(v / 10)}.${v % 10}`;\r\n    }\r\n}\r\n","import { Rect, Keyboard } from \"leafer-game\";\r\nimport { GI, GP, Tablet } from \"../core/instances\";\r\n\r\nexport default class E_Tablet extends Rect {\r\n    vxMax;\r\n    vyMax;\r\n    vx;\r\n    vy;\r\n    availZone = [80, 40, 0, 40]; // Top, Right, Bottom, Left\r\n\r\n    constructor() {\r\n        super({\r\n            width: 120, // 120\r\n            height: 25,\r\n            fill: \"#32CD79\",\r\n        });\r\n    }\r\n\r\n    reset_() {\r\n        this.vxMax = 6;\r\n        this.vyMax = 2.8;\r\n        this.vx = 0;\r\n        this.vy = 0;\r\n        this.cx = GP.bw / 2;\r\n        this.y = GP.bh - 140;\r\n    }\r\n\r\n    frameLoop(prog) {\r\n        this.vx = this.vy = 0;\r\n        if (Keyboard.isHold(\"KeyW\") || Keyboard.isHold(\"ArrowUp\")) {\r\n            this.vy -= this.vyMax * prog;\r\n        }\r\n        if (Keyboard.isHold(\"KeyS\") || Keyboard.isHold(\"ArrowDown\")) {\r\n            this.vy += this.vyMax * prog;\r\n        }\r\n        if (Keyboard.isHold(\"KeyA\") || Keyboard.isHold(\"ArrowLeft\")) {\r\n            this.vx -= this.vxMax * prog;\r\n        }\r\n        if (Keyboard.isHold(\"KeyD\") || Keyboard.isHold(\"ArrowRight\")) {\r\n            this.vx += this.vxMax * prog;\r\n        }\r\n        this.x += this.vx;\r\n        this.y += this.vy;\r\n        GI.borderDetect(Tablet, {\r\n            paddings: this.availZone,\r\n        });\r\n    }\r\n}\r\n","import { Ellipse, AnimateEvent } from \"leafer-game\";\r\nimport { Ball, C, F, GP, leafer } from \"../core/instances\";\r\n\r\nexport default class X_BallTrailing {\r\n    length = 8;\r\n    dotRadius = 5.5;\r\n    loopIdx = 0;\r\n    dotIdx = -1;\r\n    dots = new Map();\r\n    activeAnimations = new Map();\r\n    framesInterval = 5; // based on 60Hz\r\n\r\n    constructor() {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this.dots.set(i, new Ellipse({\r\n                x: -100,\r\n                y: -100,\r\n                width: this.dotRadius * 2,\r\n                height: this.dotRadius * 2,\r\n                around: \"center\",\r\n                fill: \"#FF4500BA\",\r\n                visible: false,\r\n            }));\r\n        }\r\n    }\r\n\r\n    render() {\r\n        for (let d of this.dots.values()) {\r\n            d.render_();\r\n        }\r\n    }\r\n\r\n    prepare() {\r\n        if (GP.ENV.actUnitInterval >= 25) {\r\n            this.framesInterval = C(94 / GP.ENV.actUnitInterval);\r\n        } else {\r\n            this.framesInterval = F(94 / GP.ENV.actUnitInterval);\r\n        }\r\n    }\r\n\r\n    frameLoop(steps) {\r\n        this.loopIdx = (this.loopIdx + 1) % this.framesInterval;\r\n        if (this.loopIdx === 0) {\r\n            const idx = this.dotIdx = (this.dotIdx + 1) % this.length;\r\n            const dot = this.dots.get(idx);\r\n            dot.w = dot.h = this.dotRadius * 2;\r\n            dot.opacity = 1;\r\n            dot.x = Ball.cx;\r\n            dot.y = Ball.cy;\r\n            dot.visible = true;\r\n            if (this.activeAnimations.has(idx)) {\r\n                const oldAni = this.activeAnimations.get(idx);\r\n                oldAni.off(AnimateEvent.COMPLETED);\r\n                leafer.killAnimate(oldAni);\r\n                this.activeAnimations.delete(idx);\r\n            }\r\n            const ani = dot.animate(\r\n                [\r\n                    { opacity: 1, width: this.dotRadius * 2, height: this.dotRadius * 2 },\r\n                    { opacity: 0.3, width: 5, height: 5 },\r\n                ],\r\n                {\r\n                    duration: (GP.ENV.stdUnitInterval * this.framesInterval * this.length) / steps / 1000,\r\n                    easing: \"linear\",\r\n                },\r\n            );\r\n            ani.on(AnimateEvent.COMPLETED, () => {\r\n                this.activeAnimations.delete(idx);\r\n                dot.visible = false;\r\n                dot.w = dot.h = this.dotRadius * 2;\r\n                dot.opacity = 1;\r\n            });\r\n            this.activeAnimations.set(idx, ani);\r\n        }\r\n    }\r\n}\r\n","import { Ellipse } from \"leafer-game\";\r\nimport X_BallTrailing from \"../elements_extensions/X_BallTrailing\";\r\nimport { GI, GP, leafer, Timing } from \"../core/instances\";\r\n\r\nexport default class E_Ball extends Ellipse {\r\n    vx;\r\n    ax;\r\n    ay;\r\n    timeDivisor = 1;\r\n\r\n    constructor() {\r\n        super({\r\n            width: 20,\r\n            height: 20,\r\n            fill: \"#20A8D7\",\r\n        });\r\n        this.trailing = new X_BallTrailing();\r\n    }\r\n\r\n    reset_() {\r\n        this.vx = (Math.random() * 2.7 + 0.8) * (Math.random() > 0.5 ? 1 : -1);\r\n        this.vy = 3.5;\r\n        this.ax = 1.27e-4;\r\n        this.ay = 1.43e-4;\r\n        this.cx = GP.bw / 2;\r\n        this.cy = GP.bh / 4;\r\n    }\r\n\r\n    render_() {\r\n        this.trailing.render();\r\n        leafer.add(this);\r\n    }\r\n\r\n    prepare_() {\r\n        this.trailing.prepare();\r\n    }\r\n\r\n    frameLoop_(prog) {\r\n        if (Timing.remaining >= 70 && Timing.remaining < 160) {\r\n            this.vx *= (1 + this.ax) ** prog;\r\n            this.vy *= (1 + this.ay) ** prog;\r\n            this.ax *= 0.99987;\r\n            this.ay *= 0.99987;\r\n        }\r\n        this.x += this.vx * prog;\r\n        this.y += this.vy * prog;\r\n        GI.borderDetect(this, {\r\n            bounce: true,\r\n            paddings: [0, 0, -this.h * 3, 0],\r\n            callbacks: [null, null, GP.gameOver/*null*/, null],\r\n        });\r\n        this.trailing.frameLoop(this.timeDivisor);\r\n    }\r\n}\r\n","import { Leafer } from \"leafer-game\";\r\nimport extendUI from \"./UIExtensions\";\r\nimport Processor from \"./processor\";\r\nimport Interaction from \"./interaction\";\r\nimport EmbeddedTimer from \"../utils/EmbeddedTimer\";\r\nimport E_Mask from \"../elements/E_Mask\";\r\nimport E_Menu from \"../elements/E_Menu\";\r\nimport E_Settlement from \"../elements/E_Settlement\";\r\nimport E_FPS from \"../elements/E_FPS\";\r\nimport E_ForbiddenZone from \"../elements/E_ForbiddenZone\";\r\nimport E_Timing from \"../elements/E_Timing\";\r\nimport E_Scoring from \"../elements/E_Scoring\";\r\nimport E_Tablet from \"../elements/E_Tablet\";\r\nimport E_Ball from \"../elements/E_Ball\";\r\n\r\nexport const D = Math.abs;\r\nexport const C = Math.ceil;\r\nexport const F = Math.floor;\r\n\r\nexport let prevTimeStamp;\r\n\r\nexport function setPrevTimeStamp(v) {\r\n    prevTimeStamp = v;\r\n}\r\n\r\nexport const loading = document.querySelector(\"#loading\");\r\n\r\nextendUI();\r\n\r\nexport const leafer = new Leafer({\r\n    view: document.querySelector(\"canvas\"),\r\n    fill: \"#EFF\",\r\n    pointer: {\r\n        preventDefaultMenu: true,\r\n    },\r\n});\r\n\r\nexport const GP = new Processor({\r\n    refreshRate: 60,\r\n    actUnitInterval: 16.7,\r\n    stdUnitInterval: 16.7,\r\n    fixedStep: 16.7,\r\n    maxStepPerFrame: 10,\r\n    paddingTop: 80,\r\n    paddingSide: 40,\r\n    timeLimit: 180,\r\n});\r\n\r\nexport const GI = new Interaction();\r\nexport const timer = new EmbeddedTimer({\r\n    minInterval: 0,\r\n    autoHandleFPS: true,\r\n});\r\n\r\nexport const Mask = new E_Mask();\r\nexport const Menu = new E_Menu();\r\nexport const Settlement = new E_Settlement();\r\nexport const FPS = new E_FPS();\r\nexport const ForbiddenZone = new E_ForbiddenZone();\r\nexport const Timing = new E_Timing();\r\nexport const Scoring = new E_Scoring();\r\nexport const Tablet = new E_Tablet();\r\nexport const Ball = new E_Ball();\r\n","import {\r\n    setPrevTimeStamp,\r\n    F,\r\n    D,\r\n    prevTimeStamp,\r\n    loading,\r\n    leafer,\r\n    GI,\r\n    GP,\r\n    timer,\r\n    Mask,\r\n    Menu,\r\n    Settlement,\r\n    FPS,\r\n    ForbiddenZone,\r\n    Timing,\r\n    Scoring,\r\n    Tablet,\r\n    Ball,\r\n} from \"./core/instances\";\r\n\r\nimport {\r\n    ResizeEvent,\r\n    KeyEvent,\r\n} from \"leafer-game\";\r\n\r\nloading.addEventListener(\"dragstart\", e => e.preventDefault());\r\n\r\nlet accumulated = 0;\r\n\r\nMask.render_(\"#FFF\", 1, 0.7, 0.4);\r\nbeforeStart();\r\nGP.renderAll();\r\nrequestAnimationFrame(firstFrame);\r\ntimer.newInterval(() => FPS.assign_(timer.FPS), 400);\r\nGP.initializeAll()\r\n    .then(() => GP.state(\"init1\"))\r\n    .catch(err => console.error(\"Initialization failed...\\n\", err));\r\n\r\nfunction beforeStart() {\r\n    Timing.reset_();\r\n    Tablet.reset_();\r\n    Ball.reset_();\r\n}\r\n\r\nfunction firstFrame(timeStamp) {\r\n    setPrevTimeStamp(timeStamp);\r\n    gameLoop(timeStamp);\r\n}\r\n\r\nfunction gameLoop(timeStamp) {\r\n    const deltaTime = timeStamp - prevTimeStamp;\r\n    setPrevTimeStamp(timeStamp);\r\n    timer.timeDetect(timeStamp);\r\n\r\n    if (GP.at(\"init1\")) {\r\n        GP.measureRefreshRate(deltaTime / GP.ENV.stdUnitInterval);\r\n    } else if (GP.at(\"init2\")) {\r\n        Ball.prepare_();\r\n        GP.state(\"almost-prepared\");\r\n    } else if (GP.at(\"almost-prepared\")) {\r\n        GP.state(\"prepared\");\r\n        GP.loadingFadeOut();\r\n        Mask.animate([\r\n            { opacity: 0.4 },\r\n        ], {\r\n            duration: 0.5,\r\n            join: true,\r\n        });\r\n        Menu.render_();\r\n    }\r\n\r\n    let steps = 1;\r\n    if (GP.at(\"playing\")) {\r\n        accumulated += Math.min(deltaTime, 1000); // can redisplay frames of up to 1s\r\n        Ball.timeDivisor = Math.min(F(accumulated / GP.ENV.fixedStep), GP.ENV.maxStepPerFrame);\r\n        while (accumulated >= GP.ENV.fixedStep && steps <= GP.ENV.maxStepPerFrame) { // sub-stepping loop\r\n            accumulated -= GP.ENV.fixedStep;\r\n            ++steps;\r\n            const unitProg = GP.ENV.fixedStep / GP.ENV.stdUnitInterval;\r\n            Ball.frameLoop_(unitProg);\r\n            Tablet.frameLoop(unitProg);\r\n            if (GI.collisionDetect() && Ball.vy < 0) {\r\n                const bv = Math.sqrt(Ball.vx ** 2 + Ball.vy ** 2);\r\n                const bvP = Math.log2(bv) + 1 / Math.cos(Math.PI / 20 * bv);\r\n                const d = D(Tablet.cx - Ball.cx);\r\n                const dP = Math.cos(Math.PI / Tablet.w * 2 * d) + 0.5;\r\n                Scoring.tip_(Scoring.delta_(0.7 * bvP + 0.3 * dP));\r\n            }\r\n        }\r\n    }\r\n\r\n    requestAnimationFrame(gameLoop);\r\n}\r\n\r\ndocument.addEventListener(\"visibilitychange\", function () {\r\n    if (document.hidden) {\r\n        GP.pause();\r\n    } else {\r\n        GP.resume();\r\n    }\r\n});\r\nleafer.on(ResizeEvent.RESIZE, function (e) {\r\n    Mask.relocate_(e);\r\n    Menu.relocate_(e);\r\n    Settlement.relocate(e);\r\n    FPS.relocate_(e);\r\n    ForbiddenZone.relocate_(e);\r\n    Scoring.relocate_(e);\r\n});\r\nleafer.on(KeyEvent.HOLD, function (e) {\r\n    e.code === \"Semicolon\" && FPS.toggle();\r\n});\r\nleafer.on(KeyEvent.UP, function (e) {\r\n    if (e.code === \"Space\") {\r\n        if (GP.at(\"prepared\")) {\r\n            GP.state(\"playing\");\r\n            Timing.start_();\r\n            GP.start();\r\n        } else if (GP.at(\"over\")) {\r\n            GP.reset();\r\n            GP.state(\"playing\");\r\n            Timing.start_();\r\n        }\r\n    }\r\n});\r\n"],"names":["extendUI","extensions","v","leafer","UI","Processor","#SM","ENV","newState","states","Menu","Scoring","Settlement","ForbiddenZone","Tablet","Ball","Timing","FPS","prog","rrKey","curValue","maxV","k4maxV","k","GP","name","src","font","font2","e","img","Platform","Resource","Mask","timer","setPrevTimeStamp","win","loading","Interaction","ge","bounce","paddings","callbacks","bounceRatio","#preciselyDetect","overlapX","overlapY","sameXDirection","sameYDirection","direction","now","vName","ratio1","ratio2","vBuff","vUnitNerf","dx","dy","Queue","item","EmbeddedTimer","#timeoutMap","#timeout2delete","#intervalMap","#interval2delete","#FPSHandlerID","#FPSTimeQueue","#FPSFramesCnt","#FPSElapsed","#cachedFPS","#lastFPSCalcTime","#config","options","timeStamp","#timeoutFrame","#intervalFrame","symbol","duty","callback","timeout","toAdd","interval","sType","#whichType","str","#isFPSHandlerRunning","data","#calcFPS","approxFPS","adjustRatio","E_Mask","Rect","fill","fromOpacity","toOpacity","duration","E_Menu","Group","Image","Text","ani1","AnimateEvent","E_Settlement","#loadFont","#preloadImage","#setTextFill","#setShadowColor","color","E_FPS","fps","E_ForbiddenZone","Polygon","E_Timing","Path","#secondLoop","F","seconds","E_Scoring","#newScore_","#loadFont_","score","x","prevV","delta","initialOffsetX","transitionX","transitionY","#getTipData_","tip","ballSpeedAffect","transitionX0","totalTranslationX","E_Tablet","Keyboard","GI","X_BallTrailing","i","Ellipse","d","C","steps","idx","dot","oldAni","ani","E_Ball","D","prevTimeStamp","Leafer","accumulated","beforeStart","firstFrame","err","gameLoop","deltaTime","unitProg","bv","bvP","dP","ResizeEvent","KeyEvent"],"mappings":"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"}